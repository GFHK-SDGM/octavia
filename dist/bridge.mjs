var D=Object.create;var x=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var L=(i,s)=>()=>(s||i((s={exports:{}}).exports,s),s.exports);var U=(i,s,l,o)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of O(s))!I.call(i,r)&&r!==l&&x(i,r,{get:()=>s[r],enumerable:!(o=P(s,r))||o.enumerable});return i};var N=(i,s,l)=>(l=i!=null?D(A(i)):{},U(s||!i||!i.__esModule?x(l,"default",{value:i,enumerable:!0}):l,i));var M=L((_e,w)=>{(function(){"use strict";let i={fatal:!0},s=[new TextDecoder("iso-8859-15",i),new TextDecoder("sjis",i),new TextDecoder("euc-jp",i),new TextDecoder("utf-8",i),new TextDecoder("utf-16",i),new TextDecoder("ascii")],l={debug:!1,parse:function(o,r){if(o instanceof Uint8Array)return l.Uint8(o);if(typeof o=="string")return l.Base64(o);if(o instanceof HTMLElement&&o.type==="file")return l.addListener(o,r);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(o,r){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(o===void 0||!(o instanceof HTMLElement)||o.tagName!=="INPUT"||o.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;r=r||function(){},o.addEventListener("change",function(a){if(!a.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let h=new FileReader;h.readAsArrayBuffer(a.target.files[0]),h.onload=function(d){r(l.Uint8(new Uint8Array(d.target.result)))}})},Base64:function(o){let r=function(d){var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(d=d.replace(/^.*?base64,/,""),d=String(d).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(d))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");d+="==".slice(2-(3&d.length));let b,u="",e,t,c=0;for(;c<d.length;)b=E.indexOf(d.charAt(c++))<<18|E.indexOf(d.charAt(c++))<<12|(e=E.indexOf(d.charAt(c++)))<<6|(t=E.indexOf(d.charAt(c++))),u+=e===64?String.fromCharCode(b>>16&255):t===64?String.fromCharCode(b>>16&255,b>>8&255):String.fromCharCode(b>>16&255,b>>8&255,255&b);return u}(o=String(o));var a=r.length;let h=new Uint8Array(new ArrayBuffer(a));for(let d=0;d<a;d++)h[d]=r.charCodeAt(d);return l.Uint8(h)},Uint8:function(h){let r={data:null,pointer:0,movePointer:function(e){return this.pointer+=e,this.pointer},readInt:function(e){if((e=Math.min(e,this.data.byteLength-this.pointer))<1)return-1;let t=0;if(1<e)for(let c=1;c<=e-1;c++)t+=this.data.getUint8(this.pointer)*Math.pow(256,e-c),this.pointer++;return t+=this.data.getUint8(this.pointer),this.pointer++,t},readStr:function(e){let t=new Uint8Array(e),c=!1,n;t.forEach((f,p)=>{t[p]=this.readInt(1)});for(let f=0;f<s.length;f++)if(!c)try{if(n=s[f].decode(t),f==0)for(let p=0;p<n.length;p++){let g=n.charCodeAt(p);if(g>191||g>127&&g<160)throw new RangeError(`Invalid code point: ${g}`)}c=!0,console.debug(`String byte sequence in ${s[f].encoding}`)}catch(p){console.debug(`SMF string ${p}`)}return n||"String byte sequence read failed."},backOne:function(){this.pointer--},readIntVLV:function(){let e=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)e=this.readInt(1);else{let c=[];for(;128<=this.data.getUint8(this.pointer);)c.push(this.readInt(1)-128);var t=this.readInt(1);for(let n=1;n<=c.length;n++)e+=c[c.length-n]*Math.pow(128,n);e+=t}return e}};if(r.data=new DataView(h.buffer,h.byteOffset,h.byteLength),r.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;r.readInt(4);let a={};a.formatType=r.readInt(2),a.tracks=r.readInt(2),a.track=[];var h=r.readInt(1),d=r.readInt(1);128<=h?(a.timeDivision=[],a.timeDivision[0]=h-128,a.timeDivision[1]=d):a.timeDivision=256*h+d;for(let e=1;e<=a.tracks;e++){a.track[e-1]={event:[]};var E,b=r.readInt(4);if(b===-1)break;if(b!==1297379947)return!1;r.readInt(4);let t=0,c=!1,n,f;for(;!c&&(t++,a.track[e-1].event[t-1]={},a.track[e-1].event[t-1].deltaTime=r.readIntVLV(),(n=r.readInt(1))!==-1);)if(128<=n?f=n:(n=f,r.movePointer(-1)),n===255){a.track[e-1].event[t-1].type=255,a.track[e-1].event[t-1].metaType=r.readInt(1);var u=r.readIntVLV();switch(a.track[e-1].event[t-1].metaType){case 47:case-1:c=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:a.track[e-1].event[t-1].data=r.readStr(u);break;case 33:case 89:case 81:a.track[e-1].event[t-1].data=r.readInt(u);break;case 84:a.track[e-1].event[t-1].data=[],a.track[e-1].event[t-1].data[0]=r.readInt(1),a.track[e-1].event[t-1].data[1]=r.readInt(1),a.track[e-1].event[t-1].data[2]=r.readInt(1),a.track[e-1].event[t-1].data[3]=r.readInt(1),a.track[e-1].event[t-1].data[4]=r.readInt(1);break;case 88:a.track[e-1].event[t-1].data=[],a.track[e-1].event[t-1].data[0]=r.readInt(1),a.track[e-1].event[t-1].data[1]=r.readInt(1),a.track[e-1].event[t-1].data[2]=r.readInt(1),a.track[e-1].event[t-1].data[3]=r.readInt(1);break;default:this.customInterpreter!==null&&(a.track[e-1].event[t-1].data=this.customInterpreter(a.track[e-1].event[t-1].metaType,r,u)),this.customInterpreter!==null&&a.track[e-1].event[t-1].data!==!1||(r.readInt(u),a.track[e-1].event[t-1].data=r.readInt(u),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch((n=n.toString(16).split(""))[1]||n.unshift("0"),a.track[e-1].event[t-1].type=parseInt(n[0],16),a.track[e-1].event[t-1].channel=parseInt(n[1],16),a.track[e-1].event[t-1].type){case 15:this.customInterpreter!==null&&(a.track[e-1].event[t-1].data=this.customInterpreter(a.track[e-1].event[t-1].type,r,!1)),this.customInterpreter!==null&&a.track[e-1].event[t-1].data!==!1||(E=r.readIntVLV(),a.track[e-1].event[t-1].data=r.readInt(E),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer"));break;case 10:case 11:case 14:case 8:case 9:a.track[e-1].event[t-1].data=[],a.track[e-1].event[t-1].data[0]=r.readInt(1),a.track[e-1].event[t-1].data[1]=r.readInt(1);break;case 12:case 13:a.track[e-1].event[t-1].data=r.readInt(1);break;case-1:c=!0;break;default:if(this.customInterpreter!==null&&(a.track[e-1].event[t-1].data=this.customInterpreter(a.track[e-1].event[t-1].metaType,r,!1)),this.customInterpreter===null||a.track[e-1].event[t-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return a},customInterpreter:null};if(typeof w<"u")w.exports=l;else{let o=typeof window=="object"&&window.self===window&&window||typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;o.MidiParser=l}})()});var S=class{#e={};context;set(i,s){this.#e[i]=s}has(i){return!!this.#e[i]}async read(i,s){if(!this.has(i))throw new Error(`No decoder registered for "${i}"`);return await this.#e[i].call(this.context||this,s)}};var H=function(i,s){let l=!0;return s.forEach((o,r)=>{l=l&&i[r]==o}),l},m=function(i){let s=0;return i.forEach(l=>{s*=256,s+=l}),s},y=new TextDecoder,$=new S;$.set("s7e",async function(i){let s=new Uint8Array(await i.slice(0,65536).arrayBuffer()),l="MSB	LSB	PRG	NME",o=[0,0,0,0],r=32,a=0,h=0,d=!0,E=[],b=0;for(;d;){let u=s.subarray(a);([()=>{y.decode(u.subarray(0,4))=="YSFC"?(a+=80,h=1):a++},()=>{if(H(u.subarray(0,4),o))E.forEach((e,t,c)=>{let n=m(s.subarray(e.start+4,e.start+8));e.length=n}),h=2;else{let e=y.decode(u.subarray(0,4)),t=m(u.subarray(4,8));E.push({type:e,start:t}),a+=8}},()=>{let e=E[b],t=s.subarray(e.start,e.start+e.length),c=32;switch(e.type){case"ENVC":{let n=r;for(;n<t.length;){let f=t.subarray(n,n+c),p=y.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)=="Init "&&(p=""),p&&(l+=`
063	${(f[17]+13).toString().padStart(3,"0")}	${f[19].toString().padStart(3,"0")}	${p}`),n+=c}break}case"EDVC":{let n=r;for(;n<t.length;){let f=t.subarray(n,n+c),p=y.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)=="Init "&&(p=""),p&&(l+=`
063	024	${f[19].toString().padStart(3,"0")}	${p}`),n+=c}break}case"EPVC":{let n=32,f=r;for(;f<t.length;){let p=t.subarray(f,f+n),g=y.decode(p.subarray(0,10)).trimEnd();g=="----------"&&(g=""),g&&(l+=`
063	${(p[17]+1).toString().padStart(3,"0")}	${p[19].toString().padStart(3,"0")}	${g}`),f+=n}break}}b++,b>=E.length&&(h=3,d=!1)}][h]||(()=>{d=!1}))()}return l});$.set("pcg",async function(i){let s=new Uint8Array(await i.arrayBuffer()),l="MSB	LSB	PRG	NME",o=100,r=0,a=0,h=!0,d=[],E=0;for(;h;){let b=s.subarray(o);([()=>{h=y.decode(b.subarray(0,4))=="INI2",a=b[15],o+=16,r=1},()=>{let u=y.decode(b.subarray(0,4)),e=b[5],t=b[7],c=b[11],n=m(b.subarray(12,16)),f=m(b.subarray(16,20)),p=m(b.subarray(36,40)),g=y.decode(b.subarray(44,44+c));d.push({type:u,tipMsb:e,tipLsb:t,nameLen:c,length:n,start:f,entryLen:p,name:g}),o+=64,a--,a<1&&(r=2)},()=>{let u=d[E],e=s.subarray(u.start,u.start+u.length);switch(u.type){case"PRG1":break;case"PBK1":{let t=63,c=(u.tipMsb?6:0)+u.tipLsb;for(let n=0;n<128;n++){let f=n*u.entryLen,p=e.subarray(f,f+u.entryLen),g=y.decode(p.subarray(0,24)).trimEnd().replace("InitProg","");g.length&&c>5&&(l+=`
${t.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${n.toString().padStart(3,"0")}	${g}`)}break}case"CBK1":{let t=63,c=(u.tipMsb?3:0)+u.tipLsb+10;for(let n=0;n<128;n++){let f=n*u.entryLen,p=e.subarray(f,f+u.entryLen),g=y.decode(p.subarray(0,24)).trimEnd().replace("InitCombi","");g.length&&c>12&&(l+=`
${t.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${n.toString().padStart(3,"0")}	${g}`)}break}}E++,E>=d.length&&(r=3,h=!1)}][r]||(()=>{h=!1}))()}return l});var B=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"].concat(new Array(4),["white room","tunnel","canyon","basement","karaoke"],new Array(43),["pass through","chorus","celeste","flanger","symphonic","rotary speaker","tremelo","auto pan","phaser","distortion","overdrive","amplifier","3-band EQ","2-band EQ","auto wah"],new Array(1),["pitch change","harmonic","touch wah","compressor","noise gate","voice channel","2-way rotary speaker","ensemble detune","ambience"],new Array(4),["talking mod","Lo-Fi","dist + delay","comp + dist + delay","wah + dist + delay","V dist","dual rotor speaker"]);var G=",a,i,u,e,o,ka,ki,ku,ke,ko,ky,kw,sa,si,su,se,so,sh,ta,ti,tu,te,to,t,ch,t,s,na,ni,nu,ne,no,ny,nn,ha,hi,hu,he,ho,hy,fa,fi,fu,fe,fo,ma,mi,mu,me,mo,my,mm,ya,yu,ye,yo,ra,ri,ru,re,ro,ry,wa,wi,we,wo,ga,gi,gu,ge,go,gy,gw,za,zi,zu,ze,zo,ja,ji,ju,je,jo,jy,da,di,du,de,do,dy,ba,bi,bu,be,bo,by,va,vi,vu,ve,vo,pa,pi,pu,pe,po,py,nga,ngi,ngu,nge,ngo,ngy,ng,hha,hhi,hhu,hhe,hho,hhy,hhw,*,_,,,~,.".split(","),_={};`hi*,
ka,か
ki,き
ku,く
ke,け
ko,こ
ky,き!
kw,くl
tsu,つ
ts,つl
sa,さ
si,すぃ
su,す
se,せ
so,そ
shi,し
sh,し!
ta,た
ti,てぃ
tu,とぅ
te,て
to,と
tchy,ち!
tchi,ち
na,な
ni,に
nu,ぬ
ne,ね
no,の
ny,に!
nn,ん
ha,は
hi,ひ
hu,ほぅ
he,へ
ho,ほ
hy,ひ!
fa,ふぁ
fi,ふぃ
fu,ふ
fe,ふぇ
fo,ふぉ
ma,ま
mi,み
mu,む
me,め
mo,も
my,み!
mm,
ra,ら
ri,り
ru,る
re,れ
ro,ろ
ry,り!
wa,わ
wi,うぃ
we,うぇ
wo,を
nga,ガ
ngi,ギ
ngu,グ
nge,ゲ
ngo,ゴ
ngy,ギ!
ng,
ga,が
gi,ぎ
gu,ぐ
ge,げ
go,ご
gy,ぎ!
gw,ぐl
za,ざ
zi,ずぃ
zu,ず
ze,ぜ
zo,ぞ
ja,じゃ
ji,じ
ju,じゅ
je,じぇ
jo,じょ
jy,じ!
da,だ
di,でぃ
du,どぅ
de,で
do,ど
dy,で!
ba,ば
bi,び
bu,ぶ
be,べ
bo,ぼ
by,び!
va,ゔぁ
vi,ゔぃ
vu,ゔ
ve,ゔぇ
vo,ゔぉ
pa,ぱ
pi,ぴ
pu,ぷ
pe,ペ
po,ぽ
py,ぴ!
!ya,ゃ
!yu,ゅ
!ye,ぇ
!yo,ょ
ya,や
yu,ゆ
ye,いぇ
yo,よ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
la,ぁ
li,ぃ
lu,ぅ
le,ぇ
lo,ぉ
a,あ
i,い
u,う
e,え
o,お
*,っ
~,
^,
_,`.split(`
`).forEach(i=>{let s=i.split(",");_[s[0]]=s[1]});var C=function(i,s,l){let o=[],r=l==!1?s.readIntVLV():l;i==0||i==127;for(let a=0;a<r;a++){let h=s.readInt(1);if(o.push(h),h!=247){if(h!=240){if(h>127)return console.debug(`Early termination: ${o}`),o.pop(),s.backOne(),s.backOne(),new Uint8Array(o)}}}return new Uint8Array(o)};var X=["?","gm","gs","sc","xg","g2","mt32","doc","qy10","qy20","ns5r","x5d","05rw","k11","sg","sd","krs","s90es","motif","trin"];var V=["melodic","drum","menu"];var v=[20,21,22,23,24,25,26,28,29,30,31,36,37,48,49,52,53,64,65];var k=[0,1,2,4,5,6,7,8,10,11,32,38,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84,91,92,93,94,95,98,99,100,101,128,12,13,16,17,18,19,14,15,20,21,26,28,80,81,83,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157];var F={};X.forEach((i,s)=>{F[i]=s});var K={length:k.length};k.forEach((i,s)=>{K[i]=s});var z={length:v.length};v.forEach((i,s)=>{z[i]=s});var q={};V.forEach((i,s)=>{q[i]=s});var T=8,Be={port:T,ch:T<<4,cc:k.length,nn:128,pl:512,tr:256,cmt:14,rpn:6,rpnt:4,ace:8,drm:8,dpn:v.length,dnc:128,ext:3,efx:7,cvn:12,redir:32,invalidCh:255};var R=N(M(),1);R.default.customInterpreter=C;var Je=function(){return new BroadcastChannel("cc.ltgc.octavia:MainInput")},et=function(){return new BroadcastChannel("cc.ltgc.octavia:MainOutput")};export{Je as getBridge,et as getBridgeOut};
