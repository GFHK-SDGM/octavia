var O=Object.create;var S=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var H=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports);var N=(t,s,c,l)=>{if(s&&typeof s=="object"||typeof s=="function")for(let i of I(s))!U.call(t,i)&&i!==c&&S(t,i,{get:()=>s[i],enumerable:!(l=A(s,i))||l.enumerable});return t};var B=(t,s,c)=>(c=t!=null?O(L(t)):{},N(s||!t||!t.__esModule?S(c,"default",{value:t,enumerable:!0}):c,t));var R=H((Qe,C)=>{(function(){"use strict";let t={fatal:!0},s=[new TextDecoder("iso-8859-15",t),new TextDecoder("sjis",t),new TextDecoder("euc-jp",t),new TextDecoder("utf-8",t),new TextDecoder("utf-16",t),new TextDecoder("ascii")],c={debug:!1,parse:function(l,i){if(l instanceof Uint8Array)return c.Uint8(l);if(typeof l=="string")return c.Base64(l);if(l instanceof HTMLElement&&l.type==="file")return c.addListener(l,i);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(l,i){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(l===void 0||!(l instanceof HTMLElement)||l.tagName!=="INPUT"||l.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;i=i||function(){},l.addEventListener("change",function(r){if(!r.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let h=new FileReader;h.readAsArrayBuffer(r.target.files[0]),h.onload=function(d){i(c.Uint8(new Uint8Array(d.target.result)))}})},Base64:function(l){let i=function(d){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(d=d.replace(/^.*?base64,/,""),d=String(d).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(d))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");d+="==".slice(2-(3&d.length));let b,u="",e,a,o=0;for(;o<d.length;)b=m.indexOf(d.charAt(o++))<<18|m.indexOf(d.charAt(o++))<<12|(e=m.indexOf(d.charAt(o++)))<<6|(a=m.indexOf(d.charAt(o++))),u+=e===64?String.fromCharCode(b>>16&255):a===64?String.fromCharCode(b>>16&255,b>>8&255):String.fromCharCode(b>>16&255,b>>8&255,255&b);return u}(l=String(l));var r=i.length;let h=new Uint8Array(new ArrayBuffer(r));for(let d=0;d<r;d++)h[d]=i.charCodeAt(d);return c.Uint8(h)},Uint8:function(h){let i={data:null,pointer:0,movePointer:function(e){return this.pointer+=e,this.pointer},readInt:function(e){if((e=Math.min(e,this.data.byteLength-this.pointer))<1)return-1;let a=0;if(1<e)for(let o=1;o<=e-1;o++)a+=this.data.getUint8(this.pointer)*Math.pow(256,e-o),this.pointer++;return a+=this.data.getUint8(this.pointer),this.pointer++,a},readStr:function(e){let a=new Uint8Array(e),o=!1,n;a.forEach((f,p)=>{a[p]=this.readInt(1)});for(let f=0;f<s.length;f++)if(!o)try{if(n=s[f].decode(a),f==0)for(let p=0;p<n.length;p++){let E=n.charCodeAt(p);if(E>191||E>127&&E<160)throw new RangeError(`Invalid code point: ${E}`)}o=!0,console.debug(`String byte sequence in ${s[f].encoding}`)}catch(p){console.debug(`SMF string ${p}`)}return n||"String byte sequence read failed."},backOne:function(){this.pointer--},readIntVLV:function(){let e=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)e=this.readInt(1);else{let o=[];for(;128<=this.data.getUint8(this.pointer);)o.push(this.readInt(1)-128);var a=this.readInt(1);for(let n=1;n<=o.length;n++)e+=o[o.length-n]*Math.pow(128,n);e+=a}return e}};if(i.data=new DataView(h.buffer,h.byteOffset,h.byteLength),i.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;i.readInt(4);let r={};r.formatType=i.readInt(2),r.tracks=i.readInt(2),r.track=[];var h=i.readInt(1),d=i.readInt(1);128<=h?(r.timeDivision=[],r.timeDivision[0]=h-128,r.timeDivision[1]=d):r.timeDivision=256*h+d;for(let e=1;e<=r.tracks;e++){r.track[e-1]={event:[]};var m,b=i.readInt(4);if(b===-1)break;if(b!==1297379947)return!1;i.readInt(4);let a=0,o=!1,n,f;for(;!o&&(a++,r.track[e-1].event[a-1]={},r.track[e-1].event[a-1].deltaTime=i.readIntVLV(),(n=i.readInt(1))!==-1);)if(128<=n?f=n:(n=f,i.movePointer(-1)),n===255){r.track[e-1].event[a-1].type=255,r.track[e-1].event[a-1].metaType=i.readInt(1);var u=i.readIntVLV();switch(r.track[e-1].event[a-1].metaType){case 47:case-1:o=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:r.track[e-1].event[a-1].data=i.readStr(u);break;case 33:case 89:case 81:r.track[e-1].event[a-1].data=i.readInt(u);break;case 84:r.track[e-1].event[a-1].data=[],r.track[e-1].event[a-1].data[0]=i.readInt(1),r.track[e-1].event[a-1].data[1]=i.readInt(1),r.track[e-1].event[a-1].data[2]=i.readInt(1),r.track[e-1].event[a-1].data[3]=i.readInt(1),r.track[e-1].event[a-1].data[4]=i.readInt(1);break;case 88:r.track[e-1].event[a-1].data=[],r.track[e-1].event[a-1].data[0]=i.readInt(1),r.track[e-1].event[a-1].data[1]=i.readInt(1),r.track[e-1].event[a-1].data[2]=i.readInt(1),r.track[e-1].event[a-1].data[3]=i.readInt(1);break;default:this.customInterpreter!==null&&(r.track[e-1].event[a-1].data=this.customInterpreter(r.track[e-1].event[a-1].metaType,i,u)),this.customInterpreter!==null&&r.track[e-1].event[a-1].data!==!1||(i.readInt(u),r.track[e-1].event[a-1].data=i.readInt(u),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch((n=n.toString(16).split(""))[1]||n.unshift("0"),r.track[e-1].event[a-1].type=parseInt(n[0],16),r.track[e-1].event[a-1].channel=parseInt(n[1],16),r.track[e-1].event[a-1].type){case 15:this.customInterpreter!==null&&(r.track[e-1].event[a-1].data=this.customInterpreter(r.track[e-1].event[a-1].type,i,!1)),this.customInterpreter!==null&&r.track[e-1].event[a-1].data!==!1||(m=i.readIntVLV(),r.track[e-1].event[a-1].data=i.readInt(m),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer"));break;case 10:case 11:case 14:case 8:case 9:r.track[e-1].event[a-1].data=[],r.track[e-1].event[a-1].data[0]=i.readInt(1),r.track[e-1].event[a-1].data[1]=i.readInt(1);break;case 12:case 13:r.track[e-1].event[a-1].data=i.readInt(1);break;case-1:o=!0;break;default:if(this.customInterpreter!==null&&(r.track[e-1].event[a-1].data=this.customInterpreter(r.track[e-1].event[a-1].metaType,i,!1)),this.customInterpreter===null||r.track[e-1].event[a-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return r},customInterpreter:null};if(typeof C<"u")C.exports=c;else{let l=typeof window=="object"&&window.self===window&&window||typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;l.MidiParser=c}})()});var T=class{#e={};context;set(t,s){this.#e[t]=s}has(t){return!!this.#e[t]}async read(t,s){if(!this.has(t))throw new Error(`No decoder registered for "${t}"`);return await this.#e[t].call(this.context||this,s)}};var G=function(t,s){let c=!0;return s.forEach((l,i)=>{c=c&&t[i]==l}),c},v=function(t){let s=0;return t.forEach(c=>{s*=256,s+=c}),s},y=new TextDecoder,$=new T;$.set("s7e",async function(t){let s=new Uint8Array(await t.slice(0,65536).arrayBuffer()),c="MSB	LSB	PRG	NME",l=[0,0,0,0],i=32,r=0,h=0,d=!0,m=[],b=0;for(;d;){let u=s.subarray(r);([()=>{y.decode(u.subarray(0,4))=="YSFC"?(r+=80,h=1):r++},()=>{if(G(u.subarray(0,4),l))m.forEach((e,a,o)=>{let n=v(s.subarray(e.start+4,e.start+8));e.length=n}),h=2;else{let e=y.decode(u.subarray(0,4)),a=v(u.subarray(4,8));m.push({type:e,start:a}),r+=8}},()=>{let e=m[b],a=s.subarray(e.start,e.start+e.length),o=32;switch(e.type){case"ENVC":{let n=i;for(;n<a.length;){let f=a.subarray(n,n+o),p=y.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)=="Init "&&(p=""),p&&(c+=`
063	${(f[17]+13).toString().padStart(3,"0")}	${f[19].toString().padStart(3,"0")}	${p}`),n+=o}break}case"EDVC":{let n=i;for(;n<a.length;){let f=a.subarray(n,n+o),p=y.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)=="Init "&&(p=""),p&&(c+=`
063	024	${f[19].toString().padStart(3,"0")}	${p}`),n+=o}break}case"EPVC":{let n=32,f=i;for(;f<a.length;){let p=a.subarray(f,f+n),E=y.decode(p.subarray(0,10)).trimEnd();E=="----------"&&(E=""),E&&(c+=`
063	${(p[17]+1).toString().padStart(3,"0")}	${p[19].toString().padStart(3,"0")}	${E}`),f+=n}break}}b++,b>=m.length&&(h=3,d=!1)}][h]||(()=>{d=!1}))()}return c});$.set("pcg",async function(t){let s=new Uint8Array(await t.arrayBuffer()),c="MSB	LSB	PRG	NME",l=100,i=0,r=0,h=!0,d=[],m=0;for(;h;){let b=s.subarray(l);([()=>{h=y.decode(b.subarray(0,4))=="INI2",r=b[15],l+=16,i=1},()=>{let u=y.decode(b.subarray(0,4)),e=b[5],a=b[7],o=b[11],n=v(b.subarray(12,16)),f=v(b.subarray(16,20)),p=v(b.subarray(36,40)),E=y.decode(b.subarray(44,44+o));d.push({type:u,tipMsb:e,tipLsb:a,nameLen:o,length:n,start:f,entryLen:p,name:E}),l+=64,r--,r<1&&(i=2)},()=>{let u=d[m],e=s.subarray(u.start,u.start+u.length);switch(u.type){case"PRG1":break;case"PBK1":{let a=63,o=(u.tipMsb?6:0)+u.tipLsb;for(let n=0;n<128;n++){let f=n*u.entryLen,p=e.subarray(f,f+u.entryLen),E=y.decode(p.subarray(0,24)).trimEnd().replace("InitProg","");E.length&&o>5&&(c+=`
${a.toString().padStart(3,"0")}	${o.toString().padStart(3,"0")}	${n.toString().padStart(3,"0")}	${E}`)}break}case"CBK1":{let a=63,o=(u.tipMsb?3:0)+u.tipLsb+10;for(let n=0;n<128;n++){let f=n*u.entryLen,p=e.subarray(f,f+u.entryLen),E=y.decode(p.subarray(0,24)).trimEnd().replace("InitCombi","");E.length&&o>12&&(c+=`
${a.toString().padStart(3,"0")}	${o.toString().padStart(3,"0")}	${n.toString().padStart(3,"0")}	${E}`)}break}}m++,m>=d.length&&(i=3,h=!1)}][i]||(()=>{h=!1}))()}return c});var _=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"].concat(new Array(4),["white room","tunnel","canyon","basement","karaoke"],new Array(43),["pass through","chorus","celeste","flanger","symphonic","rotary speaker","tremelo","auto pan","phaser","distortion","overdrive","amplifier","3-band EQ","2-band EQ","auto wah"],new Array(1),["pitch change","harmonic","touch wah","compressor","noise gate","voice channel","2-way rotary speaker","ensemble detune","ambience"],new Array(4),["talking mod","Lo-Fi","dist + delay","comp + dist + delay","wah + dist + delay","V dist","dual rotor speaker"]);var X=",a,i,u,e,o,ka,ki,ku,ke,ko,ky,kw,sa,si,su,se,so,sh,ta,ti,tu,te,to,t,ch,t,s,na,ni,nu,ne,no,ny,nn,ha,hi,hu,he,ho,hy,fa,fi,fu,fe,fo,ma,mi,mu,me,mo,my,mm,ya,yu,ye,yo,ra,ri,ru,re,ro,ry,wa,wi,we,wo,ga,gi,gu,ge,go,gy,gw,za,zi,zu,ze,zo,ja,ji,ju,je,jo,jy,da,di,du,de,do,dy,ba,bi,bu,be,bo,by,va,vi,vu,ve,vo,pa,pi,pu,pe,po,py,nga,ngi,ngu,nge,ngo,ngy,ng,hha,hhi,hhu,hhe,hho,hhy,hhw,*,_,,,~,.".split(","),V={};`hi*,
ka,か
ki,き
ku,く
ke,け
ko,こ
ky,き!
kw,くl
tsu,つ
ts,つl
sa,さ
si,すぃ
su,す
se,せ
so,そ
shi,し
sh,し!
ta,た
ti,てぃ
tu,とぅ
te,て
to,と
tchy,ち!
tchi,ち
na,な
ni,に
nu,ぬ
ne,ね
no,の
ny,に!
nn,ん
ha,は
hi,ひ
hu,ほぅ
he,へ
ho,ほ
hy,ひ!
fa,ふぁ
fi,ふぃ
fu,ふ
fe,ふぇ
fo,ふぉ
ma,ま
mi,み
mu,む
me,め
mo,も
my,み!
mm,ㇺ
ra,ら
ri,り
ru,る
re,れ
ro,ろ
ry,り!
wa,わ
wi,うぃ
we,うぇ
wo,を
nga,か゚
ngi,き゚
ngu,く゚
nge,け゚
ngo,こ゚
ngy,き゚!
ng,ン
ga,が
gi,ぎ
gu,ぐ
ge,げ
go,ご
gy,ぎ!
gw,ぐl
za,ざ
zi,ずぃ
zu,ず
ze,ぜ
zo,ぞ
ja,じゃ
ji,じ
ju,じゅ
je,じぇ
jo,じょ
jy,じ!
da,だ
di,でぃ
du,どぅ
de,で
do,ど
dy,で!
ba,ば
bi,び
bu,ぶ
be,べ
bo,ぼ
by,び!
va,ゔぁ
vi,ゔぃ
vu,ゔ
ve,ゔぇ
vo,ゔぉ
pa,ぱ
pi,ぴ
pu,ぷ
pe,ペ
po,ぽ
py,ぴ!
!ya,ゃ
!yu,ゅ
!ye,ぇ
!yo,ょ
ya,や
yu,ゆ
ye,いぇ
yo,よ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
la,ぁ
li,ぃ
lu,ぅ
le,ぇ
lo,ぉ
a,あ
i,い
u,う
e,え
o,お
*,っ
~,
^,
_,`.split(`
`).forEach(t=>{let s=t.split(",");V[s[0]]=s[1]});var M=function(t,s,c){let l=[],i=c==!1?s.readIntVLV():c;t==0||t==127;for(let r=0;r<i;r++){let h=s.readInt(1);if(l.push(h),h!=247){if(h!=240){if(h>127)return console.debug(`Early termination: ${l}`),l.pop(),s.backOne(),s.backOne(),new Uint8Array(l)}}}return new Uint8Array(l)};var F=["?","gm","gs","sc","xg","g2","mt32","doc","qy10","qy20","ns5r","x5d","05rw","k11","sg","sd","krs","s90es","motif","trin"];var K=["melodic","drum","menu"];var z=[36,37,48,49,52,53],w=[20,21,22,23,24,25,26,28,29,30,31,36,37,48,49,52,53,64,65];var x=[0,1,2,4,5,6,7,8,10,11,32,38,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84,91,92,93,94,95,98,99,100,101,128,12,13,16,17,18,19,14,15,20,21,26,28,22,80,81,82,83,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157];var q={};F.forEach((t,s)=>{q[t]=s});var Q={length:x.length};x.forEach((t,s)=>{Q[t]=s});var W={length:w.length};w.forEach((t,s)=>{W[t]=s});var Y={};K.forEach((t,s)=>{Y[t]=s});var k=8,g={port:k,ch:k<<4,chShift:Math.ceil(Math.log2(k))+4,cc:x.length,nn:128,pl:512,tr:256,cmt:14,rpn:6,rpnt:4,nrpn:z.length,ace:8,drm:8,dpn:w.length,dnc:128,ext:3,efx:7,cvn:12,redir:32,vxPrim:3,invalidCh:255};var j=new Uint16Array(g.ch),Z=new Uint16Array(g.ch),J=new Uint16Array(g.ch),ee=new Uint16Array(g.ch),te=new Uint16Array(g.ch),P=new Array(g.drm);for(let t=0;t<g.ch;t++)j[t]=t*g.cc,Z[t]=t*g.rpn,J[t]=t*g.nrpn,ee[t]=t*g.ace,te[t]=t*g.ext;for(let t=0;t<g.drm;t++){P[t]=new Uint16Array(g.dpn);let s=t*g.dpn*g.dnc;for(let c=0;c<g.dpn;c++)P[t][c]=s+c*g.dnc}var D=B(R(),1);D.default.customInterpreter=M;var nt=function(){return new BroadcastChannel("cc.ltgc.octavia:MainInput")},ct=function(){return new BroadcastChannel("cc.ltgc.octavia:MainOutput")};export{nt as getBridge,ct as getBridgeOut};
