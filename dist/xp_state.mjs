var Jt=Object.defineProperty;var Zt=(E,e,a)=>e in E?Jt(E,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):E[e]=a;var P=(E,e,a)=>(Zt(E,typeof e!="symbol"?e+"":e,a),a),xt=(E,e,a)=>{if(!e.has(E))throw TypeError("Cannot "+a)};var t=(E,e,a)=>(xt(E,e,"read from private field"),a?a.call(E):e.get(E)),S=(E,e,a)=>{if(e.has(E))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(E):e.set(E,a)},x=(E,e,a,h)=>(xt(E,e,"write to private field"),h?h.call(E,a):e.set(E,a),a);(function(){var E=function(k,C,r){var s,f;if(self.MessageEvent)switch(k){case"message":{f=new MessageEvent(k,{data:C,ports:r==null?void 0:r.ports}),Object.defineProperty(f,"source",{value:r==null?void 0:r.source});break}default:f=new Event(k)}else f=document.createEvent("Event"),f.initEvent(k,!1,!1),r&&k=="message"&&(f.data=C,r.source&&Object.defineProperty(f,"source",{value:r.source}),(s=r.ports)!=null&&s.length&&Object.defineProperty(f,"ports",{value:r.ports}));return f};self.BroadcastChannel?console.info("[Snowy] Snowy is disabled."):(console.info("[Snowy] Snowy is enabled. Path: ".concat(self.SNOWY_PATH||"/snowy.js")),a=[],h={},u=function(k){var C,r=this;if((this==null?void 0:this.constructor)!=u)throw new TypeError("Illegal constructor");a.push(this),(C=h[k])!=null&&C.constructor||(h[k]=[]),h[k].push(this);var s=Math.floor(Math.random()*281474976710656),f=[],i=0,c=[],o=!0,n=!1;Object.defineProperty(this,"id",{get:function(){return s}}),Object.defineProperty(this,"name",{value:k}),this.close=function(){var l,m=a.indexOf(r);m>-1?(e.postMessage({t:"d",c:k,i:s}),a.splice(m,1),(l=h[k])!=null&&l.constructor&&(m=h[k].indexOf(r),m>-1&&h[k].splice(m,1)),h[k].length||delete h[k],console.debug("[Snowy] BroadcastChannel closed."),n=!0):console.debug("[Snowy] BroadcastChannel already closed.")},this.postMessage=function(l){if(e){if(n)throw new Error("Channel already closed");e.postMessage({t:"m",c:k,i:s,m:i,d:l}),i++,i>4294967295&&(i=0)}else c.push(l),console.debug("[Snowy] Message is cached.")},this.flush=function(){if(e){if(o){for(e.postMessage({t:"r",c:k,i:s}),console.debug("[Snowy] ".concat(c.length," message(s) in cache."));c.length;){var l=c.shift();r.postMessage(l)}o=!1,console.debug("[Snowy] All cached messages are flushed away.")}}else throw new Error("Tried to flush when the ports are not ready")},this.receiveMessage=function(l){l.c==k?l.i!=s&&r.dispatchEvent(E("message",l.d,{source:r})):console.debug("[Snowy] Channel ID mismatch. Instance ".concat(s," receives from ").concat(k,", not ").concat(l.c,"."))};var d={};this.dispatchEvent=function(l){var m,$;if(Object.defineProperty(l,"target",{value:r}),Object.defineProperty(l,"currentTarget",{value:r}),(m=d[l.type])!=null&&m.length)for(var T=d[l.type],M=0;M<T.length;M++)(($=T[M])==null?void 0:$.constructor)==Function&&T[M].call(r,l);r["on".concat(l.type)]&&r["on".concat(l.type)].constructor==Function&&r["on".concat(l.type)].call(r,l)},this.addEventListener=function(l,m){var $;($=d[l])!=null&&$.constructor||(d[l]=[]);var T=d[l].indexOf(m);T==-1&&d[l].push(m)},this.removeEventListener=function(l,m){var $,T;if(($=d[l])!=null&&$.length){var M=d[l].indexOf(m);M>-1&&d[l].splice(M,1)}!((T=d[l])!=null&&T.length)&&d[l].constructor&&delete d[l]}},self.BroadcastChannel=u,b=function(){if(e){e.addEventListener("message",function(C){var r=C.data,s=!1;switch(r.t){case"k":{s=!1,e.postMessage({t:"k"});break}case"m":{var f=h[r.c];if(f!=null&&f.length)for(var i=0;i<f.length;i++)f[i].receiveMessage(r);break}case"c":{for(var c=[],o=0;o<a.length;o++){var n=a[o].name;c.indexOf(n)<0&&c.push(n)}e.postMessage({t:"k",c});break}default:s=!0}s&&console.info("ReceiveBroadcast",r)});for(var k=0;k<a.length;k++)a[k].flush()}else throw new Error("Message port isn't yet ready");console.info("[Snowy] Snowy is active.")},v=function(){if(!e){var k=new SharedWorker(self.SNOWY_PATH||"/snowy.js");k.port.start();var C=function(r){r.data.t=="swc"&&(k.port.removeEventListener("message",C),e=k.port,e.postMessage({t:"k"}),b())};k.port.addEventListener("message",C)}},v());var e,a,h,u,b,v})();{let E=function(e,a){let h=new FileReader;return new Promise((u,b)=>{switch(h.addEventListener("abort",()=>{b(new Error("Blob read aborted"))}),h.addEventListener("error",v=>{b(h.error||v.data||new Error("Blob read error"))}),h.addEventListener("load",()=>{u(h.result)}),a.toLowerCase()){case"arraybuffer":case"buffer":{h.readAsArrayBuffer(e);break}case"string":case"text":{h.readAsText(e);break}default:b(new Error(`Unknown target ${a}`))}})};Blob.prototype.arrayBuffer=Blob.prototype.arrayBuffer||function(){return E(this,"buffer")},Blob.prototype.text=Blob.prototype.text||function(){return E(this,"text")}}String.prototype.replaceAll=String.prototype.replaceAll||function(E,e){let a=0,h=16,u=this,b=[];for(;a<h&&u.lastIndexOf(E)>-1;){let v=u.lastIndexOf(E);b.unshift(u.slice(v+E.length)),u=u.slice(0,v),v==0&&b.unshift(""),a++}return u.length&&b.unshift(u),b.join(e)||""},String.prototype.padStart=String.prototype.padStart||function(E,e){if(e){let a=this;for(;a.length<E;)a=`${e}${a}`;return a}},String.prototype.padEnd=String.prototype.padEnd||function(E,e){if(e){let a=this;for(;a.length<E;)a+=e;return a}};var St=function(E,e){let a=Math.min(E.length,e.length),h=E.slice(0,a),u=e.slice(0,a),b=0,v=0;for(;v<a&&b==0;)b=Math.sign(h[v]-u[v]),v++;return b},de=function(E=""){this.name=E,this.pool=[],this.point=function(e,a=!1){if(this.pool.length>0){let h=this.pool.length,u=1<<Math.floor(Math.log2(h)),b=u,v=64;for(;u>=1&&v>=0;){if(v<=0)throw new Error("TTL reached.");if(b==h)b-=u;else{let C=St(e,this.pool[b]);switch(C){case 0:{v=0;break}case 1:{b+u<=h&&(b+=u);break}case-1:{b!=0&&(b-=u);break}default:console.warn(`Unexpected result ${C}.`)}}u=u>>1,v--}let k=!0;if(b>=this.pool.length)k=!1;else{let C=this;this.pool[b].forEach(function(r,s,f){k&&r!=e[s]&&(k=!1)}),!k&&St(e,this.pool[b])>0&&b++}return k||a?b:-1}else return a?0:-1},this.add=function(e,a){return e.data=a,this.pool.splice(this.point(e,!0),0,e),this},this.default=function(e){console.warn(`No match in "${this.name||"(unknown)"}" for "${e}". Default action not defined.`)},this.get=function(e){let a=this.point(e);if(a>-1)return this.pool[a].data;this.default(e)},this.run=function(e,...a){let h=this.point(e);h>-1?e.subarray?this.pool[h].data(e.subarray(this.pool[h].length),...a):this.pool[h].data(e.slice(this.pool[h].length),...a):this.default(e,...a)}};var ee,Ct,Tt=(Ct=class{constructor(){S(this,ee,{})}addEventListener(E,e){t(this,ee)[E]||(t(this,ee)[E]=[]),t(this,ee)[E].unshift(e)}removeEventListener(E,e){if(t(this,ee)[E]){let a=t(this,ee)[E].indexOf(e);a>-1&&t(this,ee)[E].splice(a,1),t(this,ee)[E].length<1&&delete t(this,ee)[E]}}dispatchEvent(E,e){var u;let a=new Event(E),h=this;a.data=e,((u=t(this,ee)[E])==null?void 0:u.length)>0&&t(this,ee)[E].forEach(function(b){try{b==null||b.call(h,a)}catch(v){console.error(v)}}),this[`on${E}`]&&this[`on${E}`](a)}},ee=new WeakMap,Ct);var jt=["MSB","PRG","LSB","NME","ELC","DRM","LVL"],er={krs:"KR",s90es:"ES",motif:"ES"},tr={krs:"Kr",s90es:"SE",motif:"ME"},bt=function(E){let e=Math.floor(E/10),a=E%10;return`${e.toString(16)}${a}`},q,Mt,gt=(Mt=class{constructor(...E){S(this,q,void 0);P(this,"strictMode",!1);this.loadFiles(...E)}get bankInfo(){return t(this,q)}get(E=0,e=0,a=0,h){var $,T;let u=[E,e,a],b,v=1,k=0,C,r,s=Array.from(arguments);switch(h){case"xg":{switch(E){case 0:{a==126?s[2]=125:a==127&&(s[2]=0);break}case 16:{a==126&&(s[2]=0);break}case 32:{a>125&&(s[2]=0),s[2]+=4;break}case 33:{(a>125||a==3)&&(s[2]=0),s[2]+=5;break}case 34:case 35:case 36:{a>125&&(s[2]=0),s[2]+=5;break}case 79:case 80:case 81:case 82:case 83:case 84:s[0]+=16;case 95:case 96:case 97:case 98:case 99:case 100:{a==126&&(s[2]=0);break}case 48:case 64:case 126:case 127:{a==126&&(E==127&&e==0||(s[2]=0));break}}break}case"gs":case"sc":{E==0&&a<5?s[2]=0:E>125&&a<5&&a!=2&&(s[2]=E,s[0]=0);break}case"g2":case"sd":{E>>1==40?s[2]|=16:E>95&&E<100&&(s[2]|=16,e>>4==7&&(s[0]=96));break}case"sg":{E==8&&a==0&&(s[2]=5);break}case"05rw":case"x5d":{E&&E<56&&(s[0]=56);break}case"s90es":{if(E==0)break;a<8?s[2]+=17:a<32?s[2]+=13:s[2]=(s[2]>>3)+19;break}case"motif":{if(E==0)break;a<8?s[2]+=28:a<32?s[2]+=13:s[2]=(s[2]>>3)+19;break}}let f=" ",i="M",c="",o=0,n=0;switch(s[0]){case 0:{switch(s[2]){case 127:{h=="xg"?i="GM-a":(i="MT-a",c="C/M");break}case 126:{h=="xg"?i="GM-n":(i="MT-b",c="C/M");break}case 7:{i="GM-k",c="GLX";break}case 5:{i="SG-a",c="000";break}case 4:{h=="gs"||h=="sc"?(i="GM-a",c="000"):(i="SP-l",c="C/M");break}case 3:case 2:case 1:{(h=="gs"||h=="sc")&&(i="GM-a",c="000");break}case 0:{i="GM-a";break}default:i="y",o=3}break}case 8:{h=="sg"?i="GM-s":i="r:";break}case 32:case 33:case 34:case 35:case 36:{h=="xg"&&(i=`${["AP","VL","PF","DX","AN"][E&7]}-${"abcdefgh"[a]}`,o=3);break}case 48:{c=`M${(s[2]>>3).toString().padStart(2,"0")}`,i=`y${c}`,o=1;break}case 56:{i="GM-b";break}case 57:i=["yDOC","QY10","QY20"][s[2]-112]||"yMxv",c=["DOC","QY1","QY2"][s[2]-112]||"057";case 61:case 120:{i="rDrm";break}case 62:{i="kDrm";break}case 63:{if(s[2]<17){let M=s[2];i=M<10?"kP:":"kC:",i+=M%10}else s[2]<34?i=["Pre1","Pre2","Pre3","Pre4","Usr1","Usr2","DrmP","DrmU","Plg1","Plg2","Plg3","Pre1","Pre2","Pre3","Pre4","Pre5","Pre6"][s[2]-17]:i="Ds";o=1;break}case 64:{i="ySFX",c="SFX";break}case 67:{i="DX:S";break}case 80:case 81:case 82:case 83:{i=`Prg${"UABC"[s[0]-80]}`;break}case 88:case 89:case 90:case 91:{i=`Cmb${"UABC"[s[0]-88]}`;break}case 95:{i=`${["DR","PC"][s[2]]}-d`;break}case 96:{i=s[2]==106?"AP-a":s[2]>>4==1?"SDg":"PF",s[2]>63?n=63:s[2]>>4==1&&(n=16),o=3;break}case 97:{i=s[2]>>4==1?"SDa":"VL:",o=3,s[2]>>4==1?n=16:n=112;break}case 98:{i=s[2]>>4==1?"SDb":"SG-a",o=3,n=16;break}case 99:{i=s[2]>>4==1?"SDc":"DX",s[2]>63?n=63:s[2]>>4==1&&(n=16),o=3;break}case 100:{i="AN",s[2]>63?n=63:s[2]>>4==1&&(n=16),o=3;break}case 104:case 105:case 106:case 107:{i="SDd",n=104;break}case 121:{i=`GM-${s[2]?"":"a"}`,o=3;break}case 122:{i="lDrm";break}case 126:{i="yDrS";break}case 127:{s[2]==127?i="rDrm":i="yDrm";break}default:s[0]<48?i="r:":i="M"}i.length<4&&(i+=`${[E,a,s[0],s[2]][o]-n}`.padStart(4-i.length,"0")),c.length<3&&(c+=`${[E,a,E,a][o]}`.padStart(3-c.length,"0")),h=="xg"&&(E==0?s[2]<100?i=i.replace("y0","y:"):s[2]==125&&(i="y126"):E==16?(b=`Voice${((s[2]<<7)+s[1]+1).toString().padStart(3,"0")}`,f=" "):E==35&&a>>1==2&&(b=`DXCH_${(((s[2]&1)<<7)+e+1).toString().padStart(3,"0")}`,f=" "));let d=[s[0],s[1],s[2]];for(;!((b==null?void 0:b.length)>=0);)if(b=($=t(this,q)[s[1]||0][(s[0]<<8)+s[2]])==null?void 0:$.name,b){let M=t(this,q)[s[1]||0][(s[0]<<8)+s[2]];v=(M==null?void 0:M.poly)||v,k=(M==null?void 0:M.type)||k,C=M==null?void 0:M.drum,r=M==null?void 0:M.level}else if(this.strictMode)b="",f="?";else if(s[0]==0&&s[1]==0&&s[2]==0)b="Unloaded";else if(t(this,q)[s[1]||0][s[0]<<8])s[0]==0?(s[2]=0,f="^"):s[2]<1?(s[0]=0,f="*"):(s[2]--,f="^");else if(E==48)s[0]=0,s[2]=0,f="!";else if(E==62)s[1]--,f=" ",s[1]<1&&!(b!=null&&b.length)&&(s[0]=0,f="!");else if(E<63)s[0]==0?(s[2]=0,f="^"):s[2]<1?(s[0]=0,f="*"):s[2]--;else if(E==80)b=`PrgU:${e.toString().padStart(3,"0")}`,f="!";else if(E==88)b=`CmbU:${e.toString().padStart(3,"0")}`,f="!";else if(E==121)b=`GM2Vox0${a}`,f="#";else if(E==122)if(s[1]==32?s[1]==0:s[1]%=7,b=(T=t(this,q)[s[1]||0][(s[0]<<8)+s[2]])==null?void 0:T.name,b){f=" ";let M=t(this,q)[s[1]||0][(s[0]<<8)+s[2]];v=(M==null?void 0:M.poly)||v,k=(M==null?void 0:M.type)||k,C=M==null?void 0:M.drum,r=M==null?void 0:M.level}else b="",f="*";else s[1]==0?(b=`${E.toString().padStart(3,"0")} ${e.toString().padStart(3,"0")} ${a.toString().padStart(3,"0")}`,f="!"):s[0]==0?(s[2]=0,f="^"):s[2]>0?s[2]--:s[1]>0?(s[1]=0,f="!"):(s[0]=0,f="?");let l=[s[0],s[1],s[2]];switch(f){case"^":{switch(h){case"gs":case"sc":case"ns5r":{f=" ";break}}E==127&&f=="^"&&(f=" ");break}}let m="??";switch(s[0]){case 0:{s[2]==0?m="GM":s[2]==5||s[2]==7?m="KG":s[2]<126?m="XG":s[2]==127&&(m="MT");break}case 32:case 33:case 35:case 36:{s[2]>4?m=["AP","VL","PF","DX","AN"][s[0]-32]:m="GS";break}case 48:{m="MU";break}case 56:{m="AG";break}case 61:case 80:case 83:case 88:case 89:case 91:{m="AI";break}case 62:case 82:case 90:{m="XD";break}case 63:{s[2]<17?m="KR":s[2]<34?m="ES":m="DS";break}case 64:case 126:{m="XG";break}case 67:case 99:{m=s[2]>>4==1?"SD":"DX";break}case 81:{m="RW";break}case 95:{m=["DR","PC"][s[2]];break}case 96:{m=s[2]==106?"AP":s[2]>>4==1?"SD":"PF";break}case 97:{m=s[2]>>4==1?"SD":"VL";break}case 98:{m=s[2]>>4==1?"SD":"SG";break}case 100:{m="AN";break}case 104:case 105:case 106:case 107:{m="SD";break}case 120:{m="GS";break}case 121:{m=s[2]?"G2":"GM";break}case 122:{m="KG";break}case 127:{m=s[2]==127?"MT":e==0?"GM":"XG";break}default:s[0]<48&&(s[0]==16&&h=="xg"?m="XG":m="GS")}if(f!=" ")switch(h){case"krs":case"s90es":case"motif":{b="",m=er[h];break}default:self.debugMode&&(b="")}return{name:b||`${tr[h]||h.toUpperCase()}${bt(E||0)}${bt(e||0)}${bt(a||0)}`,poly:v,type:k,drum:C,level:r,iid:d,eid:l,sid:u,ending:f,sect:i,bank:c,standard:m,mode:h}}async load(E,e,a="(internal)",h){let u=this,b=[],v=0,k=0,C=0;E.split(`
`).forEach(function(r,s){var c;let f=r.split("	"),i=[];if(s==0){if(f.forEach(function(o,n){b[jt.indexOf(o)]=n}),b.length<4){console.debug("Debugger launched.");debugger}}else{let o=0,n=0,d=0,l,m=1,$=0,T,M;f.forEach(function(K,Ke){switch(Ke){case b[0]:{o=parseInt(K);break}case b[1]:{n=parseInt(K);break}case b[2]:{d=parseInt(K);break}case b[3]:{l=K;break}case b[4]:{K=parseInt(K),K<16?m=K+1:($=(K&15)+1,m=$);break}case b[5]:{M=K;break}case b[6]:{K!=null&&K.constructor&&(T=parseInt(K));break}}}),t(u,q)[n]=t(u,q)[n]||[];let W=t(u,q)[n],Te={msb:o,prg:n,lsb:d,name:l,poly:m,type:$,drum:M,level:T,priority:h},we=!1;h<((c=W[o<<8|d])==null?void 0:c.priority)&&(we=!0,C++),(!W[o<<8|d]||we||e)&&(W[o<<8|d]=Te,v++),k++}}),e||console.debug(`Map "${a}": ${k} total, ${v} loaded (${v-C} + ${C}).`)}clearRange(E){let e=E.prg!=null?E.prg.constructor==Array?E.prg:[E.prg,E.prg]:[0,127],a=E.msb!=null?E.msb.constructor==Array?E.msb:[E.msb,E.msb]:[0,127],h=E.lsb!=null?E.lsb.constructor==Array?E.lsb:[E.lsb,E.lsb]:[0,127];for(let u=a[0];u<=a[1];u++){let b=u<<8;for(let v=h[0];v<=h[1];v++){let k=b+v;for(let C=e[0];C<=e[1];C++)delete t(this,q)[C][k]}}}init(){x(this,q,[]);for(let E=0;E<128;E++)t(this,q).push([""])}async loadFiles(...E){this.init();let e=this;E.forEach(async function(a,h){try{e.load(await(await fetch(`./data/bank/${a}.tsv`)).text(),!1,a,h)}catch(u){console.error(`Failed loading "${a}.tsv".`)}})}},q=new WeakMap,Mt);var ze,Pt,Rt=(Pt=class{constructor(){S(this,ze,{});P(this,"context")}set(E,e){t(this,ze)[E]=e}has(E){return!!t(this,ze)[E]}async read(E,e){if(!this.has(E))throw new Error(`No decoder registered for "${E}"`);return await t(this,ze)[E].call(this.context||this,e)}},ze=new WeakMap,Pt);var rr=function(E,e){let a=!0;return e.forEach((h,u)=>{a=a&&E[u]==h}),a},et=function(E){let e=0;return E.forEach(a=>{e*=256,e+=a}),e},Ee=new TextDecoder,tt=new Rt;tt.set("s7e",async function(E){let e=new Uint8Array(await E.slice(0,65536).arrayBuffer()),a="MSB	LSB	PRG	NME",h=[0,0,0,0],u=32,b=0,v=0,k=!0,C=[],r=0;for(;k;){let s=e.subarray(b);([()=>{Ee.decode(s.subarray(0,4))=="YSFC"?(b+=80,v=1):b++},()=>{if(rr(s.subarray(0,4),h))C.forEach((f,i,c)=>{let o=et(e.subarray(f.start+4,f.start+8));f.length=o}),v=2;else{let f=Ee.decode(s.subarray(0,4)),i=et(s.subarray(4,8));C.push({type:f,start:i}),b+=8}},()=>{let f=C[r],i=e.subarray(f.start,f.start+f.length),c=32;switch(f.type){case"ENVC":{let o=u;for(;o<i.length;){let n=i.subarray(o,o+c),d=Ee.decode(n.subarray(0,10)).trimEnd();d.slice(0,5)=="Init "&&(d=""),d&&(a+=`
063	${(n[17]+13).toString().padStart(3,"0")}	${n[19].toString().padStart(3,"0")}	${d}`),o+=c}break}case"EDVC":{let o=u;for(;o<i.length;){let n=i.subarray(o,o+c),d=Ee.decode(n.subarray(0,10)).trimEnd();d.slice(0,5)=="Init "&&(d=""),d&&(a+=`
063	024	${n[19].toString().padStart(3,"0")}	${d}`),o+=c}break}case"EPVC":{let o=32,n=u;for(;n<i.length;){let d=i.subarray(n,n+o),l=Ee.decode(d.subarray(0,10)).trimEnd();l=="----------"&&(l=""),l&&(a+=`
063	${(d[17]+1).toString().padStart(3,"0")}	${d[19].toString().padStart(3,"0")}	${l}`),n+=o}break}}r++,r>=C.length&&(v=3,k=!1)}][v]||(()=>{k=!1}))()}return a});tt.set("pcg",async function(E){let e=new Uint8Array(await E.arrayBuffer()),a="MSB	LSB	PRG	NME",h=100,u=0,b=0,v=!0,k=[],C=0;for(;v;){let r=e.subarray(h);([()=>{v=Ee.decode(r.subarray(0,4))=="INI2",b=r[15],h+=16,u=1},()=>{let s=Ee.decode(r.subarray(0,4)),f=r[5],i=r[7],c=r[11],o=et(r.subarray(12,16)),n=et(r.subarray(16,20)),d=et(r.subarray(36,40)),l=Ee.decode(r.subarray(44,44+c));k.push({type:s,tipMsb:f,tipLsb:i,nameLen:c,length:o,start:n,entryLen:d,name:l}),h+=64,b--,b<1&&(u=2)},()=>{let s=k[C],f=e.subarray(s.start,s.start+s.length);switch(s.type){case"PRG1":break;case"PBK1":{let i=63,c=(s.tipMsb?6:0)+s.tipLsb;for(let o=0;o<128;o++){let n=o*s.entryLen,d=f.subarray(n,n+s.entryLen),l=Ee.decode(d.subarray(0,24)).trimEnd().replace("InitProg","");l.length&&c>5&&(a+=`
${i.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${o.toString().padStart(3,"0")}	${l}`)}break}case"CBK1":{let i=63,c=(s.tipMsb?3:0)+s.tipLsb+10;for(let o=0;o<128;o++){let n=o*s.entryLen,d=f.subarray(n,n+s.entryLen),l=Ee.decode(d.subarray(0,24)).trimEnd().replace("InitCombi","");l.length&&c>12&&(a+=`
${i.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${o.toString().padStart(3,"0")}	${l}`)}break}}C++,C>=k.length&&(u=3,v=!1)}][u]||(()=>{v=!1}))()}return a});var rt=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"].concat(new Array(4),["white room","tunnel","canyon","basement","karaoke"],new Array(43),["pass through","chorus","celeste","flanger","symphonic","rotary speaker","tremelo","auto pan","phaser","distortion","overdrive","amplifier","3-band EQ","2-band EQ","auto wah"],new Array(1),["pitch change","harmonic","touch wah","compressor","noise gate","voice channel","2-way rotary speaker","ensemble detune","ambience"],new Array(4),["talking mod","Lo-Fi","dist + delay","comp + dist + delay","wah + dist + delay","V dist","dual rotor speaker"]),at=["melodic","drums","drum set 1","drum set 2","drum set 3","drum set 4","drum set 5","drum set 6","drum set 7","drum set 8"],ar=[17.1,18.6,20.2,21.8,23.3,24.9,26.5,28,29.6,31.2,32.8,34.3,35.9,37.5,39,40.6,42.2,43.7,45.3,46.9,48.4,50],We=[20,22,25,28,32,36,40,45,50,56,63,70,80,90,100,110,125,140,160,180,200,225,250,280,315,355,400,450,500,560,630,700,800,900,1e3,1100,1200,1400,1600,1800,2e3,2200,2500,2800,3200,3600,4e3,4500,5e3,5600,6300,7e3,8e3,9e3,1e4,11e3,12e3,14e3,16e3,18e3,2e4],Dt=[0,.04,.08,.13,.17,.21,.25,.29,.34,.38,.42,.46,.51,.55,.59,.63,.67,.72,.76,.8,.84,.88,.93,.97,1.01,1.05,1.09,1.14,1.18,1.22,1.26,1.3,1.35,1.39,1.43,1.47,1.51,1.56,1.6,1.64,1.68,1.72,1.77,1.81,1.85,1.89,1.94,1.98,2.02,2.06,2.1,2.15,2.19,2.23,2.27,2.31,2.36,2.4,2.44,2.48,2.52,2.57,2.61,2.65,2.69,2.78,2.86,2.94,3.03,3.11,3.2,3.28,3.37,3.45,3.53,3.62,3.7,3.87,4.04,4.21,4,37,4.54,4.71,4.88,5.05,5.22,5.38,5.55,5.72,6.06,6.39,6.73,7.07,7.4,7.74,8.08,8.41,8.75,9.08,9.42,9.76,10.1,10.8,11.4,12.1,12.8,13.5,14.1,14.8,15.5,16.2,16.8,17.5,18.2,19.5,20.9,22.2,23.6,24.9,26.2,27.6,28.9,30.3,31.6,33,34.3,37,39.7],Ot=function(E){let e=.1,a=-.3;return E>66?(e=5,a=315):E>56?(e=1,a=47):E>46&&(e=.5,a=18.5),e*E-a},At=function(E){return E>105?ar[E-106]:E>100?E*1.1-100:E/10},Lt=",a,i,u,e,o,ka,ki,ku,ke,ko,ky,kw,sa,si,su,se,so,sh,ta,ti,tu,te,to,t,ch,t,s,na,ni,nu,ne,no,ny,nn,ha,hi,hu,he,ho,hy,fa,fi,fu,fe,fo,ma,mi,mu,me,mo,my,mm,ya,yu,ye,yo,ra,ri,ru,re,ro,ry,wa,wi,we,wo,ga,gi,gu,ge,go,gy,gw,za,zi,zu,ze,zo,ja,ji,ju,je,jo,jy,da,di,du,de,do,dy,ba,bi,bu,be,bo,by,va,vi,vu,ve,vo,pa,pi,pu,pe,po,py,nga,ngi,ngu,nge,ngo,ngy,ng,hha,hhi,hhu,hhe,hho,hhy,hhw,*,_,,,~,.".split(","),Et={};`hi*,
ka,か
ki,き
ku,く
ke,け
ko,こ
ky,き!
kw,くl
tsu,つ
ts,つl
sa,さ
si,すぃ
su,す
se,せ
so,そ
shi,し
sh,し!
ta,た
ti,てぃ
tu,とぅ
te,て
to,と
tchy,ち!
tchi,ち
na,な
ni,に
nu,ぬ
ne,ね
no,の
ny,に!
nn,ん
ha,は
hi,ひ
hu,ほぅ
he,へ
ho,ほ
hy,ひ!
fa,ふぁ
fi,ふぃ
fu,ふ
fe,ふぇ
fo,ふぉ
ma,ま
mi,み
mu,む
me,め
mo,も
my,み!
mm,ㇺ
ra,ら
ri,り
ru,る
re,れ
ro,ろ
ry,り!
wa,わ
wi,うぃ
we,うぇ
wo,を
nga,か゚
ngi,き゚
ngu,く゚
nge,け゚
ngo,こ゚
ngy,き゚!
ng,ン
ga,が
gi,ぎ
gu,ぐ
ge,げ
go,ご
gy,ぎ!
gw,ぐl
za,ざ
zi,ずぃ
zu,ず
ze,ぜ
zo,ぞ
ja,じゃ
ji,じ
ju,じゅ
je,じぇ
jo,じょ
jy,じ!
da,だ
di,でぃ
du,どぅ
de,で
do,ど
dy,で!
ba,ば
bi,び
bu,ぶ
be,べ
bo,ぼ
by,び!
va,ゔぁ
vi,ゔぃ
vu,ゔ
ve,ゔぇ
vo,ゔぉ
pa,ぱ
pi,ぴ
pu,ぷ
pe,ペ
po,ぽ
py,ぴ!
!ya,ゃ
!yu,ゅ
!ye,ぇ
!yo,ょ
ya,や
yu,ゆ
ye,いぇ
yo,よ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
la,ぁ
li,ぃ
lu,ぅ
le,ぇ
lo,ぉ
a,あ
i,い
u,う
e,え
o,お
*,っ
~,
^,
_,`.split(`
`).forEach(E=>{let e=E.split(",");Et[e[0]]=e[1]});var Ut=function(E){let e=E;E[0]=="*"&&(e=e.slice(1)),["aa","ii","uu","ee","oo"].forEach(h=>{for(;e.indexOf(h)>-1;)e=e.replace(h,h[0])});for(let h in Et)e=e.replaceAll(h,Et[h]);e.indexOf("ん")==0&&e.length>1&&(e=e.slice(1));let a=e.indexOf("!");return a>-1&&e.length>1&&(e=e.slice(a+1)),e},Bt=function(E){return E?E<96?`cc${E}`:["aftertouch","velocity","pitch bend"][E-96]:"off"};var yt=["room 1","room 2","room 3","hall 1","hall 2","plate","delay","panning delay"],Ht=["chorus 1","chorus 2","chorus 3","chorus 4","feedback","flanger","short delay","short delay feedback"],Nt=["delay 1","delay 2","delay 3","delay 4","pan delay 1","pan delay 2","pan delay 3","pan delay 4","delay to reverb","pan repeat"];var sr={0:"thru",256:"stereo EQ",257:"spectrum",258:"enhancer",259:"humanizer",272:"overdrive",273:"distortion",288:"phaser",289:"auto wah",290:"rotary",291:"stereo flanger",292:"step flanger",293:"tremelo",294:"auto pan",304:"compressor",305:"limiter",320:"hexa chorus",321:"tremelo chorus",322:"stereo chorus",323:"space D",324:"3D chorus",336:"stereo delay",337:"modulated delay",338:"3-tap delay",339:"4-tap delay",340:"tremelo control delay",341:"reverb",342:"gate reverb",343:"3D delay",352:"2-pitch shifter",353:"feedback pitch shifter",368:"3D auto",369:"3D manual",370:"Lo-Fi 1",371:"Lo-Fi 2",512:"overdrive - chorus",513:"overdrive - flanger",514:"overdrive - delay",515:"distortion - chorus",516:"distortion - flanger",517:"distortion - delay",518:"enhancer - chorus",519:"enhancer - flanger",520:"enhancer - delay",521:"chorus - delay",522:"flanger - delay",523:"chorus - flanger",524:"rotary multi",1024:"guitar multi 1",1025:"guitar multi 2",1026:"guitar multi 3",1027:"clean guitar multi 1",1028:"clean guitar multi 2",1029:"bass multi",1030:"rhodes multi",1280:"keyboard multi",4352:"chorus / delay",4353:"flanger / delay",4354:"chorus / flanger",4355:"overdrive / distortion",4356:"overdrive / rotary",4357:"overdrive / phaser",4358:"overdrive / auto wah",4359:"phaser / rotary",4360:"phaser / auto wah"},ir={66307:["drive"],66309:["vowel",E=>"aiueo"[E]],94723:["pre-filter"],94724:["Lo-Fi type"],94725:["post-filter"],94979:["Lo-Fi type"],94980:["fill type",E=>["off","LPF","HPF"][E]],94984:["noise type",E=>["white","pink"][E]],94987:["disc type",E=>["LP","SP","EP","RND"]],94990:["hum type",E=>`${E+5}0Hz`],94993:["M/S",E=>["mono","stereo"][E]]},mt=function(E){return sr[(E[0]-32<<8)+E[1]]||`0x${E[0].toString(16).padStart(2,"0")}${E[1].toString(16).padStart(2,"0")}`},It=function(E,e,a){let h=(E[0]-32<<16)+(E[1]<<8)+e,u=ir[h]||{},b=u[0];if(b!=null&&b.length)return b+=`: ${(u[1]||function(){})(a)||a}`,b},vt=[68,48,95,78,41,3,110,122,0];var te=function(E=64){return Math.round(2e3*Math.log10(E/64))/100};var Me=function(E){let e=0;return E.forEach(a=>{e+=a,e=e&127}),~e+1&127},fe=function(E,e){let a=0,h=0;for(let u=0;u<E.length;u++){let b=u%8-1,v=(h>>b&1)<<7,k=E[u];k+=v,u%8!=0?(e(k,a,E),a++):h=E[u]}};var st=function(E){let e=Math.floor(E*14.2);return e<128?e:0},O=function(){return!!self.Bun||self.debugMode||!1};var Q=["?","gm","gs","sc","xg","g2","mt32","doc","qy10","qy20","ns5r","x5d","05rw","k11","sg","sd","krs","s90es","motif","trin"],cr={gm2:"g2","mt-32":"mt32","c/m":"mt32",ag10:"05rw","ag-10":"05rw","05r/w":"05rw",x5:"05rw",x5dr:"x5d",gmega:"k11","kross 2":"krs","motif es":"motif","s90 es":"s90es",trinity:"trin","tr-rack":"trin"},nr=["melodic","drum","menu"],Gt={"?":[0,0,120,0,0],gm:[0,0,127,0,0],gs:[0,0,120,0,0],sc:[0,0,120,0,0],xg:[0,0,127,0,0],g2:[0,0,120,0,0],mt32:[0,127,127,0,127],doc:[57,112,127,57,112],qy10:[57,113,127,57,113],qy20:[57,114,127,57,114],ns5r:[0,0,61,0,0],x5d:[82,0,62,56,0],"05rw":[81,0,62,56,0],k11:[0,0,122,0,0],sg:[0,0,122,0,0],sd:[97,0,105,0,0],krs:[121,0,120,0,0],s90es:[0,0,127,0,0],motif:[0,0,127,0,0],trin:[0,0,127,0,0]},_t=[9,25,41,57,73,89,105,121],or=[0,3,81,84,88],Xt={8:"Off",9:"On",10:"Note aftertouch",11:"cc",12:"pc",13:"Channel aftertouch",14:"Pitch"},Vt={0:0,1:1,2:3,5:4},Ft={0:0,1:1,2:2,5:3},Kt=[[0,24],[0,127],[0,127],[40,88],[0,127],[0,127]],wt=[36,37,48,49,52,53],pt=[20,21,22,23,24,25,26,28,29,30,31,36,37,48,49,52,53,64,65],zt={26:127,29:0,30:0,31:0,52:12,53:54},ct=[0,1,2,4,5,6,7,8,10,11,32,38,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84,91,92,93,94,95,98,99,100,101,128,12,13,16,17,18,19,14,15,20,21,26,28,22,80,81,82,83,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157],lr=[2,12,13,14,15,16,17,18,19,20,21,80,81,83,136,130,131,132,133,134,135,137,138,139,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157],dr=[33,102,99,32,100,8,9,10],Wt=[0,16,25,32,40,64,24,48],w={};Q.forEach((E,e)=>{w[E]=e});var y={length:ct.length};ct.forEach((E,e)=>{y[E]=e});var he={length:pt.length};pt.forEach((E,e)=>{he[E]=e});var fr={};nr.forEach((E,e)=>{fr[E]=e});var hr=function(E){let e=[],a=0;return E==null||E.forEach(function(h,u){h==247?e.push(E.subarray(a,u)):h==240&&(a=u+1)}),e.length||e.push(E.subarray(0)),O()&&console.debug(e),e};var $t=8,p={port:$t,ch:$t<<4,chShift:Math.ceil(Math.log2($t))+4,cc:ct.length,nn:128,pl:512,tr:256,cmt:14,rpn:6,rpnt:4,nrpn:wt.length,ace:8,drm:8,dpn:pt.length,dnc:128,ext:3,efx:7,cvn:12,redir:32,vxPrim:3,invalidCh:255},it={bank0:128},kt=new Uint16Array(p.ch),ur=new Uint16Array(p.ch),pr=new Uint16Array(p.ch),br=new Uint16Array(p.ch),gr=new Uint16Array(p.ch),qt=new Array(p.drm);for(let E=0;E<p.ch;E++)kt[E]=E*p.cc,ur[E]=E*p.rpn,pr[E]=E*p.nrpn,br[E]=E*p.ace,gr[E]=E*p.ext;for(let E=0;E<p.drm;E++){qt[E]=new Uint16Array(p.dpn);let e=E*p.dpn*p.dnc;for(let a=0;a<p.dpn;a++)qt[E][a]=e+a*p.dnc}var B,Y,ue,xe,ne,ke,Yt,oe,_,R,g,J,A,X,re,V,z,Se,ye,Ue,ae,D,L,qe,j,pe,se,Qe,Be,I,Pe,be,nt,Re,ge,Ye,De,F,U,me,ot,H,He,Je,Ze,Oe,Ae,lt,je,ve,N,ht,dt,Ne,ie,Ce,Le,Z,Ie,G,ft,ut,Ge,_e,ce,le,$e,Xe,Ve,Fe,Qt,ra=(Qt=class extends Tt{constructor(){super();S(this,ne);P(this,"NOTE_IDLE",0);P(this,"NOTE_ATTACK",1);P(this,"NOTE_DECAY",2);P(this,"NOTE_SUSTAIN",3);P(this,"NOTE_HELD",4);P(this,"NOTE_RELEASE",5);P(this,"NOTE_SOSTENUTO_ATTACK",8);P(this,"NOTE_SOSTENUTO_DECAY",9);P(this,"NOTE_SOSTENUTO_SUSTAIN",10);P(this,"NOTE_SOSTENUTO_HELD",11);P(this,"CH_MELODIC",0);P(this,"CH_DRUMS",1);P(this,"CH_DRUM1",2);P(this,"CH_DRUM2",3);P(this,"CH_DRUM3",4);P(this,"CH_DRUM4",5);P(this,"CH_DRUM5",6);P(this,"CH_DRUM6",7);P(this,"CH_DRUM7",8);P(this,"CH_DRUM8",9);P(this,"DUMP_ALL",0);P(this,"DUMP_ONCE",1);P(this,"DUMP_MODE",2);P(this,"EXT_NONE",0);P(this,"EXT_VL",1);P(this,"EXT_DX",3);P(this,"VLBC_BRTHEXPR",1);P(this,"VLBC_VELOINIT",2);P(this,"VLBC_VELOALL",3);P(this,"CH_INACTIVE",0);P(this,"CH_ACTIVE",1);P(this,"CH_DISABLED",2);S(this,B,0);S(this,Y,0);S(this,ue,0);S(this,xe,new Array(11));S(this,oe,new Uint8Array(p.ch));S(this,_,new Uint8Array(p.ch));S(this,R,new Uint8Array(p.ch));S(this,g,new Uint8Array(p.ch*p.cc));S(this,J,new Uint8Array(p.ch*p.ace));S(this,A,new Uint8Array(p.ch*p.vxPrim));S(this,X,new Uint8Array(p.ch*p.nn));S(this,re,new Uint8Array(p.ch));S(this,V,new Uint16Array(p.pl));S(this,z,new Uint8Array(p.pl));S(this,Se,new Int16Array(p.ch));S(this,ye,new Uint8Array(p.ch));S(this,Ue,new Uint8Array(p.ch));S(this,ae,new Uint8Array(p.ch*p.ext));S(this,D,new Uint8Array(p.ch*p.rpn));S(this,L,new Uint8Array(p.ch*p.rpnt));S(this,qe,new Int8Array(p.ch*wt.length));S(this,j,new Uint8Array(p.drm*p.dpn*p.dnc));S(this,pe,new Uint8Array(p.drm*2));S(this,se,new Uint8Array(p.efx*3));S(this,Qe,new Uint8Array(p.ch));S(this,Be,new Uint8Array(p.ch*p.redir));S(this,I,new Uint8Array(p.port));S(this,Pe,new Uint8Array(p.ch));S(this,be,new Uint8Array(p.ch));S(this,nt,new Uint8Array(p.ch*p.cvn));S(this,Re,new Uint8Array(128));S(this,ge,new Uint8Array(p.cmt*8));S(this,Ye,new Uint8Array(1024));S(this,De,new Uint8Array(p.cmt*64));S(this,F,{});P(this,"modelEx",{sc:{showBar:!0,invBar:!1,invDisp:!1,peakHold:1}});S(this,U,void 0);S(this,me,void 0);S(this,ot,void 0);S(this,H,100);S(this,He,0);S(this,Je,500);S(this,Ze,0);S(this,Oe,"");S(this,Ae,0);S(this,lt,0);S(this,je,0);S(this,ve,!0);S(this,N,!1);S(this,ht,1);S(this,dt,void 0);S(this,Ne,new Array(p.ch));S(this,ie,[]);S(this,Ce,new Uint8Array(p.ch));S(this,Le,new Uint8Array(p.tr));P(this,"baseBank",new gt("gm2","ns5r","xg","gs","sd","gmega","plg-vl","plg-pf","plg-dx","plg-an","plg-dr","plg-sg","kross","s90es"));P(this,"userBank",new gt("gm"));P(this,"initOnReset",!1);P(this,"aiEfxName","");S(this,Z,[]);S(this,Ie,void 0);S(this,G,{nOff:(e,a)=>{let h=e*128+a,u=t(this,V).lastIndexOf(h);if(u>-1)if(t(this,g)[p.cc*e+y[64]]>63)t(this,z)[u]=this.NOTE_HELD,this.dispatchEvent("note",{part:e,note:a,velo:t(this,X)[h],state:this.NOTE_HELD});else if(t(this,g)[p.cc*e+y[66]]>63&&t(this,z)[u]==this.NOTE_SOSTENUTO_SUSTAIN)t(this,z)[u]=this.NOTE_SOSTENUTO_HELD,this.dispatchEvent("note",{part:e,note:a,velo:t(this,X)[h],state:this.NOTE_SOSTENUTO_HELD});else{t(this,V)[u]=0,t(this,X)[h]=0,t(this,z)[u]=this.NOTE_IDLE;let b=this.getExt(e)[1];(b==this.VLBC_VELOINIT||b==this.VLBC_VELOALL)&&(t(this,g)[p.cc*e+y[129]]=0),this.dispatchEvent("note",{part:e,note:a,velo:0,state:this.NOTE_IDLE})}},nOn:(e,a,h)=>{let u=e*128+a,b=0;for(t(this,re)[e]&&t(this,G).ano(e);t(this,z)[b]>0&&t(this,V)[b]!=u;)b++;if(b<p.pl){t(this,V)[b]=u,t(this,X)[u]=h,t(this,z)[b]=this.NOTE_SUSTAIN,t(this,ye)[e]<h&&(t(this,ye)[e]=h);let v=this.getExt(e)[1];(v==this.VLBC_VELOINIT||v==this.VLBC_VELOALL)&&(t(this,g)[p.cc*e+y[129]]=h),this.dispatchEvent("note",{part:e,note:a,velo:h,state:this.NOTE_SUSTAIN})}else console.error("Polyphony exceeded.")},nAt:(e,a,h)=>{},cAt:(e,a)=>{},hoOf:e=>{t(this,z).forEach((a,h)=>{if(a==this.NOTE_HELD){let u=t(this,V)[h],b=u>>7;e==b&&(t(this,z)[h]=this.NOTE_IDLE,t(this,V)[h]=0,t(this,X)[u]=0,this.dispatchEvent("note",{part:e,note:u&127,velo:0,state:this.NOTE_IDLE}))}})},soOn:e=>{t(this,z).forEach((a,h)=>{let u;switch(a){case this.NOTE_ATTACK:{u=this.NOTE_SOSTENUTO_ATTACK;break}case this.NOTE_DECAY:{u=this.NOTE_SOSTENUTO_DECAY;break}case this.NOTE_SUSTAIN:{u=this.NOTE_SOSTENUTO_SUSTAIN;break}}if(u){t(this,z)[h]=u;let b=t(this,V)[h];this.dispatchEvent("note",{part:e,note:b&127,velo:t(this,X)[b],state:u})}})},soOf:e=>{t(this,z).forEach((a,h)=>{if(a==this.NOTE_SOSTENUTO_HELD){let u=t(this,V)[h],b=u>>7;e==b&&(t(this,z)[h]=this.NOTE_IDLE,t(this,V)[h]=0,t(this,X)[u]=0,this.dispatchEvent("note",{part:e,note:u&127,velo:0,state:this.NOTE_IDLE}))}})},ano:e=>{t(this,V).forEach((a,h,u)=>{let b=a>>7,v=a&127;a==0&&t(this,X)[0]==0||b==e&&t(this,G).nOff(b,v)})}});S(this,ft,{8:function(e){let a=e.channel,h=e.data[0];t(this,G).nOff(a,h)},9:function(e){let a=e.channel,h=this;if(h.getChModeId(a)==w.xg&&t(h,R)[a]>1){let v=h.getChDrumFirstWrite(a);v[0]&&v[1]!=p.invalidCh&&!t(h,oe)[a]&&(h.copyChSetup(v[1],a),h.dispatchEvent("voice",{part:a}),console.debug(`Part CH${a+1} copied from CH${v[1]}.`))}h.setChActive(a,1);let u=e.data[0],b=e.data[1];b>0?t(h,G).nOn(a,u,b):t(h,G).nOff(a,u)},10:function(e){let a=e.channel,h=a*128+e.data[0];t(this,V).indexOf(h)>-1&&(t(this,X)[h]=data[1],this.getExt(a)[1]==this.VLBC_VELOALL&&(t(this,g)[p.cc*a+y[129]]=data[1]),this.dispatchEvent("note",{part:a,note:e.data[0],velo:e.data[1],state:this.NOTE_SUSTAIN}))},11:function(e){let a=e.channel,h=this,u=t(this,Ne)[a],b=u[e.data[0]];b&&(e.data[0]=b),[0,32].indexOf(e.data[0])>-1&&(()=>{switch(t(this,B)){case w.s90es:case w.motif:{if(e.data[0]==0){[0,63].indexOf(e.data[1])>-1&&this.setChActive(a,1);break}e.data[1]&&this.setChActive(a,1);break}default:{this.setChActive(a,1);break}}})();let v=a*p.cc,k=a*p.ext,C=this.getChModeId(a);switch(e.data[0]){case 96:return;case 97:return;case 120:return;case 121:{t(this,G).ano(a),t(this,Se)[a]=0,t(this,g)[v+y[1]]=0,t(this,g)[v+y[5]]=0,t(this,g)[v+y[64]]=0,t(this,g)[v+y[65]]=0,t(this,g)[v+y[66]]=0,t(this,g)[v+y[67]]=0,t(this,g)[v+y[11]]=127,t(this,g)[v+y[101]]=127,t(this,g)[v+y[100]]=127,t(this,g)[v+y[99]]=127,t(this,g)[v+y[98]]=127;return}case 123:{t(this,G).ano(a);return}case 124:{t(this,G).ano(a);return}case 125:{t(this,G).ano(a);return}case 126:{t(this,re)[a]=1,t(this,G).ano(a);return}case 127:{t(this,re)[a]=0,t(this,G).ano(a);return}}if(y[e.data[0]]==null)console.warn(`cc${e.data[0]} is not accepted.`);else{switch(lr.indexOf(e.data[0])>-1&&this.allocateAce(a,e.data[0]),e.data[0]){case 0:{switch(O()&&console.debug(`${Q[t(this,B)]}, CH${a+1}: ${e.data[1]}`),t(this,B)==0?e.data[1]<48?(t(this,R)[a]>0&&(e.data[1]=t(this,g)[v],e.data[1]=120,console.debug(`Forced channel ${a+1} to stay drums.`)),e.data[1]>0&&(console.debug(`Roland GS detected with MSB: ${e.data[1]}`),this.switchMode("gs"))):e.data[1]==56?this.switchMode(t(this,U).x5==82?"x5d":"05rw"):e.data[1]==62?this.switchMode(t(this,U).x5==82?"x5d":"05rw"):e.data[1]==63?this.switchMode(Q[t(this,U).ds]):(e.data[1]==64||e.data[1]==127)&&this.switchMode("xg"):t(this,B)==w.gs||t(this,B)==w.sc?e.data[1]<56&&t(this,R)[a]>0&&(e.data[1]=t(this,g)[v],e.data[1]=120,console.debug(`Forced channel ${a+1} to stay drums.`)):t(this,B)==w.gm&&(e.data[1]<48?t(this,R)[a]>0&&(e.data[1]=120,this.switchMode("gs",!0),console.debug(`Forced channel ${a+1} to stay drums.`)):(e.data[1]==64||e.data[1]==127)&&this.switchMode("xg",!0)),t(this,B)){case w.xg:{[79,95,126,127].indexOf(e.data[1])>-1?t(this,R)[a]==0&&(this.setChType(a,this.CH_DRUM2),console.debug(`CH${a+1} set to drums by MSB.`)):t(this,R)[a]>0&&(this.setChType(a,this.CH_MELODIC),console.debug(`CH${a+1} set to melodic by MSB.`)),[33,81,97].indexOf(e.data[1])>-1?t(this,ae)[k]=this.EXT_VL:[35,67,83,99].indexOf(e.data[1])>-1?t(this,ae)[k]=this.EXT_DX:t(this,ae)[k]=this.EXT_NONE;break}case w["05rw"]:case w.x5d:case w.ns5r:{[61,62,126,127].indexOf(e.data[1])>-1?t(this,R)[a]==this.CH_MELODIC&&(this.setChType(a,this.CH_DRUM2),console.debug(`CH${a+1} set to drums by MSB.`)):[80,81,82,83].indexOf(e.data[1])>-1||t(this,R)[a]!=this.CH_MELODIC&&(this.setChType(a,this.CH_MELODIC),console.debug(`CH${a+1} set to melodic by MSB.`));break}case w.sd:{[104,105,106,107].indexOf(e.data[1])>-1?t(this,R)[a]==0&&(this.setChType(a,this.CH_DRUM2),console.debug(`CH${a+1} set to drums by MSB.`)):t(this,R)[a]>0&&(this.setChType(a,this.CH_MELODIC),console.debug(`CH${a+1} set to melodic by MSB.`));break}case w.g2:{e.data[1]==120?t(this,R)[a]==0&&(this.setChType(a,this.CH_DRUMS),console.debug(`CH${a+1} set to drums by MSB.`)):t(this,R)[a]>0&&(this.setChType(a,this.CH_MELODIC),console.debug(`CH${a+1} set to melodic by MSB.`));break}}break}case 2:{this.getExt(a)[1]==this.VLBC_BRTHEXPR&&(t(this,g)[v+y[129]]=e.data[1]);break}case 6:{if(t(this,Ue)[a]){[w.xg,w.gs,w.sc,w.ns5r].indexOf(t(this,B))<0&&console.warn(`NRPN commits are not available under "${Q[t(this,B)]}" mode, even when they are supported in Octavia.`);let r=t(this,g)[v+y[99]],s=t(this,g)[v+y[98]];if(r==1){let f=dr.indexOf(s);if(f>-1)t(this,g)[v+y[71+f]]=e.data[1],O()&&console.debug(`Redirected NRPN 1 ${s} to cc${71+f}.`),this.dispatchEvent("cc",{part:a,cc:71+f,data:e.data[1]});else{let i=wt.indexOf(s);i>-1?t(this,qe)[a*10+i]=e.data[1]-64:console.warn(`NRPN 0x01${s.toString(16).padStart(2,"0")} is not supported.`),O()&&console.debug(`CH${a+1} voice NRPN ${s} commit`)}}else{if(pt.indexOf(r)<0){let i=`NRPN 0x${r.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")} `;r==127?console.warn(`${i}is not necessary. Consider removing it.`):console.warn(`${i}is not supported.`)}else{let i=t(this,R)[a]-2;i<0?console.warn(`CH${a+1} cannot accept drum NRPN as type ${at[t(this,R)[a]]}.`):t(this,j)[(i*p.dpn+he[r])*p.dnc+s]=e.data[1]}O()&&console.debug(`CH${a+1} (${at[t(this,R)[a]]}) drum NRPN ${r} commit`)}}else{let r=Vt[t(this,g)[v+y[100]]],s=Ft[t(this,g)[v+y[100]]];if(t(this,g)[v+y[101]]==0&&r!=null)switch(O()&&console.debug(`CH${a+1} RPN 0 ${t(this,g)[v+y[100]]} commit: ${e.data[1]}`),e.data[1]=Math.min(Math.max(e.data[1],Kt[r][0]),Kt[r][1]),t(this,D)[a*p.rpn+r]=e.data[1],t(this,L)[a*p.rpnt+s]=1,C){case w.xg:case w.gs:case w.sc:case w.mt32:case w.s90es:case w.motif:{switch(t(this,g)[v+y[100]]){case 1:case 2:{this.dispatchEvent("pitch",{part:a,pitch:this.getPitchShift(a)});break}}break}default:this.dispatchEvent("pitch",{part:a,pitch:this.getPitchShift(a)})}}break}case 32:{switch(O()&&console.debug(`${Q[t(this,B)]}, CH${a+1} LSB: ${e.data[1]}`),t(this,B)){case w.s90es:case w.motif:{this.setChType(a,[32,40].indexOf(e.data[1])>-1?this.CH_DRUMS:this.CH_MELODIC,t(this,B),!0);break}}this.getExt(a)[0]==this.EXT_DX;break}case 38:{if(!t(this,Ue)[a]){let r=Vt[t(this,g)[v+100]],s=Ft[t(this,g)[v+100]];t(this,g)[v+101]==0&&r!=null&&(t(this,D)[a*p.rpn+r+1]=e.data[1],t(this,L)[a*p.rpnt+s]=1)}break}case 64:{e.data[1]<64&&t(this,G).hoOf(a);break}case 66:{e.data[1]>>6?t(this,G).soOn(a):t(this,G).soOf(a);break}case 98:case 99:{t(this,Ue)[a]=1;break}case 100:case 101:{t(this,Ue)[a]=0;break}}t(this,g)[v+y[e.data[0]]]=e.data[1],this.dispatchEvent("cc",{part:a,cc:e.data[0],data:e.data[1]})}h.getChModeId(a)==w.xg&&t(h,R)[a]&&h.setDrumFirstWrite(a)},12:function(e){let a=e.channel,h=this;switch(t(h,B)){case w.s90es:case w.motif:{e.data&&h.setChActive(a,1);break}default:h.setChActive(a,1)}if(h.getExt(a)[0]==h.EXT_DX){let u=p.cc*a}t(h,A)[a]=e.data,t(h,be)[a]=0,h.pushChPrimitives(a),O()&&console.debug(`T:${e.track} C:${a} P:${e.data}`),h.dispatchEvent("voice",{part:a}),h.getChModeId(a)==w.xg&&t(h,R)[a]&&h.setDrumFirstWrite(a)},13:function(e){let a=this,h=e.channel;t(this,V).forEach(function(u){let b=u>>7;h==b&&(t(a,X)[u]=e.data,a.dispatchEvent("note",{part:h,note:u&127,velo:e.data,state:a.NOTE_SUSTAIN}))})},14:function(e){let a=e.channel;t(this,Se)[a]=e.data[1]*128+e.data[0]-8192,this.dispatchEvent("pitch",{part:a,pitch:this.getPitchShift(a)})},15:function(e){hr(e.data).forEach(a=>{let h=a[0],u=a[1];(t(this,ut)[h]||function(){console.debug(`Unknown manufacturer ${h}.`)})(u,a.subarray(2),e.track)})},248:function(e){},250:function(e){},251:function(e){},252:function(e){},254:function(e){},255:function(e){(t(this,Z)[e.meta]||function(h,u,b){}).call(this,e.data,e.track,e.meta),e.meta!=32&&x(this,He,0);let a=or.indexOf(e.meta)>-1;if(O()&&console.debug(e),a)return e.reply="meta",e}});S(this,ut,{64:(e,a,h)=>{t(this,Xe).run(a,h,e)},65:(e,a,h)=>{if(a[0]<16)if(a[1]==72){let u=a[a.length-1],b=Me(a.subarray(3,a.length-1));u==b?t(this,le).run(a.subarray(0,a.length-1),h,e):console.warn(`Bad SD checksum ${u} - should be ${b}.`)}else t(this,le).run(a,h,e);else{let u=a[a.length-1],b=Me(a.subarray(2,a.length-1));u==b?t(this,le).run(a.subarray(0,a.length-1),h,e):console.warn(`Bad GS checksum ${u} - should be ${b}.`)}},66:(e,a,h)=>{t(this,$e).run(a,h,e)},67:(e,a,h)=>{t(this,ce).run(a,h,e)},68:(e,a,h)=>{t(this,Fe).run(a,h,e)},71:(e,a,h)=>{t(this,Ve).run(a,h,e)},126:(e,a,h)=>{t(this,Ge).run(a,h,e)},127:(e,a,h)=>{this.switchMode("gm"),t(this,_e).run(a,h,e)}});S(this,Ge,void 0);S(this,_e,void 0);S(this,ce,void 0);S(this,le,void 0);S(this,$e,void 0);S(this,Xe,void 0);S(this,Ve,void 0);S(this,Fe,void 0);let e=this;x(e,ne,new Uint8Array(256),Yt),t(e,xe)[10]=new Uint8Array(512),x(e,Ie,new de),x(e,U,{x5:82,ds:w.krs,smotif:w.s90es,gs:4,sc:3}),x(e,me,{dumpLimit:e.DUMP_MODE}),x(e,ot,new Proxy(t(e,me),{set:()=>{}}));for(let r in Gt){let s=w[r];s==null?console.debug(`SubDB build error: "${r}" does not exist`):t(e,F)[s]=new Uint8Array(Gt[r])}e.userBank.strictMode=!0,e.userBank.load(`MSB	PRG	LSB	NME
062	000	000	
122	000	000	
122	001	000	
122	002	000	
122	003	000	
122	004	000	
122	005	000	
122	006	000	`),e.addEventListener("metacommit",function(r){var f,i;let{data:s}=r;((f=t(e,ie)[0])==null?void 0:f.type)==s.type&&((i=t(e,ie)[0])!=null&&i.amend)?(t(e,ie)[0].amend=s.amend,t(e,ie)[0].data+=s.data):t(e,ie).unshift(s)}),t(e,Z)[1]=function(r){var s,f,i,c,o;switch(r=r.replaceAll(`\r
`,`
`).replaceAll("\r",`
`),r.slice(0,2)){case"@I":{x(this,N,!0),this.dispatchEvent("metacommit",{type:"Kar.Info",data:(s=r.slice(2))==null?void 0:s.trimLeft()});break}case"@K":{x(this,N,!0),this.dispatchEvent("metacommit",{type:"Kar.Mode",data:(f=r.slice(2))==null?void 0:f.trimLeft()}),console.debug(`Karaoke mode active: ${r.slice(2)}`);break}case"@L":{x(this,N,!0),this.dispatchEvent("metacommit",{type:"Kar.Lang",data:(i=r.slice(2))==null?void 0:i.trimLeft()});break}case"@T":{x(this,N,!0),this.dispatchEvent("metacommit",{type:"KarTitle",data:(c=r.slice(2))==null?void 0:c.trimLeft()});break}case"@V":{x(this,N,!0),this.dispatchEvent("metacommit",{type:"Kar.Ver.",data:(o=r.slice(2))==null?void 0:o.trimLeft()});break}case"XF":{let n=r.slice(2).split(":");switch(n[0]){case"hd":{n.slice(1).forEach((d,l)=>{d.length&&this.dispatchEvent("metacommit",{type:["XfSngDte","XfSngRgn","XfSngCat","XfSongBt","XfSngIns","XfSngVoc","XfSngCmp","XfSngLrc","XfSngArr","XfSngPer","XfSngPrg","XfSngTag"][l],data:d})});break}case"ln":{n.slice(1).forEach((d,l)=>{d.length&&this.dispatchEvent("metacommit",{type:["XfKarLng","XfKarNme","XfKarCmp","XfKarLrc","XfKarArr","XfKarPer","XfKarPrg"][l],data:d})});break}default:this.dispatchEvent("metacommit",{type:"XfUnData",data:r})}break}default:t(this,N)?r[0]=="\\"?(this.dispatchEvent("metacommit",{type:"KarLyric",data:"",amend:!1}),this.dispatchEvent("metacommit",{type:"KarLyric",data:r.slice(1),amend:!0})):r[0]=="/"?(this.dispatchEvent("metacommit",{type:"KarLyric",data:"",mask:!0,amend:!1}),this.dispatchEvent("metacommit",{type:"KarLyric",data:r.slice(1),mask:!0,amend:!0})):this.dispatchEvent("metacommit",{type:"KarLyric",data:r,amend:!0}):r.split(`
`).forEach((n,d)=>{this.dispatchEvent("metacommit",{type:"Cmn.Text",data:n,mask:d!=0})})}},t(e,Z)[2]=function(r){this.dispatchEvent("metacommit",{type:"Copyrite",data:r})},t(e,Z)[3]=function(r,s){s<1&&t(this,He)<1&&this.dispatchEvent("metacommit",{type:"TrkTitle",data:r})},t(e,Z)[4]=function(r,s){this.dispatchEvent("metacommit",{type:"Instrmnt",data:r})},t(e,Z)[5]=function(r){r.trim()==""?this.dispatchEvent("metacommit",{type:"C.Lyrics",data:"",amend:!1}):this.dispatchEvent("metacommit",{type:"C.Lyrics",data:r,amend:!0})},t(e,Z)[6]=function(r){this.dispatchEvent("metacommit",{type:"C.Marker",data:r})},t(e,Z)[7]=function(r){this.dispatchEvent("metacommit",{type:"CuePoint",data:r})},t(e,Z)[32]=function(r){x(this,He,r[0]+1)},t(e,Z)[33]=function(r,s){O()&&console.debug(`Track ${s} requests to get assigned to output ${r}.`),t(e,Le)[s]=r+1},t(e,Z)[81]=function(r,s){x(e,Je,r/1e3)},t(e,Z)[127]=function(r,s){t(e,Ie).run(r,s)},t(e,Ie).default=function(r){console.warn(`Unrecognized sequencer-specific byte sequence: ${r}`)},t(e,Ie).add([67,0,1],function(r,s){O()&&console.debug(`XGworks requests assigning track ${s} to output ${r[0]}.`),t(e,Le)[s]=r[0]+1}),x(e,Ge,new de("universal non-realtime")),x(e,_e,new de("universal realtime")),x(e,ce,new de("Yamaha")),x(e,le,new de("Roland")),x(e,$e,new de("Korg")),x(e,Xe,new de("Kawai")),x(e,Ve,new de("Akai")),x(e,Fe,new de("Casio"));let a=new de("DX7+ Dump"),h=function(r){console.info(`Unrecognized SysEx in "${this.name}" set.
%o`,r)};t(e,Ge).default=h,t(e,_e).default=h,t(e,ce).default=h,t(e,le).default=h,t(e,$e).default=h,t(e,Xe).default=h,t(e,Ve).default=h,t(e,Fe).default=h,a.default=h,t(e,Ge).add([9],(r,s,f)=>{e.switchMode(["gm","?","g2"][r[0]-1],!0),e.setPortMode(e.getTrackPort(s),1,w[["gm","?","g2"][r[0]-1]]),x(e,N,t(e,N)||!1),console.info(`MIDI reset: ${["GM","Init","GM2"][r[0]-1]}`),r[0]==2&&e.init()}),t(e,_e).add([4,1],(r,s,f)=>{e.dispatchEvent("mupromptex"),x(e,H,((r[1]<<7)+r[0])/16383*100),e.dispatchEvent("mastervolume",t(e,H))}).add([4,3],(r,s,f)=>((r[1]<<7)+r[0]-8192)/8192).add([4,4],(r,s,f)=>r[1]-64).add([4,5],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=r[0],c=r[1],o=r[2],n=3,d=n+(i<<1),l=d+c;if(i!=1){console.error(`Unsupported GM2 global parameter set: slotpath length too long (${i})!
`,r);return}let m=0,$=0,T=0;switch(r.subarray(n,d).forEach(M=>{m=m<<7,m|=M}),r.subarray(d,l).forEach((M,W)=>{$|=M<<W*7}),r.subarray(l).forEach((M,W)=>{T|=M<<W*7}),O()&&console.debug(`GM2 global parameter: (${r.subarray(3,d)}; p: ${$}, v: ${T})`),m){case 129:{$==0&&(e.setEffectType(0,52,T),e.dispatchEvent("efxreverb",e.getEffectType(0)));break}case 130:{$==0&&(e.setEffectType(1,52,T|16),e.dispatchEvent("efxchorus",e.getEffectType(1)));break}default:O()&&console.debug("GM2 global paramater slot path unknown.")}}),t(this,ce).add([76,0,0],(r,s,f)=>{switch(r[0]){case 125:{e.initDrums(),console.info(`XG drum setup reset: ${r}`);break}case 126:{e.switchMode("xg",!0),e.setPortMode(e.getTrackPort(s),4,w.xg),x(e,N,!1),console.info("MIDI reset: XG");break}default:{e.dispatchEvent("mupromptex");let i=[0,0,0,0],c=(o,n)=>{i[n]=o};if(r.subarray(1).forEach((o,n)=>{let d=n+r[0];([c,c,c,c,l=>{x(this,H,l*129/16383*100),e.dispatchEvent("mastervolume",t(e,H))},l=>{},l=>{}][d]||(()=>{}))(o,n)}),r[0]<4){let o=0;i.forEach(n=>{o=o<<4,o+=n}),o-=1024}}}}).add([76,2,1],(r,s,f)=>{e.dispatchEvent("mupromptex");let i="XG ";r[0]<32?(i+="reverb ",r.subarray(1).forEach((c,o)=>{([n=>{e.setEffectTypeRaw(0,!1,n),console.info(`${i}main type: ${rt[n]}`),e.dispatchEvent("efxreverb",e.getEffectType(0))},n=>{e.setEffectTypeRaw(0,!0,n),console.debug(`${i}sub type: ${n+1}`),e.dispatchEvent("efxreverb",e.getEffectType(0))},n=>{console.debug(`${i}time: ${Ot(n)}s`)},n=>{console.debug(`${i}diffusion: ${n}`)},n=>{console.debug(`${i}initial delay: ${n}`)},n=>{console.debug(`${i}HPF cutoff: ${We[n]}Hz`)},n=>{console.debug(`${i}LPF cutoff: ${We[n]}Hz`)},n=>{console.debug(`${i}width: ${n}`)},n=>{console.debug(`${i}height: ${n}`)},n=>{console.debug(`${i}depth: ${n}`)},n=>{console.debug(`${i}wall type: ${n}`)},n=>{console.debug(`${i}dry/wet: ${n}`)},n=>{console.debug(`${i}send: ${te(n)}dB`)},n=>{console.debug(`${i}pan: ${n-64}`)},!1,!1,n=>{console.debug(`${i}delay: ${n}`)},n=>{console.debug(`${i}density: ${n}`)},n=>{console.debug(`${i}balance: ${n}`)},n=>{},n=>{console.debug(`${i}feedback: ${n}`)},n=>{}][r[0]+o]||function(){console.warn(`Unknown XG reverb address: ${r[0]}.`)})(c)})):r[0]<64?(i+="chorus ",r.subarray(1).forEach((c,o)=>{([n=>{e.setEffectTypeRaw(1,!1,n),console.info(`${i}main type: ${rt[n]}`),e.dispatchEvent("efxchorus",e.getEffectType(1))},n=>{e.setEffectTypeRaw(1,!0,n),console.debug(`${i}sub type: ${n+1}`),e.dispatchEvent("efxchorus",e.getEffectType(1))},n=>{console.debug(`${i}LFO: ${Dt[n]}Hz`)},n=>{},n=>{console.debug(`${i}feedback: ${n}`)},n=>{console.debug(`${i}delay offset: ${At(n)}ms`)},n=>{},n=>{console.debug(`${i}low: ${We[n]}Hz`)},n=>{console.debug(`${i}low: ${n-64}dB`)},n=>{console.debug(`${i}high: ${We[n]}Hz`)},n=>{console.debug(`${i}high: ${n-64}dB`)},n=>{console.debug(`${i}dry/wet: ${n}`)},n=>{console.debug(`${i}send: ${te(n)}dB`)},n=>{console.debug(`${i}pan: ${n-64}`)},n=>{console.debug(`${i}to reverb: ${te(n)}dB`)},!1,n=>{},n=>{},n=>{},n=>{console.debug(`${i}LFO phase diff: ${(n-64)*3}deg`)},n=>{console.debug(`${i}input mode: ${n?"stereo":"mono"}`)},n=>{}][r[0]-32+o]||function(){console.warn(`Unknown XG chorus address: ${r[0]}.`)})(c)})):r[0]<86?(i+="variation ",r.subarray(1).forEach((c,o)=>{([n=>{e.setEffectTypeRaw(2,!1,n),console.info(`${i}main type: ${rt[n]}`),e.dispatchEvent("efxdelay",e.getEffectType(2))},n=>{e.setEffectTypeRaw(2,!0,n),console.debug(`${i}sub type: ${n+1}`),e.dispatchEvent("efxdelay",e.getEffectType(2))}][r[0]-64+o]||function(){})(c)})):r[0]<97?(i+="variation ",r.subarray(1).forEach((c,o)=>{[n=>{console.debug(`${i}send: ${te(n)}dB`)},n=>{console.debug(`${i}pan: ${n-64}`)},n=>{console.debug(`${i}to reverb: ${te(n)}dB`)},n=>{console.debug(`${i}to chorus: ${te(n)}dB`)},n=>{console.debug(`${i}connection: ${n?"system":"insertion"}`)},n=>{console.debug(`${i}channel: CH${n+1}`)},n=>{console.debug(`${i}mod wheel: ${n-64}`)},n=>{console.debug(`${i}bend wheel: ${n-64}`)},n=>{console.debug(`${i}channel after touch: ${n-64}`)},n=>{console.debug(`${i}AC1: ${n-64}`)},n=>{console.debug(`${i}AC2: ${n-64}`)}][r[0]-86+o](c)})):r[0]>111&&r[0]<118?i+="variation ":console.warn(`Unknown XG variation address: ${r[0]}`)}).add([76,2,64],(r,s,f)=>{r.subarray(1).forEach((i,c)=>{let o=c+r[0];if(o==0)console.debug(`XG EQ preset: ${["flat","jazz","pop","rock","classic"][i]}`);else{let n=o-1>>2,d=o-1&3,l=`XG EQ ${n} ${["gain","freq","Q","shape"][d]}: `;[()=>{console.debug(`${l}${i-64}dB`)},()=>{console.debug(`${l}${i} (raw)`)},()=>{console.debug(`${l}${i/10}`)},()=>{console.debug(`${l}${["shelf","peak"][+!!i]}`)}][d]()}})}).add([76,3],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=r[0],c=r[1],o=`XG Insertion ${r[0]+1} `;r.subarray(2).forEach((n,d)=>{([l=>{e.setEffectTypeRaw(3+i,!1,l),console.info(`${o}main type: ${rt[l]}`),e.dispatchEvent(`efxinsert${i}`,e.getEffectType(3+i))},l=>{e.setEffectTypeRaw(3+i,!0,l),console.debug(`${o}sub type: ${l+1}`),e.dispatchEvent(`efxinsert${i}`,e.getEffectType(3+i))}][c+d]||function(){})(n)})}).add([76,6,0],(r,s,f)=>{let i=r[0];i<64?e.setLetterDisplay(r.subarray(1),"XG letter display",i):x(e,Ae,Date.now())}).add([76,7,0],(r,s,f)=>{let i=r[0];x(e,Y,0),x(e,ue,Date.now()+3200),t(e,ne,ke).fill(0);let c=r.subarray(1);for(let o=0;o<i;o++)c.unshift(0);c.forEach(function(o,n){let d=Math.floor(n/16),l=n%16,m=(l*3+d)*7,$=7,T=0;for(m-=l*5,d==2&&($=2);T<$;)t(e,ne,ke)[m+T]=o>>6-T&1,T++})}).add([76,8],(r,s)=>{e.dispatchEvent("mupromptex");let f=e.chRedir(r[0],s,!0),i=r[1],c=p.cc*f,o=`XG CH${f+1} `,n=`Unknown XG part address ${i}.`,d=!0;r.subarray(2).forEach((l,m)=>{d=!0,i<1?console.debug(n):i<41?([()=>{t(e,g)[c+y[0]]=l,e.pushChPrimitives(f),e.dispatchEvent("voice",{part:f})},()=>{t(e,g)[c+y[32]]=l,e.pushChPrimitives(f),e.dispatchEvent("voice",{part:f})},()=>{t(e,A)[f]=l,e.dispatchEvent("voice",{part:f})},()=>{d=!1;let $=e.chRedir(l,s,!0);t(e,_)[f]=$,f!=$&&(e.buildRchTree(),console.info(`${o}receives from CH${$+1}`)),t(e,oe)[f]||(e.copyChSetup($,f,!0),console.debug(`${o}copied from CH${$+1}.`),e.setChActive(f,1),e.dispatchEvent("voice",{part:f}))},()=>{t(e,re)[f]=+!l},()=>{},()=>{d=!1,e.setChType(f,l,w.xg),console.debug(`${o}type: ${at[l]||l}`),e.dispatchEvent("voice",{part:f})},()=>{t(e,D)[p.rpn*f+3]=l,t(e,L)[p.rpnt*f+2]=1,e.dispatchEvent("pitch",{part:f,pitch:e.getPitchShift(f)})},!1,!1,()=>{t(e,g)[c+y[7]]=l},!1,!1,()=>{t(e,g)[c+y[10]]=l||128},!1,!1,()=>{t(e,g)[c+y[128]]=l,e.allocateAce(f,128)},()=>{t(e,g)[c+y[93]]=l},()=>{t(e,g)[c+y[91]]=l},()=>{t(e,g)[c+y[94]]=l},()=>{t(e,g)[c+y[76]]=l},()=>{t(e,g)[c+y[77]]=l},()=>{t(e,g)[c+y[78]]=l},()=>{t(e,g)[c+y[74]]=l},()=>{t(e,g)[c+y[71]]=l},()=>{t(e,g)[c+y[73]]=l},()=>{t(e,g)[c+y[75]]=l},()=>{t(e,g)[c+y[72]]=l}][i+m-1]||(()=>{}))():i<48?console.debug(n):i<111?i>102&&i<105&&(t(e,g)[c+y[[5,65][i&1]]]=l):i<114?console.debug(n):i<116?console.debug(`${o}EQ ${["bass","treble"][i&1]} gain: ${l-64}dB`):i<118?console.debug(n):i<120?console.debug(`${o}EQ ${["bass","treble"][i&1]} freq: ${l}`):console.debug(n)}),d&&t(e,R)[f]>1&&e.setDrumFirstWrite(f)}).add([76,9],(r,s)=>{let f=e.chRedir(r[0],s,!0),i=r[1],c=p.cc*f,o=`PLG-VL CH${f+1} `;r.subarray(2).forEach((n,d)=>{let l=d+i;switch(l){case 1:{console.info(`${o}breath mode: ${["system","breath","velocity","touch EG"][n]}`);break}case 0:case 27:case 28:break;default:if(l<27){let m=l-3>>1,$=["pressure","embouchure","tonguing","scream","breath noise","growl","throat formant","harmonic enhancer","damping","absorption","amplification","brightness"][m];l&1?l<23?(console.debug(`${o}${$} control source: ${Bt(n)}`),n&&n<96&&e.allocateAce(f,130+m),t(e,Be)[p.redir*f+m+2]=n,e.buildRccMap()):console.debug(`${o}${$} scale break point: ${n}`):(console.debug(`${o}${$} depth: ${n-64}`),t(e,g)[c+y[130+m]]=n)}}})}).add([76,10],(r,s,f)=>{}).add([76,16],(r,s,f)=>{}).add([76,17,0,0],(r,s,f)=>{}).add([76,112],(r,s,f)=>{switch(console.debug(`XG enable PLG-${["VL","SG","DX","AN","PF","DR","PC","AP"][r[0]]} for CH${r[2]+1}.`),r[0]){case 0:{t(e,ae)[p.ext*r[2]]=e.EXT_VL;break}case 2:{t(e,ae)[p.ext*r[2]]=e.EXT_DX;break}default:t(e,ae)[p.ext*r[2]]=e.EXT_NONE}}).add([73,0,0],(r,s)=>{let f=r[0],i="MU1000 System - ";r.subarray(1).forEach((c,o)=>{let n=f+o;n==8?console.debug(`${i}LCD contrast: ${c}.`):n==18?(t(e,F)[w.xg][1]=c?126:0,console.debug(`${i}default bank: ${c?"MU100 Native":"MU Basic"}.`),e.dispatchEvent("banklevel",{mode:"xg",data:+!!c}),e.forceVoiceRefresh()):n>=64&&n<69&&[()=>{e.dispatchEvent("channelactive",c)},()=>{c<8?(e.dispatchEvent("channelmin",c<<4),console.debug(`Octavia System: Minimum CH${(c<<4)+1}`)):(e.dispatchEvent("channelreset"),console.info("Octavia System: Clear channel ranges"))},()=>{c<8?(e.dispatchEvent("channelmax",(c<<4)+15),console.debug(`Octavia System: Maximum CH${(c<<4)+16}`)):(e.dispatchEvent("channelreset"),console.info("Octavia System: Clear channel ranges"))},()=>{e.dispatchEvent("channelreset"),console.info("Octavia System: Clear channel ranges")},()=>{x(e,ve,!!c),console.info(`Octavia System: RS receiving ${["dis","en"][c]}abled.`)}][n-64]()})}).add([73,10,0],(r,s)=>{let f=r[0],i=`MU1000 RS${t(e,ve)?"":" (ignored)"}: `;if(f<16)switch(f){case 2:{let c=e.chRedir(0,s,!0);t(e,ve)&&(e.dispatchEvent("portrange",4),e.dispatchEvent("portstart",c)),console.info(`${i}Show CH${c+1}~CH${c+64}`);break}case 3:{let c=e.chRedir(r[1]<<5,s,!0);t(e,ve)&&(e.dispatchEvent("portrange",2),e.dispatchEvent("portstart",c)),console.info(`${i}Show CH${c+1}~CH${c+32}`);break}default:console.debug(`${i}unknown switch ${f} invoked.`)}else if(f<32){if(t(e,ve)){let c=e.chRedir(f-16+(t(e,je)<<4),s,!0);e.dispatchEvent("channelactive",c)}}else if(f<36){let c=e.chRedir(f-32<<4,s,!0);t(e,ve)&&(e.dispatchEvent("portrange",1),e.dispatchEvent("portstart",c>>4),x(e,je,f-32)),console.info(`${i}Show CH${c+1}~CH${c+16}`)}}).add([73,11,0],(r,s)=>{let f="MU1000 System - channel ",i="Octavia System - channel ",c=r[0];r.subarray(1).forEach((o,n)=>{let d=c+n;([()=>{e.setChActive(o,1),e.dispatchEvent("channelactive",o),O()&&console.debug(`${f}current part: CH${o+1}`)},()=>{o<5?(e.dispatchEvent("portrange",1<<o),console.debug(`${f}port range: ${1<<o} port(s)`)):(e.dispatchEvent("portrange",0),console.debug(`${f}port range: reset`))},()=>{o<16?(e.dispatchEvent("portstart",o),console.debug(`${i}start port: ${"ABCDEFGHIJKLMNOP"[o]}`)):(e.dispatchEvent("portstart",255),console.debug(`${i}start port: reset`))}][d]||(()=>{console.debug(`${f}unknown address: ${d}`)}))()})}).add([93,3],(r,s)=>{let f=e.chRedir(r[0],s,!0),i=`PLG-SG CH${f+1} `,c=Date.now();if(r[1]==0){let o="",n=0;r.subarray(2).forEach((d,l)=>{l%2==0?o+=Lt[d]||d.toString().padStart("0"):n+=d*13}),c>=t(e,Ze)&&this.dispatchEvent("metacommit",{type:"SGLyrics",data:"",amend:!1}),this.dispatchEvent("metacommit",{type:"SGLyrics",data:`${Ut(o)}`,amend:!0}),x(e,Ze,c+Math.ceil(n/2)+t(e,Je)),O()&&console.debug(`${i}vocals: ${o}`)}else console.warn(`Unknown PLG-SG data: ${r}`)}).add([98,0],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=r[0],c=r.length-5,o=r.length-1;if(i!=c){console.info(`PLG-DX native dump size mismatch! Gave ${i} instead of ${r.length-5}.`);return}let n=Me(r.subarray(4,o));if(n!=r[o]){console.info(`Bad PLG-DX checksum ${r[o]} - should be ${n}.`);return}r[0]=98,t(e,ce).run(r.subarray(0,o),s,f,{noAce:!0})}).add([98,96],(r,s,f,i)=>{let c=e.chRedir(r[0],s,!0),o=p.cc*c,n=r[1];r.subarray(2).forEach((d,l)=>{let m=n+l;if(!(m<10)){if(m==10)e.resetAce();else if(m<27){let $=m+131;i!=null&&i.noAce||e.allocateAce(c,$),t(e,g)[o+y[$]]=d,e.dispatchEvent("cc",{part:c,cc:$,data:d})}}})}).add([100,0],(r,s,f)=>{let i=r.subarray(0,r.length-1);if(r[0]+5!=r.length){console.warn(`Yamaha DX7+ dump SysEx size mismatch! Expected ${r.length}, but got ${r[0]}:
`,r);return}let c=Me(i),o=r[r.length-1];if(c!=o){console.warn(`Yamaha DX7+ dump SysEx checksum mismatch! Expected ${c}, but got ${o}:
`,r);return}a.run(i.subarray(1))}).add([100,76],(r,s,f)=>{let i=r[0]>>4,c=r[0]&15,o=r[1];switch(i){case 2:{let n=e.chRedir(c,s,!0),d=p.cc*n;r.subarray(2).forEach((l,m)=>{let $=m+o;if(!($<7)){if($<23){let T=$+135;e.allocateAce(n,T),t(e,g)[d+y[T]]=l,e.dispatchEvent("cc",{part:n,cc:T,data:l})}}});break}default:console.info("Unknown DX7+ multipart: %o",r)}}).add([1,20],(r,s,f)=>{f==115?(e.switchMode("doc",!0),e.setPortMode(e.getTrackPort(s),1,w.doc),console.info("MIDI reset: DOC")):console.debug(`Unknown Yamaha SysEx: 67, ${f}, ${r.join(", ")}`)}).add([1,17,15,89],(r,s,f)=>{f==115?(e.setEffectType(0,24,r[0]|16),e.dispatchEvent("efxreverb",e.getEffectType(0))):console.debug(`Unknown Yamaha SysEx: 67, ${f}, ${r.join(", ")}`)}).add([1,24],(r,s,f)=>{if(f==115){for(let i=0;i<16;i++){let c=e.chRedir(i,s,!0);t(e,g)[c*p.cc+y[91]]=127}console.info("DOC Global Reverb: on")}else console.debug(`Unknown Yamaha SysEx: 67, ${f}, ${r.join(", ")}`)}),a.add([14,31],(r,s,f)=>{t(e,g)[p.cc*r[0]+y[64]]=0,t(e,G).ano(r[0]),e.switchMode("xg"),e.setPortMode(e.getTrackPort(s),1,w.xg),e.resetAce(),console.debug(`Yamaha DX7+ reset CH${r[0]+1}.`)}).add([76,112],async r=>{let s=r[0],f=p.cc*s,i=p.ext*s,c=p.cvn*s;t(e,ae)[i]=e.EXT_DX,t(e,be)[s]=1;let o=t(e,nt).subarray(c,c+p.cvn);o.fill(32),r.subarray(1).forEach((n,d)=>{if(d<10)o[d]=Math.max(n,32);else if(!(d<40)){if(d<56){let l=d+102;t(e,g)[f+y[l]]=n,e.dispatchEvent("cc",{part:s,cc:l,data:n})}}}),t(e,A)[s]=s&127,t(e,g)[p.cc*s+y[0]]=35,t(e,g)[p.cc*s+y[32]]=s>>7|4,e.pushChPrimitives(s),e.dispatchEvent("voice",{part:s}),console.debug(`DX7+ CH${s+1} dump: %o`,r)});let u=function(r,s,f,i){},b=function(r,s){e.dispatchEvent("mupromptex");let f=r*p.dpn,i=s[0],c=s[1];s.subarray(2).forEach((o,n)=>{let d=n+c,l=-1;d<16?([()=>{l=24},()=>{l=25},()=>{l=26},()=>{},()=>{l=28},()=>{l=29},()=>{l=30},()=>{l=31},()=>{},()=>{},()=>{},()=>{l=20},()=>{l=21},()=>{l=22},()=>{l=23},()=>{}][d]||(()=>{console.debug(`Unknown XG-style drum param ${d} on set ${r+1}.`)}))():d<32||(d<40?([()=>{l=48},()=>{l=49},!1,!1,()=>{l=52},()=>{l=53}][d-32]||(()=>{console.debug(`Unknown XG-style drum param ${d} on set ${r+1}.`)}))():d<80||([()=>{l=36}][d-80]||(()=>{console.debug(`Unknown XG-style drum param ${d} on set ${r+1}.`)}))()),l>=0?(O()&&console.debug(f,l,i,o),t(e,j)[(f+he[l])*p.dnc+i]=o):O()&&console.debug(`XG-style drum param ${d} has no writes.`)})},v=function(r,s,f){e.dispatchEvent("mupromptex");let i=r*p.dpn,c=(s<<7)+f[0];f.subarray(1).forEach((o,n)=>{let d=n+c,l=d&127,m=d>>7,$=-1;m>1&&([()=>{$=26},()=>{},()=>{$=28},()=>{$=29},()=>{$=30},()=>{},()=>{},()=>{$=31}][m-2]||(()=>{console.debug(`Unknown GS-style drum param ${m} on set ${r+1}.`)}))(),$>-1?(O()&&console.debug(i,$,l,o),t(e,j)[(i+he[$])*p.dnc+l]=o):O()&&console.debug(`GS-style drum param ${m} has no writes.`)})};t(this,ce).add([76,48],(r,s,f)=>{b(0,r)}).add([76,49],(r,s,f)=>{b(1,r)}).add([76,50],(r,s,f)=>{b(2,r)}).add([76,51],(r,s,f)=>{b(3,r)}).add([76,52],(r,s,f)=>{b(4,r)}).add([76,53],(r,s,f)=>{b(5,r)}).add([76,54],(r,s,f)=>{b(6,r)}).add([76,55],(r,s,f)=>{b(7,r)}),t(this,ce).add([89,0],(r,s,f)=>{if(e.eprom){let i=r[0],c=(r[1]<<14)+(r[2]<<7)+r[3]+(e.eprom.offset||0);O()&&console.debug(`MU1000 EPROM trail to 0x${c.toString(16).padStart(6,"0")}, ${i} bytes.`);let o=e.eprom.data;r.subarray(4).forEach((n,d)=>{let l=d>>3,m=d&7;if(m==7)for(let $=0;$<7;$++)o[c+7*l+$]+=(n>>6-$&1)<<7;else o[c+7*l+m]=n})}}).add([89,1],(r,s,f)=>{let i=(r[0]<<21)+(r[1]<<14)+(r[2]<<7)+r[3];O()&&console.debug(`MU1000 EPROM jump to 0x${i.toString(16).padStart(6,"0")}.`),e.eprom&&(e.eprom.offset=i)}).add([89,2],(r,s,f)=>{if(e.eprom){let i=(r[0]<<21)+(r[1]<<14)+(r[2]<<7)+r[3]+(e.eprom.offset||0);O()&&console.debug(`MU1000 EPROM write to 0x${i.toString(16).padStart(6,"0")}.`);let c=e.eprom.data;r.subarray(4).forEach((o,n)=>{let d=n>>3,l=n&7;if(l==7)for(let m=0;m<7;m++)c[i+7*d+m]+=(o>>6-m&1)<<7;else c[i+7*d+l]=o})}}).add([89,3],(r,s,f)=>{}),t(this,ce).add([39,48],(r,s,f)=>{}).add([43,0,0],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=[0,0,0,0],c=(o,n)=>{i[n]=o};if(r.subarray(1).forEach((o,n)=>{let d=n+r[0];[c,c,c,c,()=>{x(this,H,o*129/16383*100),e.dispatchEvent("mastervolume",t(e,H))},()=>o-64,()=>o||128,()=>o,()=>o,()=>{console.debug(`TG300 variation on cc${o}.`)}][d](o,d)}),r[0]<4){let o=0;i.forEach(n=>{o=o<<4,o+=n}),o-=1024}}).add([43,1,0],(r,s,f)=>{e.dispatchEvent("mupromptex")}).add([43,2],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=e.chRedir(r[0],s,!0),c=r[1],o=p.cc*i,n=`TG300 CH${i+1} `;r.subarray(2).forEach((d,l)=>{l<5?([()=>{},()=>{t(e,g)[o+y[0]]=d,e.pushChPrimitives(i),e.dispatchEvent("voice",{part:i})},()=>{t(e,g)[o+y[32]]=d,e.pushChPrimitives(i),e.dispatchEvent("voice",{part:i})},()=>{t(e,A)[i]=d,e.dispatchEvent("voice",{part:i})},()=>{let m=e.chRedir(d,s,!0);t(e,_)[i]=m,i!=m&&(e.buildRchTree(),console.info(`${n}receives from CH${m+1}`))}][l+c]||(()=>{}))(d,l+c):l<21||(l<47?([()=>{t(e,re)[i]=+!d},()=>{},()=>{},()=>{t(e,D)[p.rpn*i+3]=d,t(e,L)[p.rpnt*i+2]=1,e.dispatchEvent("pitch",{part:i,pitch:e.getPitchShift(i)})},()=>{},()=>{t(e,g)[o+y[7]]=d},!1,!1,()=>{t(e,g)[o+y[10]]=d||128},!1,!1,()=>{console.debug(`${n} AC1 at cc${d}`)},()=>{console.debug(`${n} AC2 at cc${d}`)},()=>{t(e,g)[o+y[128]]=d,e.allocateAce(i,128)},()=>{t(e,g)[o+y[93]]=d},()=>{t(e,g)[o+y[91]]=d},()=>{t(e,g)[o+y[94]]=d},()=>{t(e,g)[o+y[76]]=d},()=>{t(e,g)[o+y[77]]=d},()=>{t(e,g)[o+y[74]]=d},()=>{t(e,g)[o+y[71]]=d},()=>{t(e,g)[o+y[73]]=d},()=>{t(e,g)[o+y[75]]=d},()=>{t(e,g)[o+y[72]]=d},()=>{t(e,g)[o+y[78]]=d}][l+c-21]||(()=>{}))(d,l+c):l<95||([()=>{t(e,g)[o+y[65]]=d},()=>{t(e,g)[o+y[5]]=d}][l+c-95]||(()=>{}))(d,l+c))})}).add([43,7,0],(r,s,f)=>{let i=r[0];e.setLetterDisplay(r.subarray(1),"TG300 letter display",i)}).add([43,7,1],(r,s,f)=>{x(e,Y,0),x(e,ue,Date.now()+3200),t(e,ne,ke).fill(0),r.forEach(function(i,c){let o=Math.floor(c/16),n=c%16,d=(n*3+o)*7,l=7,m=0;for(d-=n*5,o==2&&(l=2);m<l;)t(e,ne,ke)[d+m]=i>>6-m&1,m++})}),t(this,le).add([66,18,0,0,127],(r,s,f)=>{e.switchMode("sc",!0),e.setPortMode(e.getTrackPort(s),2,w.sc),t(e,g)[p.cc*9]=120,t(e,g)[p.cc*25]=120,t(e,g)[p.cc*41]=120,t(e,g)[p.cc*57]=120,t(e,F)[w.sc][1]=t(e,U).sc,x(e,N,!1),t(e,Ce).fill(0),console.info(`GS system to ${["single","dual"][r[0]]} mode.`)}).add([66,18,64,0],(r,s,f)=>{switch(r[0]){case 127:{e.switchMode("gs",!0),e.setPortMode(e.getTrackPort(s),2,w.gs),t(e,F)[w.gs][1]=t(e,U).gs,t(e,g)[p.cc*9]=120,t(e,g)[p.cc*25]=120,t(e,g)[p.cc*41]=120,t(e,g)[p.cc*57]=120,x(e,N,!1),t(e,Ce).fill(0),console.info("MIDI reset: GS");break}default:{e.dispatchEvent("mupromptex");let i=[0,0,0,0],c=(o,n)=>{i[n]=o};if(r.subarray(1).forEach((o,n)=>{let d=n+r[0];[c,c,c,c,l=>{x(this,H,l*129/16383*100),e.dispatchEvent("mastervolume",t(e,H))},l=>{},l=>{}][d](o,n)}),r[0]<4){let o=0;i.forEach(n=>{o=o<<4,o+=n}),o-=1024}}}}).add([66,18,64,1],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=r[0];if(i<16){let c="".padStart(i," ");r.subarray(1).forEach((o,n)=>{c+=String.fromCharCode(Math.max(32,o))}),c=c.padEnd(16," "),console.debug(`GS patch name: ${c}`)}else i<48||(i<65?r.subarray(1).forEach((c,o)=>{let n=`GS ${i+o>55?"chorus":"reverb"} `;([()=>{console.info(`${n}type: ${yt[c]}`),e.setEffectType(0,40,c),e.dispatchEvent("efxreverb",e.getEffectType(0))},()=>{},()=>{},()=>{},()=>{},()=>{},!1,()=>{console.debug(`${n}predelay: ${c}ms`)},()=>{console.info(`${n}type: ${Ht[c]}`),e.setEffectType(1,40,16+c),e.dispatchEvent("efxchorus",e.getEffectType(1))},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{console.debug(`${n}to reverb: ${te(c)}`)},()=>{console.debug(`${n}to delay: ${te(c)}`)}][i+o-48]||(()=>{}))()}):i<80?console.debug(`Unknown GS patch address: ${i}`):i<91?r.subarray(1).forEach((c,o)=>{let n="GS delay ";([()=>{console.info(`${n}type: ${Nt[c]}`),e.setEffectType(2,40,32+c),e.dispatchEvent("efxdelay",e.getEffectType(2))},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{console.debug(`${n}to reverb: ${te(c)}`)}][i+o-80]||(()=>{}))()}):console.debug(`Unknown GS patch address: ${i}`))}).add([66,18,64,2],(r,s,f)=>{let i="GS EQ ";r.subarray(1).forEach((c,o)=>{([()=>{console.debug(`${i}low freq: ${[200,400][c]}Hz`)},()=>{console.debug(`${i}low gain: ${c-64}dB`)},()=>{console.debug(`${i}high freq: ${[3e3,6e3][c]}Hz`)},()=>{console.debug(`${i}high gain: ${c-64}dB`)}][r[0]+o]||function(){console.warn(`Unknown GS EQ address: ${r[0]+o}`)})()})}).add([66,18,64,3],(r,s,f)=>{e.dispatchEvent("mupromptex");let i="GS EFX ",c=function(o,n){let d=It(t(e,se).subarray(10,12),n,o);d&&console.debug(`${i}${mt(t(e,se).subarray(10,12))} ${d}`)};r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(3,!1,32+o),e.dispatchEvent("efxinsert0",e.getEffectType(3))},()=>{e.setEffectTypeRaw(3,!0,o),console.info(`${i}type: ${mt(t(e,se).subarray(10,12))}`),e.dispatchEvent("efxinsert0",e.getEffectType(3))},!1,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,()=>{console.debug(`${i}to reverb: ${te(o)}dB`)},()=>{console.debug(`${i}to chorus: ${te(o)}dB`)},()=>{console.debug(`${i}to delay: ${te(o)}dB`)},!1,()=>{console.debug(`${i}1 source: ${o}`),o&&o<96&&e.allocateAceAll(o)},()=>{console.debug(`${i}1 depth: ${o-64}`)},()=>{console.debug(`${i}2 source: ${o}`),o&&o<96&&e.allocateAceAll(o)},()=>{console.debug(`${i}2 depth: ${o-64}`)},()=>{console.debug(`${i}to EQ: ${o?"ON":"OFF"}`)}][r[0]+n]||function(d,l){console.warn(`Unknown GS EFX address: ${l}`)})(o,r[0]+n)})}).add([66,18,65],(r,s,f)=>{v((r[0]>>4)+1<<1,r[0]&15,r.subarray(1))}).add([69,18,16],(r,s,f)=>{var i;switch(r[0]){case 0:{let c=r[1];e.setLetterDisplay(r.subarray(2),"GS display text",c);break}case 8:{let c=r[1],o=e.modelEx.sc;r.subarray(2).forEach((n,d)=>{([()=>{o.showBar=!(n&1),o.invBar=n>>1&1,o.invDisp=n>>2&1},()=>{o.peakHold=n<4?n:1}][d+c]||(()=>{console.debug("Unsupported GS display type SysEx.")}))()});break}case 32:{x(e,ue,Date.now()+3200),r[1]==0&&(r[2]?(x(e,Y,Math.max(Math.min(r[2]-1,9),0)),O()&&console.debug(`GS switch display page ${r[2]-1}.`)):(x(e,Y,0),x(e,ue,Date.now()),O()&&console.debug("GS disable display page.")));break}default:if(r[0]<6){t(e,Y)>9&&x(e,Y,0);let c=r[0]-1<<1|r[1]>>6;t(e,Y)==c&&x(e,ue,Date.now()+3200),(i=t(e,xe)[c])!=null&&i.length||(t(e,xe)[c]=new Uint8Array(256));let o=t(e,xe)[c];O()&&console.debug(`GS frame draw page ${c}.`);let n=r[1]&63;o.fill(0),r.subarray(2).forEach(function(l,m){let $=m+n,T=Math.floor($/16),M=$%16,W=(M*4+T)*5,Te=5,we=0;for(W-=M*4,T==3&&(Te=1);we<Te;)o[W+we]=l>>4-we&1,we++})}else console.warn(`Unknown GS display section: ${r[0]}`)}}).add([69,18,32],(r,s,f)=>{let i=r[0],c=r[1],o=r.subarray(2);if(i>>4){console.warn(`SC-8850 partial screen dump out of bounds: invalid bundle.
`,r);return}let n=c+o.length,d=c*6-(c*2428>>16<<1),l=n*6-(n*2428>>16<<1);if(d>640){console.warn(`SC-8850 partial screen dump out of bounds: invalid buffer range.
`,r);return}l>640&&(console.info(`SC-8850 partial screen dump out of bounds: invalid buffer end, automatically restricted.
`,r),l=640);let m=new Uint8Array(l-d);o.forEach((M,W)=>{let Te=W+c,we=(Te*2428&65535)*27>>16==26,K=Te*6-(Te*2428>>16<<1),Ke=we?2:0;for(;Ke<6;)m[K+(5-Ke)]=M>>Ke&1,Ke++});let $=i*108+c,T=$*6-($*2428>>16<<1);e.dispatchEvent("screen",{type:"sc8850",offset:T,data:m}),O()&&console.debug(`SC-8850 screen dump: bundle ${i+1}, range ${d}~${l}`)});let k=function(r,s,f){e.dispatchEvent("mupromptex");let i=r[0],c=p.cc*s,o=p.rpn*s,n=`GS CH${s+1} `;i<3?(r.subarray(1).forEach((d,l)=>{[()=>{t(e,g)[c+y[0]]=d,e.pushChPrimitives(s)},()=>{t(e,A)[s]=d},()=>{let m=0;d<16?m=e.chRedir(d,f,!0):m=p.ch,t(e,_)[s]=m,s!=m&&(e.buildRchTree(),console.info(`${n}receives from CH${m+1}`))}][i+l]()}),e.dispatchEvent("voice",{part:s})):i<19||(i<44?r.subarray(1).forEach((d,l)=>{([()=>{t(e,re)[s]=+!d},!1,()=>{e.setChType(s,d<<1,w.gs),console.debug(`${n}type: ${d?"drum ":"melodic"}${d||""}`)},()=>{t(e,D)[o+3]=d,t(e,L)[p.rpnt*s+2]=1,e.dispatchEvent("pitch",{part:s,pitch:e.getPitchShift(s)})},!1,()=>{t(e,g)[c+y[7]]=d},!1,!1,()=>{t(e,g)[c+y[10]]=d||128},!1,!1,()=>{console.debug(`${n}CC 1: cc${d}`)},()=>{console.debug(`${n}CC 2: cc${d}`)},()=>{t(e,g)[c+y[93]]=d},()=>{t(e,g)[c+y[91]]=d},!1,!1,()=>{t(e,D)[o+1]=d,t(e,L)[p.rpnt*s+1]=1,e.dispatchEvent("pitch",{part:s,pitch:e.getPitchShift(s)})},()=>{t(e,D)[o+2]=d,t(e,L)[p.rpnt*s+1]=1,e.dispatchEvent("pitch",{part:s,pitch:e.getPitchShift(s)})},()=>{t(e,g)[c+y[94]]=d}][i+l-19]||(()=>{}))()}):i<76||console.debug(`Unknown GS part address: ${i}`))},C=function(r,s){let f=r[0],i=`GS CH${s+1} `;f<2?r.subarray(1).forEach((c,o)=>{[()=>{t(e,g)[p.cc*s+y[32]]=c},()=>{}][f+o]()}):f<32?console.warn(`Unknown GS misc address: ${f}`):f<35?r.subarray(1).forEach((c,o)=>{[()=>{console.debug(`${i}EQ: o${["ff","n"][c]}`)},()=>{},()=>{console.debug(`${i}EFX: o${["ff","n"][c]}`),t(e,Qe)[s]=c,e.dispatchEvent("partefxtoggle",{part:s,active:c})}][f+o-32]()}):console.warn(`Unknown GS misc address: ${f}`)};t(this,le).add([66,18,64,16],(r,s)=>{k(r,e.chRedir(9,s,!0),s)}).add([66,18,64,17],(r,s)=>{k(r,e.chRedir(0,s,!0),s)}).add([66,18,64,18],(r,s)=>{k(r,e.chRedir(1,s,!0),s)}).add([66,18,64,19],(r,s)=>{k(r,e.chRedir(2,s,!0),s)}).add([66,18,64,20],(r,s)=>{k(r,e.chRedir(3,s,!0),s)}).add([66,18,64,21],(r,s)=>{k(r,e.chRedir(4,s,!0),s)}).add([66,18,64,22],(r,s)=>{k(r,e.chRedir(5,s,!0),s)}).add([66,18,64,23],(r,s)=>{k(r,e.chRedir(6,s,!0),s)}).add([66,18,64,24],(r,s)=>{k(r,e.chRedir(7,s,!0),s)}).add([66,18,64,25],(r,s)=>{k(r,e.chRedir(8,s,!0),s)}).add([66,18,64,26],(r,s)=>{k(r,e.chRedir(10,s,!0),s)}).add([66,18,64,27],(r,s)=>{k(r,e.chRedir(11,s,!0),s)}).add([66,18,64,28],(r,s)=>{k(r,e.chRedir(12,s,!0),s)}).add([66,18,64,29],(r,s)=>{k(r,e.chRedir(13,s,!0),s)}).add([66,18,64,30],(r,s)=>{k(r,e.chRedir(14,s,!0),s)}).add([66,18,64,31],(r,s)=>{k(r,e.chRedir(15,s,!0),s)}).add([66,18,64,64],(r,s)=>{C(r,e.chRedir(9,s,!0))}).add([66,18,64,65],(r,s)=>{C(r,e.chRedir(0,s,!0))}).add([66,18,64,66],(r,s)=>{C(r,e.chRedir(1,s,!0))}).add([66,18,64,67],(r,s)=>{C(r,e.chRedir(2,s,!0))}).add([66,18,64,68],(r,s)=>{C(r,e.chRedir(3,s,!0))}).add([66,18,64,69],(r,s)=>{C(r,e.chRedir(4,s,!0))}).add([66,18,64,70],(r,s)=>{C(r,e.chRedir(5,s,!0))}).add([66,18,64,71],(r,s)=>{C(r,e.chRedir(6,s,!0))}).add([66,18,64,72],(r,s)=>{C(r,e.chRedir(7,s,!0))}).add([66,18,64,73],(r,s)=>{C(r,e.chRedir(8,s,!0))}).add([66,18,64,74],(r,s)=>{C(r,e.chRedir(10,s,!0))}).add([66,18,64,75],(r,s)=>{C(r,e.chRedir(11,s,!0))}).add([66,18,64,76],(r,s)=>{C(r,e.chRedir(12,s,!0))}).add([66,18,64,77],(r,s)=>{C(r,e.chRedir(13,s,!0))}).add([66,18,64,78],(r,s)=>{C(r,e.chRedir(14,s,!0))}).add([66,18,64,79],(r,s)=>{C(r,e.chRedir(15,s,!0))}),t(this,$e).add([54,65],(r,s)=>{let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f,!0),e.setPortMode(e.getTrackPort(s),1,w[f]);let i=r[r.length-1],c=r.subarray(0,r.length-1),o=Me(c);o!=i&&(console.info(`X5D multi parameters checksum mismatch! Expected ${o}, got ${i}.`),console.debug(r));let n=(r[1]<<7)+r[0],d=(r[3]<<7)+r[2],l=e.chRedir(n&15,s,!0),m=p.cc*l;[()=>{d<1||(d<101?(e.setChType(l,e.CH_MELODIC,w.x5d),t(e,A)[l]=d-1,t(e,g)[m+y[0]]=t(e,U).x5):d<229?(e.setChType(l,e.CH_MELODIC,w.x5d),t(e,A)[l]=d-101,t(e,g)[m+y[0]]=56):(e.setChType(l,e.CH_DRUMS,w.x5d),t(e,A)[l]=Wt[d-229]||0,t(e,g)[m+y[0]]=62)),e.pushChPrimitives(l),e.dispatchEvent("voice",{part:l})},()=>{t(e,g)[m+y[7]]=d},()=>{d<31&&(t(e,g)[m+y[10]]=Math.round((d-15)*4.2+64))},()=>{t(e,g)[m+y[93]]=st(d)},()=>{t(e,g)[m+y[91]]=st(d)},()=>{t(e,D)[l*p.rpn+3]=d>8191?d-16320:64+d,t(e,L)[p.rpnt*l+2]=1,e.dispatchEvent("pitch",{part:l,pitch:e.getPitchShift(l)})},()=>{t(e,D)[l*p.rpn+1]=d>8191?d-16320:64+d,t(e,L)[p.rpnt*l+1]=1,e.dispatchEvent("pitch",{part:l,pitch:e.getPitchShift(l)})},()=>{d>0&&(t(e,D)[l*p.rpn]=d,t(e,L)[p.rpnt*l]=1,e.dispatchEvent("pitch",{part:l,pitch:e.getPitchShift(l)}))},()=>{}][n>>4]()}).add([54,76,0],(r,s)=>{e.dispatchEvent("mupromptex");let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f),e.setPortMode(e.getTrackPort(s),1,w[f]);let i="",c=t(e,U).x5,o=0,n=0,d="MSB	PRG	LSB	NME";fe(r,function(l,m){if(m<16400){let $=m%164;switch(!0){case $<10:{l>31&&(i+=String.fromCharCode(l));break}case $==10:break;case $==11:{d+=`
${c}	${o}	${n}	${i.trim().replace("Init Voice","")}`,o++,i="";break}}o>99&&(c=90,o=0)}}),e.userBank.clearRange({msb:t(e,U).x5,prg:[0,99],lsb:0}),e.userBank.load(d),O()&&console.debug(d),e.forceVoiceRefresh()}).add([54,77,0],(r,s)=>{e.dispatchEvent("mupromptex");let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f),e.setPortMode(e.getTrackPort(s),1,w[f]);let i="",c=90,o=0,n=0,d="MSB	PRG	LSB	NME";fe(r,function(l,m){if(m<13600){let $=m%136;switch(!0){case $<10:{l>31&&(i+=String.fromCharCode(l));break}case $==11:{d+=`
${c}	${o}	${n}	${i.trim().replace("Init Combi","")}`,o++,i="";break}}}}),e.userBank.clearRange({msb:90,prg:[0,99],lsb:0}),e.userBank.load(d),O()&&console.debug(d),e.forceVoiceRefresh()}).add([54,78],(r,s)=>{let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f),e.setPortMode(e.getTrackPort(s),1,w[f]),console.debug(`X5D mode switch requested: ${["combi","combi edit","prog","prog edit","multi","global"][r[0]]} mode.`)}).add([54,85],(r,s)=>{e.dispatchEvent("mupromptex");let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f),e.setPortMode(e.getTrackPort(s),1,w[f]),fe(r,(i,c)=>{c>0&&c<3&&(e.setEffectType(c-1,44,i),e.dispatchEvent(`efx${["reverb","chorus"][c-1]}`,e.getEffectType(c-1)))})}).add([54,104],(r,s)=>{e.dispatchEvent("mupromptex");let f=t(e,U).x5=="81"?"05rw":"x5d";e.switchMode(f,!0);let i=e.getTrackPort(s);if(t(e,I)[i]&&t(e,I)[i]!=w[f])if(t(e,me).dumpLimit==e.DUMP_MODE){console.warn(`Dump cancelled for track ${s}. Port ${String.fromCharCode(65+i)} mode "${Q[t(e,I)[i]]}" mismatch, should be "${f}".`);return}else console.info(`Track ${s} is trying to perform a mismached mode dump on port ${String.fromCharCode(65+i)}.`);e.setPortMode(i,1,w[f]),fe(r,function(c,o,n,d){if(o<192){let l=e.chRedir(Math.floor(o/12),s,!0),m=l*p.cc;switch(o%12){case 0:{c<128?(e.setChType(l,e.CH_MELODIC,w.x5d),t(e,g)[m+y[0]]=t(e,U).x5,t(e,A)[l]=c):(e.setChType(l,e.CH_DRUMS,w.x5d),t(e,g)[m+y[0]]=62,t(e,A)[l]=Wt[c-128]),c>0&&e.setChActive(l,1),e.pushChPrimitives(l),e.dispatchEvent("voice",{part:l});break}case 1:{t(e,g)[m+y[7]]=c;break}case 2:{t(e,D)[l*p.rpn+3]=c>127?c-192:64+c,t(e,L)[p.rpnt*l+2]=1,e.dispatchEvent("pitch",{part:l,pitch:e.getPitchShift(l)});break}case 3:{t(e,D)[l*p.rpn+1]=c>127?c-192:64+c,t(e,L)[p.rpnt*l+1]=1,e.dispatchEvent("pitch",{part:l,pitch:e.getPitchShift(l)});break}case 4:{c<31&&(t(e,g)[m+y[10]]=Math.round((c-15)*4.2+64));break}case 5:{let $=c>>4,T=c&15;t(e,g)[m+y[91]]=st(T),t(e,g)[m+y[93]]=st($);break}case 10:{t(e,R)[l]||(t(e,g)[m+y[0]]=c>>6?56:t(e,U).x5,e.pushChPrimitives(l),e.dispatchEvent("voice",{part:l}));break}case 11:{let $=e.chRedir(c&15,s,!0),T=c>>4;t(e,_)[l]=c,($!=l||T)&&(console.info(`X5D Part CH${l+1} receives from CH${$+1}.`),e.buildRchTree())}}}else{let l=e.chRedir(o-192,s,!0)}})}),t(this,le).add([22,18,127],(r,s,f)=>{e.switchMode("mt32",!0),e.setPortMode(e.getTrackPort(s),1,w.mt32),x(e,N,!1),e.userBank.clearRange({msb:0,lsb:127,prg:[0,127]}),console.info("MIDI reset: MT-32")}).add([22,18,0],(r,s,f)=>{e.switchMode("mt32");let i=e.chRedir(f,s,!0),c=r[1];r.subarray(2).forEach((o,n)=>{let d=n+c;t(e,Re)[d+(i-1)*16]=o,([!1,()=>{let l=t(e,Re)[i-1<<4];if(l<3){if(t(e,be)[i]=1,l==2)for(let m=0;m<name.length;m++)t(e,ge)[(i-1)*p.cmt+m]=t(e,De)[o*p.cmt+m];else{let m=e.baseBank.get(0,o+(l<<6),127,"mt32").name;for(let $=0;$<m.length;$++)t(e,ge)[(i-1)*p.cmt+$]=m.charCodeAt($)}e.dispatchEvent("voice",{part:i})}},()=>{t(e,D)[i*p.rpn+3]=o+40,t(e,L)[p.rpnt*i+2]=1},()=>{t(e,D)[i*p.rpn+1]=o+14,t(e,L)[p.rpnt*i+1]=1},()=>{t(e,D)[i*p.rpn]=o,t(e,L)[p.rpnt*i]=1},!1,()=>{t(e,g)[p.cc*i+y[91]]=o?127:0},!1,()=>{t(e,g)[p.cc*i+y[7]]=o},()=>{t(e,g)[p.cc*i+y[10]]=Math.ceil(o*9.05)}][d]||(()=>{}))()})}).add([22,18,1],(r,s,f)=>{e.switchMode("mt32");let i=f&7;console.debug(`MT-32 slot #${f+1} Drum: ${r}`);let c=r[0]<<7|r[1];r.subarray(2).forEach((o,n)=>{let d=n+c,l=(d>>2)+24,m=d&3,$=i*p.dpn;if(O()&&console.debug(`MT-32 temp drum note ${l} param ${m}: ${o}`),l<24){console.warn(`MT-32 dev drum write attempted on an OOB note: ${l}`);return}[()=>{},()=>{t(e,j)[($+he[26])*p.dnc+l]=Math.round(o*1.27)},()=>{t(e,j)[($+he[26])*p.dnc+l]=o*9+1&127},()=>{t(e,j)[($+he[26])*p.dnc+l]=o?127:0}][m]()})}).add([22,18,2],(r,s,f)=>{e.switchMode("mt32");let i=e.chRedir(f,s,!0),c=r[1]+(r[0]<<7);c<10&&(t(e,be)[i]=1),r.subarray(2).forEach((o,n)=>{let d=n+c;d<14&&(t(e,ge)[(i-1)*p.cmt+d]=o)}),e.dispatchEvent("voice",{part:i})}).add([22,18,3],(r,s,f)=>{e.switchMode("mt32");let i=f&7;if(r[0]){let c=(r[0]-1<<7)+r[1]-16;r.subarray(2).forEach((o,n)=>{let d=n+c,l=(d>>2)+24,m=d&3,$=i*p.dpn;if(O()&&console.debug(`MT-32 dev drum note ${l} param ${m}: ${o}`),l<24){console.warn(`MT-32 dev drum write attempted on an OOB note: ${l}`);return}[()=>{},()=>{t(e,j)[($+he[26])*p.dnc+l]=Math.round(o*1.27)},()=>{t(e,j)[($+he[26])*p.dnc+l]=o*9+1&127},()=>{t(e,j)[($+he[26])*p.dnc+l]=o?127:0}][m]()})}else{let c=r[1];r.subarray(2).forEach((o,n)=>{let d=n+c;t(e,Re)[d]=o;let l=e.chRedir(1+(d>>4),s,!0),m=d&15;([!1,()=>{let $=t(e,Re)[l-1<<4];if($<3)if(t(e,be)[l]=1,$==2)for(let T=0;T<name.length;T++)t(e,ge)[(l-1)*p.cmt+T]=t(e,De)[o*p.cmt+T];else{let T=e.baseBank.get(0,o+($<<6),127,"mt32").name;for(let M=0;M<T.length;M++)t(e,ge)[(l-1)*p.cmt+M]=T.charCodeAt(M)}e.dispatchEvent("voice",{part:l})},()=>{t(e,D)[l*p.rpn+3]=o+40,t(e,L)[p.rpnt*l+2]=1},()=>{t(e,D)[l*p.rpn+1]=o+14,t(e,L)[p.rpnt*l+1]=1},()=>{t(e,D)[l*p.rpn]=o,t(e,L)[p.rpnt*l]=1},!1,()=>{t(e,g)[p.cc*l+y[91]]=o?127:0},!1,()=>{t(e,g)[p.cc*l+y[7]]=o},()=>{t(e,g)[p.cc*l+y[10]]=Math.ceil(o*9.05)}][m]||(()=>{}))()})}}).add([22,18,4],(r,s,f)=>{e.switchMode("mt32");let i=r[1]+(r[0]<<7),c=[];r.subarray(2).forEach((o,n)=>{let d=n+i,l=e.chRedir(Math.floor(d/246+1),s,!0),m=d%246;m<14&&(t(e,ge)[(l-1)*p.cmt+m]=o),m<10&&(t(e,be)[l]=1),c.indexOf(l)<0&&c.push(l)}),c.forEach(o=>{e.dispatchEvent("voice",{part:o})})}).add([22,18,5],(r,s,f)=>{e.switchMode("mt32");let i=(r[0]<<7)+r[1];r.subarray(2).forEach((c,o)=>{let n=i+o,d=Math.floor(n/8),l=n&7,m=d*8;t(e,Ye)[n]=c,([!1,()=>{let $=t(e,Ye)[m];if($<3){let T="";if($==2){let W=p.cmt*d;T=`MT-m:${c.toString().padStart(3,"0")}`}else T=e.baseBank.get(0,c+($<<6),127,"mt32").name;e.userBank.clearRange({msb:0,lsb:127,prg:d});let M=`MSB	LSB	PRG	NME
000	127	${d}	${T}`;e.userBank.load(M,!0)}}][l]||(()=>{}))()}),e.forceVoiceRefresh()}).add([22,18,8],(r,s,f)=>{e.switchMode("mt32");let i=((r[0]&1)<<7)+r[1],c=r[0]>>1,o=!1;if(r.subarray(2).forEach((n,d)=>{let l=i+d;l<p.cmt&&(t(e,De)[c*p.cmt+l]=n,o=!0)}),o){e.userBank.clearRange({msb:0,lsb:127,prg:c});let n=`MSB	LSB	PRG	NME
000	127	${c}	MT-m:${c}`;e.userBank.load(n,!0)}e.forceVoiceRefresh()}).add([22,18,16],(r,s,f)=>{e.switchMode("mt32");let i=r[1],c=!1,o=function(n,d){t(e,_)[d-12]=n,c=!0};r.subarray(2).forEach((n,d)=>{let l=d+i;([!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,o,o,o,o,o,o,o,o,o,()=>{x(e,H,n),e.dispatchEvent("mastervolume",t(e,H))}][l]||(()=>{}))(n,d)}),c&&e.buildRchTree()}).add([22,18,32],(r,s,f)=>{e.switchMode("mt32");let i=r[1],c=" ".repeat(i);r.subarray(2).forEach(o=>{o>31?c+=String.fromCharCode(o):c+=" "}),x(e,Oe,c.padStart(20," ")),x(e,Ae,Date.now()+3200)}).add([22,18,82],(r,s)=>{let f=e.chRedir(0,s,!0);for(let i=0;i<16;i++)t(e,G).ano(f+i),i&&i<10&&(t(e,A)[f+i]=vt[i-1]);console.info("MT-32 alt reset complete.")}),t(this,$e).add([66,0],(r,s)=>{e.switchMode("ns5r",!0),e.setPortMode(e.getTrackPort(s),2,w.ns5r),x(e,N,!1),console.debug(`NS5R mode switch requested: ${["global","multi","prog edit","comb edit","drum edit","effect edit"][r[0]]} mode.`)}).add([66,1],(r,s)=>{let f=["ns5r","05rw"][r[0]];e.switchMode(f,!0),e.setPortMode(e.getTrackPort(s),2,w[f]),x(e,N,!1)}).add([66,18,0,0],(r,s)=>{let f=r[0];switch(f){case 124:case 126:case 127:{e.switchMode("ns5r",!0),e.setPortMode(e.getTrackPort(s),2,w.ns5r),x(e,N,!1);break}case 125:{e.initDrums(),console.info(`NS5R drum setup reset: ${r}`);break}default:if(f<10){let i=[0,0,0,0],c=(o,n)=>{i[n]=o};if(r.subarray(1).forEach((o,n)=>{[c,c,c,c,()=>{x(e,H,o*129/16383*100),e.dispatchEvent("mastervolume",t(e,H))},()=>o-64,()=>o-64,()=>{},()=>{},()=>{}][f+n]()}),r[0]<4){let o=0;i.forEach(n=>{o=o<<4,o+=n}),o-=1024}}}}).add([66,18,0,1],(r,s)=>{}).add([66,18,0,2],(r,s)=>{}).add([66,18,1],(r,s)=>{e.dispatchEvent("mupromptex");let f=e.chRedir(r[0],s,!0),i=f*p.cc,c=r[1],o=`NS5R CH${f+1} `;r.subarray(2).forEach((n,d)=>{let l=c+d;l<3?([()=>{t(e,g)[i+y[0]]=n||it.bank0,e.pushChPrimitives(f)},()=>{t(e,g)[i+y[32]]=n,e.pushChPrimitives(f)},()=>{t(e,A)[f]=n}][l](),e.dispatchEvent("voice",{part:f})):l<8||(l<14?[()=>{let m=e.chRedir(n,s,!0);t(e,_)[f]=m,f!=m&&(e.buildRchTree(),console.info(`${o}receives from CH${m+1}`))},()=>{t(e,re)[f]=+!n},()=>{e.setChType(f,n,w.ns5r),console.debug(`${o}type: ${at[n]}`)},()=>{t(e,D)[p.rpn*f+3]=n,t(e,L)[p.rpnt*f+2]=1,e.dispatchEvent("pitch",{part:f,pitch:e.getPitchShift(f)})},()=>{},()=>{}][l-8]():l<16||(l<33?[()=>{t(e,g)[i+y[7]]=n},()=>{t(e,g)[i+y[11]]=n},()=>{},()=>{},()=>{t(e,g)[i+y[10]]=n||128},()=>{},()=>{},()=>{t(e,g)[i+y[93]]=n},()=>{t(e,g)[i+y[91]]=n},()=>{t(e,g)[i+y[76]]=n},()=>{t(e,g)[i+y[77]]=n},()=>{t(e,g)[i+y[78]]=n},()=>{t(e,g)[i+y[74]]=n},()=>{t(e,g)[i+y[71]]=n},()=>{t(e,g)[i+y[73]]=n},()=>{t(e,g)[i+y[75]]=n},()=>{t(e,g)[i+y[72]]=n}][l-16]():l<112||l<114&&[()=>{t(e,g)[i+y[5]]=n},()=>{t(e,g)[i+y[65]]=n}][l-112]()))})}).add([66,18,8,0],(r,s)=>{let f=r[0];if(f<32)e.setLetterDisplay(r.subarray(1,33),"NS5R letter display");else{let i=f-32;x(e,ue,Date.now()+3200),x(e,Y,10),t(e,ne,ke).fill(0);let c=r.subarray(1),o=4;c.forEach(function(n,d){let l=d+i,m=l>>4,$=l&15;if(l<80){let T=m<o?n:n>>3,M=0,W=m<o?6:3;for(;T>0;)t(e,ne,ke)[$*32+m*7+(W-M)]=T&1,T=T>>1,M++}})}}).add([66,18,48],(r,s,f)=>{b(0,r)}).add([66,18,49],(r,s,f)=>{b(1,r)}).add([66,18,50],(r,s,f)=>{b(2,r)}).add([66,18,51],(r,s,f)=>{b(3,r)}).add([66,18,52],(r,s,f)=>{b(4,r)}).add([66,18,53],(r,s,f)=>{b(5,r)}).add([66,18,54],(r,s,f)=>{b(6,r)}).add([66,18,55],(r,s,f)=>{b(7,r)}).add([66,52],(r,s)=>{e.switchMode("ns5r"),x(e,N,!1);let f="";fe(r,(i,c)=>{c<8?(i>31&&(f+=String.fromCharCode(i)),c==7&&(e.aiEfxName=f)):c<10&&(e.setEffectType(c-8,44,i),e.dispatchEvent(`efx${["reverb","chorus"][c-8]}`,e.getEffectType(c-8)))})}).add([66,53],(r,s)=>{e.dispatchEvent("mupromptex"),e.switchMode("ns5r"),x(e,N,!1);let f="",i=r[r.length-1],c=r.subarray(0,r.length-1),o=Me(c);o!=i&&(console.info(`NS5R current multi dump checksum mismatch! Expected ${o}, got ${i}.`),console.debug(r));let n=e.getTrackPort(s);if(t(e,I)[n]&&t(e,I)[n]!=w.ns5r)if(t(e,me).dumpLimit==e.DUMP_MODE){console.warn(`Dump cancelled for track ${s}. Port ${String.fromCharCode(65+n)} mode "${Q[t(e,I)[n]]}" mismatch, should be "ns5r".`);return}else console.info(`Track ${s} is trying to perform a mismached mode dump on port ${String.fromCharCode(65+n)}.`);e.setPortMode(n,2,w.ns5r),fe(c,function(d,l){switch(!0){case l<2944:{let m=e.chRedir(Math.floor(l/92),s,!0),$=m*p.cc;switch(l%92){case 0:{t(e,g)[$+y[0]]=d,e.pushChPrimitives(m),e.dispatchEvent("voice",{part:m});break}case 1:{t(e,g)[$+y[32]]=d,!d&&!t(e,g)[$+y[0]]&&(t(e,g)[$+y[0]]=it.bank0),e.pushChPrimitives(m),e.dispatchEvent("voice",{part:m});break}case 2:{t(e,A)[m]=d,d>0&&e.setChActive(m,1),e.dispatchEvent("voice",{part:m});break}case 3:{let T=e.chRedir(d,s,!0);t(e,_)[m]=T,m!=T&&(console.info(`NS5R CH${m+1} receives from CH${T+1}.`),e.buildRchTree());break}case 7:{t(e,R)[m]=d,e.dispatchEvent("voice",{part:m});break}case 8:{t(e,D)[m*p.rpn+3]=d<40||d>88?d+(d>63?-192:64):d,t(e,L)[p.rpnt*m+2]=1,e.dispatchEvent("pitch",{part:m,pitch:e.getPitchShift(m)});break}case 9:case 10:{t(e,g)[$+y[7]]=d;break}case 11:{t(e,g)[$+y[11]]=d;break}case 14:{t(e,g)[$+y[10]]=d||128;break}case 19:{t(e,g)[$+y[93]]=d;break}case 20:{t(e,g)[$+y[91]]=d;break}case 84:{t(e,g)[$+y[65]]=d;break}case 85:{t(e,g)[$+y[5]]=d;break}}break}case l<3096:break;case l<3134:{let m=l-3096;m<8?(d>31&&(f+=String.fromCharCode(d)),m==7&&(e.aiEfxName=f)):m<10&&(e.setEffectType(m-8,44,d),e.dispatchEvent(`efx${["reverb","chorus"][m-8]}`,e.getEffectType(m-8)));break}case l<8566:break}})}).add([66,54],(r,s)=>{e.dispatchEvent("mupromptex"),e.switchMode("ns5r");let f="",i=80,c=0,o=0,n="MSB	PRG	LSB	NME";fe(r,function(d,l){let m=l%158;switch(!0){case m<10:{d>31&&(f+=String.fromCharCode(d));break}case m==10:break;case m==11:{i=d&127;break}case m==12:{o=d&127;break}case m==13:{n+=`
${i}	${c}	${o}	${f.trim().replace("Init Voice","")}`,c++,f="";break}}}),e.userBank.clearRange({msb:80,lsb:0}),e.userBank.load(n),O()&&console.debug(n),e.forceVoiceRefresh()}).add([66,55],(r,s)=>{e.dispatchEvent("mupromptex"),e.switchMode("ns5r");let f="",i=88,c=0,o=0,n="MSB	PRG	LSB	NME";fe(r,function(d,l){let m=l%126;switch(!0){case m<10:{d>31&&(f+=String.fromCharCode(d));break}case m==11:break;case m==12:break;case m==13:{n+=`
${i}	${c}	${o}	${f.trim().replace("Init Combi","")}`,c++,f="";break}}}),e.userBank.clearRange({msb:88,lsb:0}),e.userBank.load(n),O()&&console.debug(n),e.forceVoiceRefresh()}).add([66,125],(r,s,f)=>{e.dispatchEvent("backlight",["green","orange","red",!1,"yellow","blue","purple"][r[0]]||"white")}).add([66,127],(r,s,f)=>{let i=r[r.length-1],c=r.subarray(0,r.length-1),o=Me(c);o!=i&&(console.info(`NS5R screen dump checksum mismatch! Expected ${o}, got ${i}.`),console.debug(r));let n=new Uint8Array(5760);fe(r,(d,l,m)=>{if(l<720)for(let $=0;$<8;$++)n[l*8+$]=d>>7-$&1}),e.dispatchEvent("screen",{type:"ns5r",data:n})}).add([76],(r,s,f)=>{t(e,$e).run([66,...r],s,f)}),t(this,Xe).add([16,0,8,0],(r,s,f)=>{let i=(r[2]<<4)+r[3],c="K11 ";([()=>{e.switchMode("k11",!0),e.setPortMode(e.getTrackPort(s),2,w.k11),x(e,N,!1),t(e,F)[w.k11][1]=i?4:0,console.info("MIDI reset: GMega/K11")},()=>{e.setEffectType(0,24,i),console.debug(`${c}reverb type: ${i}`),e.dispatchEvent("efxreverb",e.getEffectType(0))},()=>{console.debug(`${c}reverb time: ${i}`)},()=>{console.debug(`${c}reverb time: ${i}`)},()=>{console.debug(`${c}reverb predelay: ${i}`)},()=>{console.debug(`${c}reverb predelay: ${i}`)},()=>{console.debug(`${c}depth high: ${i}`)},()=>{console.debug(`${c}depth high: ${i}`)},()=>{console.debug(`${c}depth low: ${i}`)},()=>{console.debug(`${c}depth low: ${i}`)}][r[0]]||(()=>{}))()}).add([16,0,8,1],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=e.chRedir(r[1],s,!0),c=p.cc*i,o=p.rpn*i,n=(r[3]<<4)+r[4],d=`K11 CH${i+1} `;([()=>{n<128?(e.setChType(i,e.CH_MELODIC,w.k11),t(e,g)[c+y[0]]=0,t(e,A)[i]=n):(e.setChType(i,e.CH_DRUMS,w.k11),t(e,A)[i]=n-128),e.pushChPrimitives(i),e.dispatchEvent("voice",{part:i})},()=>{let l=e.chRedir(n,s,!0);t(e,_)[i]=l,i!=l&&(e.buildRchTree(),console.info(`${d}receives from CH${l+1}`))},()=>{t(e,g)[c+y[7]]=n},()=>{uupThis.setChActive(i,n)},()=>{t(e,g)[c+y[10]]=n},()=>{t(e,D)[o+3]=n+40,t(e,L)[p.rpnt*i+2]=1,e.dispatchEvent("pitch",{part:i,pitch:e.getPitchShift(i)})},()=>{t(e,D)[o+1]=n>>1,t(e,D)[o+2]=n&1,t(e,L)[p.rpnt*i+1]=1,e.dispatchEvent("pitch",{part:i,pitch:e.getPitchShift(i)})},()=>{t(e,g)[c+y[91]]=n?127:0},()=>{},()=>{t(e,g)[c+y[74]]=n},()=>{t(e,g)[c+y[73]]=n},()=>{t(e,g)[c+y[72]]=n}][r[0]]||(()=>{}))()}).add([16,0,9,0],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=(r[2]<<4)+r[3],c="GMLX ";([()=>{console.debug(`${c}reverb type: ${i}`)},()=>{console.debug(`${c}reverb time: ${i}`)},()=>{console.debug(`${c}reverb predelay: ${i}`)},()=>{console.debug(`${c}depth high: ${i}`)},()=>{console.debug(`${c}depth low: ${i}`)}][r[0]]||(()=>{}))()}).add([16,0,9,3],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=(r[2]<<4)+r[3],c=e.chRedir(r[1],s,!0),o=c*p.cc;[()=>{i<128?(e.setChType(c,e.CH_MELODIC,w.k11),t(e,g)[o+y[0]]=0,t(e,g)[o+y[32]]=0,t(e,A)[c]=i):i<160?(e.setChType(c,e.CH_MELODIC,w.k11),t(e,g)[o+y[0]]=0,t(e,g)[o+y[32]]=7,t(e,A)[c]=i-100):(e.setChType(c,e.CH_DRUMS,w.k11),t(e,g)[o+y[0]]=122,t(e,g)[o+y[32]]=0,t(e,A)[c]=i-160),e.pushChPrimitives(c),e.dispatchEvent("voice",{part:c})},()=>{let n=e.chRedir(i,s,!0);t(e,_)[c]=n,c!=n&&(e.buildRchTree(),console.info(`GMLX CH${c+1} receives from CH${n+1}`))}][r[0]]()}).add([16,0,9,4],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=(r[2]<<4)+r[3],c=e.chRedir(r[1],s,!0),o=c*p.cc,n=c*p.rpn,d=`GMLX CH${c+1} `;[()=>{e.setChActive(c,i)},()=>{t(e,g)[o+y[7]]=i},()=>{t(e,g)[o+y[10]]=i},()=>{t(e,g)[o+y[91]]=i?127:0},()=>{t(e,D)[n+3]=i+40,t(e,L)[p.rpnt*c+2]=1,e.dispatchEvent("pitch",{part:c,pitch:e.getPitchShift(c)})},()=>{t(e,D)[n+1]=i,t(e,L)[p.rpnt*c+1]=1,e.dispatchEvent("pitch",{part:c,pitch:e.getPitchShift(c)})},()=>{t(e,D)[n]=i,t(e,L)[p.rpnt*c]=1,e.dispatchEvent("pitch",{part:c,pitch:e.getPitchShift(c)})},()=>{}][r[0]]()}),t(this,Ve).add([66,93,64],(r,s,f)=>{let i=r[2];switch(r[0]){case 0:{switch(r[1]){case 4:{e.dispatchEvent("mupromptex"),x(e,H,i*129/16383*100),e.dispatchEvent("mastervolume",t(e,H));break}case 5:{e.dispatchEvent("mupromptex"),i-64;break}case 6:{e.dispatchEvent("mupromptex"),console.debug(`SG global reverb: ${i?"on":"off"}`);break}case 127:{e.switchMode("sg",!0),e.setPortMode(e.getTrackPort(s),1,w.sg);break}}break}case 1:{switch(r[1]){case 48:{e.dispatchEvent("mupromptex"),console.debug(`SG reverb type: ${yt[i]}`);break}}break}default:if(r[0]>>4==1){e.dispatchEvent("mupromptex");let c=e.chRedir(r[0]&15,s,!0);if(r[1]==2){let o=e.chRedir(i,s,!0);t(e,_)[c]=o,c!=o&&(e.buildRchTree(),console.info(`SG CH${c+1} receives from CH${o+1}`))}else r[1]==19&&(t(e,g)[p.cc*c+y[7]]=i)}else console.warn(`Unknown AKAI SG SysEx: ${r}`)}}),t(this,Fe).add([9],(r,s,f)=>{e.dispatchEvent("mupromptex"),console.debug(`GZ set effect: ${["stage reverb","hall reverb","room reverb","chorus","tremolo","phaser","rotary speaker","enhancer","flanger","EQ"][r[0]]||"off"}`)}),t(this,ce).add([127,0],(r,s,f)=>{e.switchMode("motif");let i=new Uint8Array([127,1,...r]);t(e,ce).run(i,s,f)}).add([127,1,0,0],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES system ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{x(e,H,o*12900/16383),e.dispatchEvent("mastervolume",t(e,H))}][c+n]||(()=>{console.info(`Unrecognized ${i}ID: ${c+n}`)}))()})}).add([127,1,0,36,54,1],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES reverb ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(0,!1,o&15|112)},()=>{e.setEffectTypeRaw(0,!0,o)}][c+n]||(()=>{}))()}),e.dispatchEvent("efxreverb",e.getEffectType(0))}).add([127,1,0,37,54,2],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES chorus ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(1,!1,o&15|112)},()=>{e.setEffectTypeRaw(1,!0,o)}][c+n]||(()=>{}))()}),e.dispatchEvent("efxchorus",e.getEffectType(1))}).add([127,1,0,34,54,3],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES insert 1 ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(3,!1,o&15|112)},()=>{e.setEffectTypeRaw(3,!0,o)}][c+n]||(()=>{}))()}),e.dispatchEvent("efxinsert0",e.getEffectType(3))}).add([127,1,0,34,54,4],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES insert 2 ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(4,!1,o&15|112)},()=>{e.setEffectTypeRaw(4,!0,o)}][c+n]||(()=>{}))()}),e.dispatchEvent("efxinsert1",e.getEffectType(4))}).add([127,1,0,35,54,17],(r,s,f)=>{e.switchMode("s90es");let i="S90/Motif ES variation ",c=r[0];r.subarray(1).forEach((o,n)=>{([()=>{e.setEffectTypeRaw(2,!1,o&15|112)},()=>{e.setEffectTypeRaw(2,!0,o)}][c+n]||(()=>{}))()}),e.dispatchEvent("efxdelay",e.getEffectType(2))}).add([127,1,0,58,55],(r,s,f)=>{e.dispatchEvent("mupromptex"),e.switchMode("s90es");let i=e.getTrackPort(s);if(t(e,I)[i]&&t(e,I)[i]!=t(e,U).smotif)if(t(e,me).dumpLimit==e.DUMP_MODE){console.warn(`Dump cancelled for track ${s}. Port ${String.fromCharCode(65+i)} mode "${Q[t(e,I)[i]]}" mismatch, should be "${Q[t(e,U).smotif]}".`);return}else console.info(`Track ${s} is trying to perform a mismached mode dump on port ${String.fromCharCode(65+i)}.`);let c=e.chRedir(r[0],s,!0),o=p.cc*c,n=r[1];r[0]>15&&(c=r[0]+32);let d=`Track ${s} S90/Motif ES bulk CH${c<128?c+1:"U"+(c-127)} `;console.debug(d,r),!(r[0]>15)&&r.subarray(2).forEach((l,m)=>{([()=>{t(e,g)[o+y[0]]=l,e.pushChPrimitives(c),e.dispatchEvent("voice",{part:c})},()=>{l&&e.setChActive(c,1),t(e,g)[o+y[32]]=l,e.getChPrimitive(c,1)==63&&e.setChType(c,[32,40].indexOf(l)>-1?e.CH_DRUMS:e.CH_MELODIC,t(e,B),!0),e.pushChPrimitives(c),e.dispatchEvent("voice",{part:c})},()=>{l&&e.setChActive(c,1),t(e,A)[c]=l,e.dispatchEvent("voice",{part:c})},()=>{let $=e.chRedir(l,s,!0);t(e,_)[c]=$,c!=$&&(e.buildRchTree(),console.info(`${d}receives from CH${$+1}`))},()=>{t(e,re)[c]=l?0:1},!1,!1,!1,!1,!1,!1,!1,!1,()=>{l!=100&&e.setChActive(c,1),t(e,g)[o+y[7]]=l},()=>{l!=64&&e.setChActive(c,1),t(e,g)[o+y[10]]=l},!1,!1,!1,()=>{t(e,g)[o+y[91]]=l},()=>{l&&e.setChActive(c,1),t(e,g)[o+y[93]]=l},()=>{l&&e.setChActive(c,1),t(e,g)[o+y[94]]=l},()=>{l!=127&&e.setChActive(c,1),t(e,g)[o+y[128]]=l,e.allocateAce(c,128)},()=>{},()=>{l!=64&&e.setChActive(c,1),t(e,g)[o+y[74]]=l},()=>{l!=64&&e.setChActive(c,1),t(e,g)[o+y[71]]=l},!1,()=>{t(e,g)[o+y[65]]=l},()=>{t(e,g)[o+y[5]]=l},()=>{}][n+m]||(()=>{}))()})}).add([127,1,54,16],(r,s,f)=>{e.switchMode("s90es");let i=r[0];r.subarray(1).forEach((c,o)=>{let d=`S90/Motif ES EQ${(o>>2)+1} `;([()=>{let l=c-64},()=>{let l=We[c]},()=>{let l=c/10},()=>{let l=c}][i+o&3]||(()=>{}))()})}),t(this,le).add([0,72,18,0,0,0,0],(r,s,f)=>{e.switchMode("sd",!0),e.setPortMode(e.getTrackPort(s),2,w.sd),console.info("MIDI reset: SD")}).add([0,72,18,16,0],(r,s,f)=>{e.dispatchEvent("mupromptex");let i=r[0]>>5,c=r[0]&31;switch(i){case 0:{let o=r[0]>>1,n=r[1];switch(o){case 1:{r.subarray(2).forEach((d,l,m)=>{let $=l+n;switch($){case 0:{d&&(e.setEffectType(1,60,d-1),e.dispatchEvent("efxchorus",e.getEffectType(1)),console.debug(`SD MFX Cho: ${$} - ${d}`));break}}});break}case 2:{r.subarray(2).forEach((d,l)=>{let m=l+n;switch(m){case 0:{d&&(e.setEffectType(0,55+d,0),e.dispatchEvent("efxreverb",e.getEffectType(0)),console.debug(`SD MFX Rev: ${m} - ${d}`));break}}});break}case 3:case 4:case 5:{let d=o-1;r.subarray(2).forEach((l,m)=>{let $=m+n;switch(console.debug(`SD MFX ${d-2}: ${$} - ${l}`),$){case 0:{e.setEffectTypeRaw(d,62,l),e.dispatchEvent(`efx${d>2?"delay":"insert"+(d-4)}`,e.getEffectType(d));break}}}),console.debug(`SD MFX message:
%o`,r);break}default:console.debug(`Unknown SD-90 global effects message:
%o`,r)}break}case 1:{let o=e.chRedir(c,s,!0),n=r[1],d=o*p.cc;r.subarray(2).forEach((l,m)=>{let $=n+m;$<37?([()=>{},()=>{},0,()=>{},()=>{switch(t(e,g)[d+y[0]]=l,l){case 104:case 105:case 106:case 107:case 120:{t(e,R)[o]||e.setChType(o,e.CH_DRUMS);break}default:t(e,R)[o]&&e.setChType(o,e.CH_MELODIC)}e.pushChPrimitives(o),e.dispatchEvent("voice",{part:o})},()=>{t(e,g)[d+y[32]]=l,e.pushChPrimitives(o),e.dispatchEvent("voice",{part:o})},()=>{t(e,A)[o]=l,e.dispatchEvent("voice",{part:o})},()=>{t(e,g)[d+y[7]]=l},()=>{t(e,g)[d+y[10]]=l},()=>{},()=>{},()=>{l<2&&(t(e,re)[o]=l)},()=>{l<2&&(t(e,g)[d+y[68]]=l?127:0)},()=>{},()=>{l<2&&(t(e,g)[d+y[65]]=l?127:0)},()=>{t(e,g)[d+y[5]]=l&15<<4|t(e,g)[d+y[5]]&15},()=>{t(e,g)[d+y[5]]=l&15|(t(e,g)[d+y[5]]&240)>>4},()=>{t(e,g)[d+y[74]]=l},()=>{t(e,g)[d+y[71]]=l},()=>{t(e,g)[d+y[73]]=l},()=>{t(e,g)[d+y[72]]=l},0,0,0,0,0,0,0,()=>{t(e,g)[d+y[128]]=l,e.allocateAce(128)},()=>{t(e,g)[d+y[93]]=l},()=>{t(e,g)[d+y[91]]=l},0,0,()=>{t(e,g)[d+y[75]]=l},()=>{t(e,g)[d+y[76]]=l},()=>{t(e,g)[d+y[77]]=l},()=>{t(e,g)[d+y[78]]=l}][$]||(()=>{}))():$<63||($<64?(t(e,R)[o]?t(e,g)[d+y[0]]=104|l:t(e,g)[d+y[0]]=96|l,e.dispatchEvent("voice",{part:o})):console.debug(`Unknown SD-90 global CH${o+1} param setup message:
%o`,r))});break}case 2:{let o=e.chRedir(c,s,!0),n=r[1];console.debug(`Unknown SD-90 global CH${o+1} MIDI setup message:
%o`,r.subarray(2));break}default:console.warn(`Unknown SD-90 global part setup message:
%o`,r)}}),t(e,$e).add([0,1,73,78],(r,s,f)=>{e.switchMode("krs"),e.setPortMode(e.getTrackPort(s),1,w.krs),console.debug("Might be KORG KROSS 2 mode reset... Not sure.")}).add([0,1,73,117,2,37],(r,s,f)=>{e.switchMode("krs");let i=e.getTrackPort(s);if(t(e,I)[i]&&t(e,I)[i]!=w.krs)if(t(e,me).dumpLimit==e.DUMP_MODE){console.warn(`Dump cancelled. Port ${String.fromCharCode(65+i)} mode "${Q[t(e,I)[i]]}" mismatch, should be "krs".`);return}else console.info(`Track ${s} is trying to perform a mismached mode dump on port ${String.fromCharCode(65+i)}.`);e.setPortMode(e.getTrackPort(s),1,w.krs);let c="KROSS 2 BMT1 ",o="";fe(r,(n,d)=>{if(d<24)o+=String.fromCharCode(Math.max(32,n));else if(!(d<1276)){let l=d-1276,m=e.chRedir(Math.floor(l/44),s,!0),$=l%44,T=p.cc*m;$<15?([()=>{n&&e.setChActive(m,1),t(e,A)[m]=n,e.dispatchEvent("voice",{part:m})},()=>{n&&e.setChActive(m,1),n<10?(t(e,g)[T+y[0]]=63,t(e,g)[T+y[32]]=n):n<20?(t(e,g)[T+y[0]]=121,t(e,g)[T+y[32]]=n-10):n<24&&(t(e,g)[T+y[0]]=[120,0,56,62][n-20],t(e,g)[T+y[32]]=0),e.pushChPrimitives(m),e.dispatchEvent("voice",{part:m})},()=>{let M=e.chRedir(n&15,s,!0);t(e,_)[m]=M,console.info(`${c}CH${m+1} receives from CH${M+1}`)},!1,!1,()=>{t(e,g)[T+y[7]]=n},!1,()=>{},()=>{},!1,!1,!1,!1,!1,()=>{t(e,g)[T+y[10]]=n||128}][$]||(()=>{}))():$<36||([()=>{t(e,g)[T+y[74]]=(n+128&255)-64},()=>{t(e,g)[T+y[71]]=(n+128&255)-64},!1,!1,()=>{t(e,g)[T+y[73]]=(n+128&255)-64},()=>{t(e,g)[T+y[75]]=(n+128&255)-64},!1,()=>{t(e,g)[T+y[72]]=(n+128&255)-64}][$]||(()=>{}))()}}),o=o.trimRight(),e.dispatchEvent("metacommit",{type:"EORTitle",data:o})})}chRedir(e,a,h){let u=this;if(t(u,Le)[a])return(t(u,Le)[a]-1)*16+e;if(t(u,B)==w.sc){if(h==1)return e;let b=0,v=!0;for(;v;)t(u,Ce)[e+b]==0?(t(u,Ce)[e+b]=a,console.debug(`Assign track ${a} to channel ${e+b+1}.`),v=!1):t(this,Ce)[e+b]==a?v=!1:(b+=16,b>=128&&(b=0,v=!1));return e+b}else return e}getTrackPort(e){return this.chRedir(0,e,!0)>>4}forceVoiceRefresh(){for(let e=0;e<p.ch;e++)t(this,oe)[e]&&this.dispatchEvent("voice",{part:e})}buildRchTree(){let e=[];t(this,_).forEach((a,h)=>{var u;a<p.ch&&((u=e[a])!=null&&u.constructor||(e[a]=[]),e[a].push(h))}),x(this,dt,e)}buildRccMap(){let e=this;for(let a=0;a<p.ch;a++)t(e,Ne)[a]={};t(e,Be).forEach((a,h)=>{a&&(t(e,Ne)[Math.floor(h/p.redir)][a]=h%p.redir|128)}),O()&&console.debug(t(e,Ne))}getActive(){return t(this,oe)}getCc(e){let a=this,h=e*p.cc;return t(a,g).subarray(h,h+p.cc)}getCcCh(e,a){let h=this;if(ct.indexOf(a)<0)throw new Error("CC number not accepted");return t(h,g)[p.cc*e+y[a]]}getCcAll(){return t(this,g).slice()}getChSource(){return t(this,_)}getChType(){return t(this,R)}setChType(e,a,h=0,u=!1){a&=15;let b=this;h=h||b.getChModeId(e),t(b,R)[e]=a,a>0&&!u&&(t(b,g)[e*p.cc+y[0]]=t(b,F)[h][2],b.pushChPrimitives(e))}setChActive(e,a=0){t(this,oe)[e]!=a&&this.dispatchEvent("channeltoggle",{part:e,active:a}),t(this,oe)[e]=a}getExt(e){let a=p.ext*e,h=t(this,ae).subarray(a,a+p.ext),u=new Uint8Array(h.length);return u.set(h),u[1]=u[1]||t(this,ht),u}getPitch(){return t(this,Se)}getProgram(){return t(this,A)}getTexts(){return t(this,ie).slice()}getVel(e){let a=new Map,h=this;return t(h,V).forEach(function(u,b){let v=u>>7,k=u&127;e==v&&t(h,X)[u]>0&&a.set(k,{v:t(h,X)[u],s:t(h,z)[b]})}),a}getBitmap(){return{bitmap:t(this,ne,ke),expire:t(this,ue)}}getLetter(){return{text:t(this,Oe),set:t(this,lt),expire:t(this,Ae)}}getMode(){return Q[t(this,B)]}getMaster(){return{volume:t(this,H)}}getRawStrength(){let e=this;return t(this,V).forEach(function(a){let h=a>>7;t(e,X)[a]>t(e,ye)[h]&&(t(e,ye)[h]=t(e,X)[a])}),t(this,ye)}getStrength(){let e=[],a=this;return this.getRawStrength().forEach(function(h,u){e[u]=Math.floor(h*t(a,g)[u*p.cc+y[7]]*t(a,g)[u*p.cc+y[11]]*t(a,H)/803288)}),e}getRpn(){return t(this,D)}getNrpn(){return t(this,qe)}getSubDb(){return self==null?void 0:self.structuredClone(t(this,F))}getVoice(e,a,h,u="?"){var f;let b=this;(f=w[u])!=null&&f.constructor||(u="?");let v=w[u],k=e||t(b,F)[v][0],C=a,r=h||t(b,F)[v][1];k==it.bank0&&(k=0),r==it.bank0&&(r=0),u=="ns5r"&&k>0&&k<56&&(r=3);let s=b.userBank.get(k,C,r,u);if(u=="mt32"&&s.name.indexOf("MT-m:")==0){let i=parseInt(s.name.slice(5)),c=i*p.cmt,o="";t(b,De).subarray(c,c+10).forEach(d=>{d>31&&(o+=String.fromCharCode(d))});let n=`MSB	LSB	PRG	NME
0	127	${C}	${o}`;b.userBank.load(n,!0),s.name=o,s.ending=" "}return(s.ending!=" "||!s.name.length)&&(s=b.baseBank.get(k,C,r,u)),s}getChPrimitive(e,a,h){if(a>=p.vxPrim||(a==null?void 0:a.constructor)!=Number)throw new RangeError(`Invalid voice primitive component "${a}"`);if(e>=p.ch)throw new RangeError(`Invalid part "CH${e+1}"`);let u=this,b=t(u,A)[a<<p.chShift|e];switch(a){case 1:case 2:{h&&(b=b||t(u,F)[u.getChModeId(e)][a-1]),b==it.bank0&&(b=0);break}}return b}getChPrimitives(e,a){let h=this,u=new Uint8Array(3);return u[1]=t(h,A)[e],u[0]=h.getChPrimitive(e,1,a),u[2]=h.getChPrimitive(e,2,a),u}pushChPrimitives(e){let a=this;t(a,A)[1<<p.chShift|e]=t(a,g)[kt[e]+y[0]],t(a,A)[2<<p.chShift|e]=t(a,g)[kt[e]+y[32]]}getChVoice(e){let a=this,h=a.getVoice(...a.getChPrimitives(e),a.getChMode(e));if(t(a,be)[e]){let u="";switch(t(a,B)){case w.mt32:{t(a,ge).subarray(p.cmt*(e-1),p.cmt*(e-1)+10).forEach(b=>{u+=String.fromCharCode(Math.max(b,32))}),u=u.trimRight();break}default:{let b=p.cvn*e;t(a,nt).subarray(b,b+p.cvn).forEach(v=>{u+=String.fromCharCode(Math.max(v,32))}),u=u.trimRight()}}u.length&&(h.ending="~",h.name=u)}return h}getRawPitch(){return t(this,Se)}getPitchShift(e){let a=this,h=e*p.rpn,u=t(a,D)[h];return t(a,L)[e*p.rpnt]||t(a,B)==w.mt32&&(u=12),t(a,Se)[e]/8192*u+(t(a,D)[h+3]-64)+((t(a,D)[h+1]<<7)+t(a,D)[h+2]-8192)/8192}getEffectType(e=0){let a=3*e+1;return t(this,se).subarray(a,a+2)}setEffectTypeRaw(e=0,a,h){let u=3*e;t(this,se)[u]=1,t(this,se)[u+1+ +a]=h}setEffectType(e=0,a,h){this.setEffectTypeRaw(e,!1,a),this.setEffectTypeRaw(e,!0,h)}getEffectSink(){return t(this,Qe)}setLetterDisplay(e,a,h=0,u=3200){let b=this,v;x(b,Oe," ".repeat(h)),e.forEach(k=>{x(b,Oe,t(b,Oe)+String.fromCharCode(k>31?k:32)),k<32&&(v=v||new Set,v.add(k))}),x(b,lt,Date.now()),x(b,Ae,Date.now()+u),v&&(v=Array.from(v),v.forEach((k,C,r)=>{r[C]=k.toString(16).padStart(2,"0")}),console.warn(`${a}${a?" ":""}invalid code point${v.length>1?"s":""}: 0x${v.join(", 0x")}`))}setDetectionTargets(e="?",a=0){let h=this,u=-1;switch(e.replaceAll(", ",",").split(",").forEach(b=>{b=b.toLowerCase();let v=Q.indexOf(cr[b]||b);O()&&console.debug(`Mapped mode "${b}" to ID "${v}".`),v>-1&&(u=v)}),O()&&console.debug(`Set detection target to ID "${u}".`),u>0&&(t(h,U).x5=82,t(h,U).ds=w.krs),u){case w["05rw"]:{t(h,U).x5=81;break}case w.s90es:t(h,U).ds=w.s90es,t(h,U).smotif=w.s90es;case w.motif:t(h,U).ds=w.motif,t(h,U).smotif=w.motif}}setGsTargets(e=!1,a=4){if(!a)a=e?3:4;else{if(a>4||a<0)throw new Error(`Invalid GS level ${a}`);if(e&&a>>1!=1)throw new Error(`Invalid SC level ${a}`)}let h=this;t(h,U)[e?"sc":"gs"]=a,t(h,F)[w[e?"sc":"gs"]][1]=a,h.forceVoiceRefresh()}getConfigs(){return t(this,ot)}setDumpLimit(e){if(e>2||e<0)throw new RangeError("Invalid dump limit.");t(this,me).dumpLimit=e}allocateAce(e=0,a){let h=this;if(!a||a<128&&a>95){console.warn(`cc${a} cannot be allocated as an active custom effect.`);return}let u=!0,b=0,v=p.ace*e;for(;u&&b<p.ace;)t(h,J)[b+v]==a?u=!1:t(h,J)[b+v]||(u=!1,t(h,J)[b+v]=a,console.info(`Allocated cc${a} to ACE slot ${b} in CH${e+1}.`)),b++;b>=p.ace&&console.warn(`ACE slots are full in CH${e+1}.`)}allocateAceAll(e){let a=this;if(!e||e<128&&e>95){console.warn(`cc${e} cannot be allocated as an active custom effect.`);return}for(let h=0;h<p.ch;h++){let u=!0,b=0,v=p.ace*h;for(;u&&b<p.ace;)t(a,J)[b+v]==e?u=!1:t(a,J)[b+v]||(u=!1,t(a,J)[b+v]=e),b++;b>=p.ace&&console.warn(`ACE slots are full in CH${h+1}.`)}}releaseAce(e=0,a){let h=!0,u=p.ace*e,b=u+p.ace;for(;h&&u<b;)t(this,J)[u]==a&&(t(this,J)[u]=0,h=!1),u++;h&&O()&&console.debug(`No ACE slot was allocated to cc${a} in CH${e+1}.`)}resetAce(){t(this,J).fill(0),console.info("All ACE slots have been reset.")}getAce(){return t(this,J)}getChAce(e=0,a=0){if(a<0||a>=p.ace)throw new RangeError("No such ACE slot");let h=t(this,J)[p.ace*e+a];if(h){if(ct.indexOf(h)>=0)return t(this,g)[e*p.cc+y[h]];throw new Error(`Invalid ACE source in CH${e+1}: ${h}`)}else return 0}initDrums(){let e=this;t(e,j).fill(64);for(let a=0;a<p.drm;a++){let h=a*p.dpn;for(let u in zt){let b=zt[u],v=(h+he[u])*p.dnc;t(e,j).subarray(v,v+p.dnc).fill(b)}}}init(e=0){let a=this;x(a,He,0),t(a,F)[w.xg][1]=0,a.dispatchEvent("banklevel",{mode:"xg",data:0}),t(a,oe).fill(0),t(a,g).fill(0),t(a,J).fill(0),t(a,A).fill(0),t(a,X).fill(0),t(a,V).fill(0),t(a,re).fill(0),t(a,ye).fill(0),t(a,Se).fill(0),t(a,qe).fill(0),t(a,L).fill(0),t(a,ae).fill(0),t(a,I).fill(0),t(a,Pe).fill(0),t(a,Be).fill(0),x(a,H,100),x(a,ie,[]),x(a,Je,500),x(a,Ze,0),x(a,ue,0),x(a,Y,0),t(a,ne,ke).fill(0),x(a,N,!1),x(a,je,0),x(a,ve,!0),a.initDrums(),t(a,_).forEach(function(h,u,b){b[u]=u}),e==0&&(a.dispatchEvent("mode","?"),x(a,B,0),t(a,Ce).fill(0),t(a,Le).fill(0),x(a,Ae,0),x(a,Oe,"")),_t.forEach(h=>{t(a,g)[p.cc*h]=t(a,F)[a.getChModeId(h)][2]}),t(a,R).fill(a.CH_MELODIC),t(a,R)[9]=a.CH_DRUM1,t(a,R)[25]=a.CH_DRUM3,t(a,R)[41]=a.CH_DRUMS,t(a,R)[57]=a.CH_DRUMS,t(a,R)[73]=a.CH_DRUM5,t(a,R)[89]=a.CH_DRUM7,t(a,R)[105]=a.CH_DRUMS,t(a,R)[121]=a.CH_DRUMS;for(let h=0;h<p.drm;h++)t(a,pe)[h<<1]=0,t(a,pe)[h<<1|1]=p.invalidCh;t(a,Ye).fill(0),t(a,De).fill(0),t(a,Re).fill(0),t(a,ge).fill(0),t(a,be).fill(0),t(a,se).fill(0),t(a,Qe).fill(0),a.aiEfxName="",a.userBank.clearRange({msb:0,lsb:127,prg:[0,127]}),a.modelEx.sc.showBar=!0,a.modelEx.sc.invBar=!1,a.modelEx.sc.invDisp=!1,a.modelEx.sc.peakHold=1;for(let h=0;h<p.ch;h++){let u=h*p.cc;t(a,g)[u+y[7]]=100,t(a,g)[u+y[11]]=127,t(a,g)[u+y[2]]=127,t(a,g)[u+y[10]]=64,t(a,g).subarray(u+y[71],u+y[71]+8).fill(64),t(a,g)[u+y[128]]=127,t(a,g).subarray(u+y[130],u+y[157]+1).fill(64),t(a,g)[u+y[91]]=40,t(a,g)[u+y[101]]=127,t(a,g)[u+y[100]]=127,t(a,g)[u+y[99]]=127,t(a,g)[u+y[98]]=127;let b=h*p.rpn;t(a,D)[b]=2,t(a,D)[b+1]=64,t(a,D)[b+2]=0,t(a,D)[b+3]=64,t(a,D)[b+4]=0,t(a,D)[b+5]=0;let v=h*p.ext;t(a,ae)[v+1]=a.VLBC_BRTHEXPR;let k=h*p.redir;t(a,Be)[k+8]=13}a.buildRchTree(),a.buildRccMap(),a.dispatchEvent("mastervolume",t(a,H)),a.dispatchEvent("efxreverb",a.getEffectType(0)),a.dispatchEvent("efxchorus",a.getEffectType(1)),a.dispatchEvent("efxdelay",a.getEffectType(2)),a.dispatchEvent("efxinsert0",a.getEffectType(3)),a.dispatchEvent("efxinsert1",a.getEffectType(4)),a.dispatchEvent("efxinsert2",a.getEffectType(5)),a.dispatchEvent("efxinsert3",a.getEffectType(6)),a.dispatchEvent("reset"),a.switchMode("?")}setChMode(e,a){let h=this;if(e<0||e>=p.ch)throw new RangeError(`Invalid CH${e+1}`);if(port<0||a>=Q.length)throw new RangeError(`Invalid mode ID ${a}`);t(h,Pe)[e]=a,h.dispatchEvent("voice",{part:e})}getChMode(e,a){return Q[this.getChModeId(e,a)]}getChModeId(e,a){return a?t(this,Pe)[e]||t(this,I)[e>>4]:t(this,Pe)[e]||t(this,I)[e>>4]||t(this,B)}setPortMode(e,a,h){let u=this;if(e<0||e>=p.ch>>4)throw new RangeError(`Invalid port ${e+1}`);if(a<1)throw new RangeError("Range must be a positive integer");if(e+a>=p.ch>>4)throw new RangeError("Range must be in bound");if(e<0||h>=Q.length)throw new RangeError(`Invalid mode ID ${h}`);for(let b=e;b<e+a;b++){t(u,I)[b]=h;for(let v=b<<4;v<b+1<<4;v++)u.dispatchEvent("voice",{part:v})}}copyChSetup(e,a,h){if(e==a){console.warn(`Failed attempt at overwriting CH${e+1} with its own data.`);return}let u=this;if(h&&t(u,oe)[a]){console.warn(`Failed attempt at copying setup data from CH${e+1} to CH${a+1}.`);return}let b=p.cc*e,v=p.cc*a;t(u,A)[a]=t(u,A)[e],t(u,g).set(t(u,g).subarray(b,b+p.cc),v),u.pushChPrimitives(a)}setDrumFirstWrite(e,a){let h=this,u=t(h,R)[e];if(u<2)return;let b=u-2;if(t(h,pe)[b<<1])if(a)t(h,pe)[b<<1]=0,O()&&console.debug(`First write part for drum set ${b+1} has been reset.`);else return;else a?console.warn(`First write part for drum set ${b+1} is already blank.`):(t(h,pe)[b<<1]=1,t(h,pe)[b<<1|1]=e,console.debug(`First write part for drum set ${b+1} is set to CH${e+1}.`))}getChDrumFirstWrite(e){let a=this,h=t(a,R)[e];if(h<2)return;let u=h-2;return t(a,pe).subarray(u<<1,u+1<<1)}getDrumFirstWrite(e){if(e>=0&&e<p.drm)return t(this,pe).subarray(e<<1,e+1<<1)}switchMode(e,a=!1,h=!1){var v;let u=this,b=w[e];if(b>-1){if(t(u,B)==0||a){let k=t(u,B);u.initOnReset&&a&&(this.init(1),k=w["?"]),x(u,B,b),x(u,Y,0);for(let r=0;r<p.ch;r++)t(u,R)[r]>0&&t(u,Pe)[r]==0&&(t(u,g)[r*p.cc]=t(u,F)[b][2],u.pushChPrimitives(r));switch(b){case w.mt32:{vt.forEach((r,s)=>{let f=s+1;t(u,oe)[f]||(t(u,A)[f]=r,t(u,g)[f*p.cc+y[91]]=127,u.pushChPrimitives(f))});for(let r=1;r<10;r++)u.dispatchEvent("voice",{part:r});break}}let C;switch(b){case w["?"]:case w.g2:{C=[52,4,52,18,0,0,0,0];break}case w.xg:{C=[1,0,65,0,5,0,0,0];break}case w.gm:case w.gs:case w.sc:{C=[40,4,40,18,40,32,32,0];break}case w.sd:{C=[58,0,60,0,61,0,61,0];break}case w["05rw"]:case w.x5d:case w.ns5r:{C=[44,1,44,19,44,0,44,0];break}case w.k11:case w.sg:{C=[24,0,0,0,0,0,0,0];break}case w.mt32:{C=[40,4,0,0,0,0,0,0];break}case w.doc:{C=[24,16,0,0,0,0,0,0];break}case w.motif:case w.s90es:{C=[113,0,117,0,114,0,0,0];break}default:C=[0,0,0,0,0,0,0,0]}for(let r=0;r<p.efx;r++)!t(u,se)[3*r]&&((v=C[r<<1])!=null&&v.constructor)&&(t(u,se)[3*r+1]=C[2*r],t(u,se)[3*r+2]=C[2*r+1],u.dispatchEvent(`efx${["reverb","chorus","delay","insert0"][r]}`,u.getEffectType(r)));h&&u.setDetectionTargets(e),u.dispatchEvent("mode",e),u.forceVoiceRefresh(),_t.forEach(r=>{u.dispatchEvent("voice",{part:r})})}}else throw new Error(`Unknown mode ${e}`)}newStrength(){t(this,ye).fill(0)}runJson(e){var a;if(e.type>14)return e.type==15&&e.data.constructor!=Uint8Array&&(e.data=Uint8Array.from(e.data)),t(this,ft)[e.type].call(this,e);{let h=this.chRedir(e.part,e.track),u=!1;(a=t(this,dt)[h])==null||a.forEach(b=>{e.channel=b,u=!0,t(this,ft)[e.type].call(this,e)}),u||console.warn(`${Xt[e.type]?Xt[e.type]:e.type}${[11,12].includes(e.type)?(e.data[0]!=null?e.data[0]:e.data).toString():""} event sent to CH${h+1} without any recipient.`)}t(this,ie).length>100&&t(this,ie).splice(100,t(this,ie).length-99)}runRaw(e){}async loadBank(e,a){let h=this;switch(e=e.toLowerCase(),e){case"s7e":{h.userBank.clearRange({msb:63,lsb:[21,22]}),h.userBank.clearRange({msb:63,lsb:[24,27]});break}case"pcg":{h.userBank.clearRange({msb:63,lsb:[6,9]}),h.userBank.clearRange({msb:63,lsb:[13,16]});break}default:throw new Error(`Unknown bank format ${e}`)}switch(e){case"s7e":case"pcg":{tt.context=this,await h.userBank.load(await tt.read(e,a),!1);break}}h.forceVoiceRefresh()}},B=new WeakMap,Y=new WeakMap,ue=new WeakMap,xe=new WeakMap,ne=new WeakSet,ke=function(){return t(this,xe)[t(this,Y)]},Yt=function(e){t(this,xe)[t(this,Y)]=e},oe=new WeakMap,_=new WeakMap,R=new WeakMap,g=new WeakMap,J=new WeakMap,A=new WeakMap,X=new WeakMap,re=new WeakMap,V=new WeakMap,z=new WeakMap,Se=new WeakMap,ye=new WeakMap,Ue=new WeakMap,ae=new WeakMap,D=new WeakMap,L=new WeakMap,qe=new WeakMap,j=new WeakMap,pe=new WeakMap,se=new WeakMap,Qe=new WeakMap,Be=new WeakMap,I=new WeakMap,Pe=new WeakMap,be=new WeakMap,nt=new WeakMap,Re=new WeakMap,ge=new WeakMap,Ye=new WeakMap,De=new WeakMap,F=new WeakMap,U=new WeakMap,me=new WeakMap,ot=new WeakMap,H=new WeakMap,He=new WeakMap,Je=new WeakMap,Ze=new WeakMap,Oe=new WeakMap,Ae=new WeakMap,lt=new WeakMap,je=new WeakMap,ve=new WeakMap,N=new WeakMap,ht=new WeakMap,dt=new WeakMap,Ne=new WeakMap,ie=new WeakMap,Ce=new WeakMap,Le=new WeakMap,Z=new WeakMap,Ie=new WeakMap,G=new WeakMap,ft=new WeakMap,ut=new WeakMap,Ge=new WeakMap,_e=new WeakMap,ce=new WeakMap,le=new WeakMap,$e=new WeakMap,Xe=new WeakMap,Ve=new WeakMap,Fe=new WeakMap,Qt);export{ra as OctaviaDevice,p as allocated,y as ccToPos,he as dnToPos,O as getDebugState,it as overrides};
