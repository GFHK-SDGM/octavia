var _=Object.create;var O=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var z=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var q=(t,n,c,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of V(n))!K.call(t,s)&&s!==c&&O(t,s,{get:()=>n[s],enumerable:!(e=X(n,s))||e.enumerable});return t};var Q=(t,n,c)=>(c=t!=null?_(F(t)):{},q(n||!t||!t.__esModule?O(c,"default",{value:t,enumerable:!0}):c,t));var N=z((ze,T)=>{(function(){"use strict";let t={fatal:!0},n=[new TextDecoder("iso-8859-15",t),new TextDecoder("sjis",t),new TextDecoder("euc-jp",t),new TextDecoder("utf-8",t),new TextDecoder("utf-16",t),new TextDecoder("ascii")],c={debug:!1,parse:function(e,s){if(e instanceof Uint8Array)return c.Uint8(e);if(typeof e=="string")return c.Base64(e);if(e instanceof HTMLElement&&e.type==="file")return c.addListener(e,s);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(e,s){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(e===void 0||!(e instanceof HTMLElement)||e.tagName!=="INPUT"||e.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;s=s||function(){},e.addEventListener("change",function(r){if(!r.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let o=new FileReader;o.readAsArrayBuffer(r.target.files[0]),o.onload=function(h){s(c.Uint8(new Uint8Array(h.target.result)))}})},Base64:function(e){let s=function(h){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(h=h.replace(/^.*?base64,/,""),h=String(h).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(h))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");h+="==".slice(2-(3&h.length));let b,u="",a,i,l=0;for(;l<h.length;)b=g.indexOf(h.charAt(l++))<<18|g.indexOf(h.charAt(l++))<<12|(a=g.indexOf(h.charAt(l++)))<<6|(i=g.indexOf(h.charAt(l++))),u+=a===64?String.fromCharCode(b>>16&255):i===64?String.fromCharCode(b>>16&255,b>>8&255):String.fromCharCode(b>>16&255,b>>8&255,255&b);return u}(e=String(e));var r=s.length;let o=new Uint8Array(new ArrayBuffer(r));for(let h=0;h<r;h++)o[h]=s.charCodeAt(h);return c.Uint8(o)},Uint8:function(o){let s={data:null,pointer:0,movePointer:function(a){return this.pointer+=a,this.pointer},readInt:function(a){if((a=Math.min(a,this.data.byteLength-this.pointer))<1)return-1;let i=0;if(1<a)for(let l=1;l<=a-1;l++)i+=this.data.getUint8(this.pointer)*Math.pow(256,a-l),this.pointer++;return i+=this.data.getUint8(this.pointer),this.pointer++,i},readStr:function(a){let i=new Uint8Array(a),l=!1,f;i.forEach((p,d)=>{i[d]=this.readInt(1)});for(let p=0;p<n.length;p++)if(!l)try{if(f=n[p].decode(i),p==0)for(let d=0;d<f.length;d++){let y=f.charCodeAt(d);if(y>191||y>127&&y<160)throw new RangeError(`Invalid code point: ${y}`)}l=!0,console.debug(`String byte sequence in ${n[p].encoding}`)}catch(d){console.debug(`SMF string ${d}`)}return f||"String byte sequence read failed."},backOne:function(){this.pointer--},readIntVLV:function(){let a=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)a=this.readInt(1);else{let l=[];for(;128<=this.data.getUint8(this.pointer);)l.push(this.readInt(1)-128);var i=this.readInt(1);for(let f=1;f<=l.length;f++)a+=l[l.length-f]*Math.pow(128,f);a+=i}return a}};if(s.data=new DataView(o.buffer,o.byteOffset,o.byteLength),s.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;s.readInt(4);let r={};r.formatType=s.readInt(2),r.tracks=s.readInt(2),r.track=[];var o=s.readInt(1),h=s.readInt(1);128<=o?(r.timeDivision=[],r.timeDivision[0]=o-128,r.timeDivision[1]=h):r.timeDivision=256*o+h;for(let a=1;a<=r.tracks;a++){r.track[a-1]={event:[]};var g,b=s.readInt(4);if(b===-1)break;if(b!==1297379947)return!1;s.readInt(4);let i=0,l=!1,f,p;for(;!l&&(i++,r.track[a-1].event[i-1]={},r.track[a-1].event[i-1].deltaTime=s.readIntVLV(),(f=s.readInt(1))!==-1);)if(128<=f?p=f:(f=p,s.movePointer(-1)),f===255){r.track[a-1].event[i-1].type=255,r.track[a-1].event[i-1].metaType=s.readInt(1);var u=s.readIntVLV();switch(r.track[a-1].event[i-1].metaType){case 47:case-1:l=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:r.track[a-1].event[i-1].data=s.readStr(u);break;case 33:case 89:case 81:r.track[a-1].event[i-1].data=s.readInt(u);break;case 84:r.track[a-1].event[i-1].data=[],r.track[a-1].event[i-1].data[0]=s.readInt(1),r.track[a-1].event[i-1].data[1]=s.readInt(1),r.track[a-1].event[i-1].data[2]=s.readInt(1),r.track[a-1].event[i-1].data[3]=s.readInt(1),r.track[a-1].event[i-1].data[4]=s.readInt(1);break;case 88:r.track[a-1].event[i-1].data=[],r.track[a-1].event[i-1].data[0]=s.readInt(1),r.track[a-1].event[i-1].data[1]=s.readInt(1),r.track[a-1].event[i-1].data[2]=s.readInt(1),r.track[a-1].event[i-1].data[3]=s.readInt(1);break;default:this.customInterpreter!==null&&(r.track[a-1].event[i-1].data=this.customInterpreter(r.track[a-1].event[i-1].metaType,s,u)),this.customInterpreter!==null&&r.track[a-1].event[i-1].data!==!1||(s.readInt(u),r.track[a-1].event[i-1].data=s.readInt(u),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch((f=f.toString(16).split(""))[1]||f.unshift("0"),r.track[a-1].event[i-1].type=parseInt(f[0],16),r.track[a-1].event[i-1].channel=parseInt(f[1],16),r.track[a-1].event[i-1].type){case 15:this.customInterpreter!==null&&(r.track[a-1].event[i-1].data=this.customInterpreter(r.track[a-1].event[i-1].type,s,!1)),this.customInterpreter!==null&&r.track[a-1].event[i-1].data!==!1||(g=s.readIntVLV(),r.track[a-1].event[i-1].data=s.readInt(g),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer"));break;case 10:case 11:case 14:case 8:case 9:r.track[a-1].event[i-1].data=[],r.track[a-1].event[i-1].data[0]=s.readInt(1),r.track[a-1].event[i-1].data[1]=s.readInt(1);break;case 12:case 13:r.track[a-1].event[i-1].data=s.readInt(1);break;case-1:l=!0;break;default:if(this.customInterpreter!==null&&(r.track[a-1].event[i-1].data=this.customInterpreter(r.track[a-1].event[i-1].metaType,s,!1)),this.customInterpreter===null||r.track[a-1].event[i-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return r},customInterpreter:null};if(typeof T<"u")T.exports=c;else{let e=typeof window=="object"&&window.self===window&&window||typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;e.MidiParser=c}})()});var w=class{#e={};addEventListener(t,n){this.#e[t]||(this.#e[t]=[]),this.#e[t].unshift(n)}removeEventListener(t,n){if(this.#e[t]){let c=this.#e[t].indexOf(n);c>-1&&this.#e[t].splice(c,1),this.#e[t].length<1&&delete this.#e[t]}}dispatchEvent(t,n){let c=new Event(t),e=this;c.data=n,this.#e[t]?.length>0&&this.#e[t].forEach(function(s){try{s?.call(e,c)}catch(r){console.error(r)}}),this[`on${t}`]&&this[`on${t}`](c)}};var A=class{#e={};context;set(t,n){this.#e[t]=n}has(t){return!!this.#e[t]}async read(t,n){if(!this.has(t))throw new Error(`No decoder registered for "${t}"`);return await this.#e[t].call(this.context||this,n)}};var Y=function(t,n){let c=!0;return n.forEach((e,s)=>{c=c&&t[s]==e}),c},I=function(t){let n=0;return t.forEach(c=>{n*=256,n+=c}),n},v=new TextDecoder,U=new A;U.set("s7e",async function(t){let n=new Uint8Array(await t.slice(0,65536).arrayBuffer()),c="MSB	LSB	PRG	NME",e=[0,0,0,0],s=32,r=0,o=0,h=!0,g=[],b=0;for(;h;){let u=n.subarray(r);([()=>{v.decode(u.subarray(0,4))=="YSFC"?(r+=80,o=1):r++},()=>{if(Y(u.subarray(0,4),e))g.forEach((a,i,l)=>{let f=I(n.subarray(a.start+4,a.start+8));a.length=f}),o=2;else{let a=v.decode(u.subarray(0,4)),i=I(u.subarray(4,8));g.push({type:a,start:i}),r+=8}},()=>{let a=g[b],i=n.subarray(a.start,a.start+a.length),l=32;switch(a.type){case"ENVC":{let f=s;for(;f<i.length;){let p=i.subarray(f,f+l),d=v.decode(p.subarray(0,10)).trimEnd();d.slice(0,5)=="Init "&&(d=""),d&&(c+=`
063	${(p[17]+13).toString().padStart(3,"0")}	${p[19].toString().padStart(3,"0")}	${d}`),f+=l}break}case"EDVC":{let f=s;for(;f<i.length;){let p=i.subarray(f,f+l),d=v.decode(p.subarray(0,10)).trimEnd();d.slice(0,5)=="Init "&&(d=""),d&&(c+=`
063	024	${p[19].toString().padStart(3,"0")}	${d}`),f+=l}break}case"EPVC":{let f=32,p=s;for(;p<i.length;){let d=i.subarray(p,p+f),y=v.decode(d.subarray(0,10)).trimEnd();y=="----------"&&(y=""),y&&(c+=`
063	${(d[17]+1).toString().padStart(3,"0")}	${d[19].toString().padStart(3,"0")}	${y}`),p+=f}break}}b++,b>=g.length&&(o=3,h=!1)}][o]||(()=>{h=!1}))()}return c});var j=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"].concat(new Array(4),["white room","tunnel","canyon","basement","karaoke"],new Array(43),["pass through","chorus","celeste","flanger","symphonic","rotary speaker","tremelo","auto pan","phaser","distortion","overdrive","amplifier","3-band EQ","2-band EQ","auto wah"],new Array(1),["pitch change","harmonic","touch wah","compressor","noise gate","voice channel","2-way rotary speaker","ensemble detune","ambience"],new Array(4),["talking mod","Lo-Fi","dist + delay","comp + dist + delay","wah + dist + delay","V dist","dual rotor speaker"]);var W=",a,i,u,e,o,ka,ki,ku,ke,ko,ky,kw,sa,si,su,se,so,sh,ta,ti,tu,te,to,t,ch,t,s,na,ni,nu,ne,no,ny,nn,ha,hi,hu,he,ho,hy,fa,fi,fu,fe,fo,ma,mi,mu,me,mo,my,mm,ya,yu,ye,yo,ra,ri,ru,re,ro,ry,wa,wi,we,wo,ga,gi,gu,ge,go,gy,gw,za,zi,zu,ze,zo,ja,ji,ju,je,jo,jy,da,di,du,de,do,dy,ba,bi,bu,be,bo,by,va,vi,vu,ve,vo,pa,pi,pu,pe,po,py,nga,ngi,ngu,nge,ngo,ngy,ng,hha,hhi,hhu,hhe,hho,hhy,hhw,*,_,,,~,.".split(","),Z={};`hi*,
ka,か
ki,き
ku,く
ke,け
ko,こ
ky,き!
kw,くl
tsu,つ
ts,つl
sa,さ
si,すぃ
su,す
se,せ
so,そ
shi,し
sh,し!
ta,た
ti,てぃ
tu,とぅ
te,て
to,と
tchy,ち!
tchi,ち
na,な
ni,に
nu,ぬ
ne,ね
no,の
ny,に!
nn,ん
ha,は
hi,ひ
hu,ほぅ
he,へ
ho,ほ
hy,ひ!
fa,ふぁ
fi,ふぃ
fu,ふ
fe,ふぇ
fo,ふぉ
ma,ま
mi,み
mu,む
me,め
mo,も
my,み!
mm,
ra,ら
ri,り
ru,る
re,れ
ro,ろ
ry,り!
wa,わ
wi,うぃ
we,うぇ
wo,を
nga,ガ
ngi,ギ
ngu,グ
nge,ゲ
ngo,ゴ
ngy,ギ!
ng,
ga,が
gi,ぎ
gu,ぐ
ge,げ
go,ご
gy,ぎ!
gw,ぐl
za,ざ
zi,ずぃ
zu,ず
ze,ぜ
zo,ぞ
ja,じゃ
ji,じ
ju,じゅ
je,じぇ
jo,じょ
jy,じ!
da,だ
di,でぃ
du,どぅ
de,で
do,ど
dy,で!
ba,ば
bi,び
bu,ぶ
be,べ
bo,ぼ
by,び!
va,ゔぁ
vi,ゔぃ
vu,ゔ
ve,ゔぇ
vo,ゔぉ
pa,ぱ
pi,ぴ
pu,ぷ
pe,ペ
po,ぽ
py,ぴ!
!ya,ゃ
!yu,ゅ
!ye,ぇ
!yo,ょ
ya,や
yu,ゆ
ye,いぇ
yo,よ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
!a,ゃ
!u,ゅ
!e,ぇ
!o,ょ
la,ぁ
li,ぃ
lu,ぅ
le,ぇ
lo,ぉ
a,あ
i,い
u,う
e,え
o,お
*,っ
~,
^,
_,`.split(`
`).forEach(t=>{let n=t.split(",");Z[n[0]]=n[1]});var P=function(t,n,c){let e=[],s=c==!1?n.readIntVLV():c;t==0||t==127;for(let r=0;r<s;r++){let o=n.readInt(1);if(e.push(o),o!=247){if(o!=240){if(o>127)return console.debug(`Early termination: ${e}`),e.pop(),n.backOne(),n.backOne(),new Uint8Array(e)}}}return new Uint8Array(e)};var J=["?","gm","gs","xg","g2","mt32","ns5r","x5d","05rw","sd","k11","sg","krs","s90es","motif"];var S=[20,21,22,23,24,25,26,28,29,30,31,36,37,48,49,52,53,64,65];var x=[0,1,2,4,5,6,7,8,10,11,32,38,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84,91,92,93,94,95,98,99,100,101,128,12,13,16,17,18,19];var ee={};J.forEach((t,n)=>{ee[t]=n});var $={length:x.length};x.forEach((t,n)=>{$[t]=n});var L={length:S.length};S.forEach((t,n)=>{L[t]=n});var Fe={ch:128,cc:x.length,nn:128,pl:512,tr:256,cmt:14,rpn:6,ace:8,drm:8,dpn:S.length,dnc:128,efx:7};var R=Q(N(),1);var B=class{#e=!1;constructor(t,n,c,e){this.#e=t,this.start=n,this.end=c,this.data=e}get duration(){return this.ranged?this.end-this.start:0}get ranged(){return this.#e}},C=class extends B{constructor(t,n,c){super(!0,t,n,c)}},H=class extends B{constructor(t,n){super(!1,t,t,n)}},M=class extends Array{#e=-1;constructor(){super(...arguments)}resetIndex(t){this.#e=-1}fresh(){this.sort(function(t,n){return t.start==n.start?0:(+(t.start>n.start)<<1)-1}),this.forEach(function(t,n){t.index=n})}step(t,n=!1){let c=[];if(n)for(let e=0;e<this.length&&!(this[e].start>t);e++){if(this[e].end<t)continue;c.push(this[e])}else{let e=this.getRange(this.#e==-1?0:t-1,t),s=this;e.forEach(function(r){r.index>s.#e&&(c.push(r),s.#e=r.index)})}return c}getRange(t,n){t>n&&([t,n]=[n,t]);let c=[],e=-1,s=Math.ceil(Math.sqrt(this.length)),r=!0;for(let o=0;o<this.length;o+=s)this[o+s]?e<0&&this[o+s].start>=t&&(e=o):e=e<0?o:e;for(;r;)this[e]?.end<n?this[e].start>=t&&c.push(this[e]):r=!1,e++;return c}};var te=0xffffffffffff,G=function(t){let n=new M,c=this,e=t.timeDivision,s=120,r=new M,o=0,h=0;r.push(new C(0,te,[120,0])),t.track.forEach(function(a){o=0,a.event.forEach(function(i){o+=i.deltaTime,i.type==255&&i?.metaType==81&&(s=6e7/i.data,r[r.length-1]&&r.push(new C(o,0xffffffffffff,[s,0])))})}),r.fresh(),r.forEach(function(a,i,l){i>0&&(l[i-1].end=a.start)});let g=120;r.forEach(function(a,i,l){i>0&&(a.end==a.start?l.splice(l.indexOf(a),1):g==a.data[0]&&(l[i-1].end=a.end,l.splice(l.indexOf(a),1)),g=a.data[0])});let b=0,u=120;return r.forEach(function(a){let i=a.start,l=i/u/e*60+b;u=a.data[0],b=l-i/u/e*60,a.data[1]=b}),console.debug("All tempo changes: ",r),s=120,o=0,h=0,t.track.forEach(function(a,i){o=0,h=0;let l=i+1;a.event.forEach(function(f,p){o+=f.deltaTime;let d=r.step(o,!0)[0];d&&(s=d.data[0],h=d.data[1]);let y={type:f.type,data:f.data,track:l,part:0};f.type>14?y.meta=f.metaType:y.part=f.channel,n.push(new H(o/s/e*60+h,y))})}),n.fresh(),self.midiEvents=n,console.debug(`Parsed a type ${t.formatType} MIDI sequence.`),n};R.default.customInterpreter=P;var m=function(t,n,c){t.addEventListener(c,e=>{n.dispatchEvent(c,e.data)})},st=class extends w{device;#e;#n={};#f=[];#a="";#c=[];#o=new Uint8ClampedArray(128);#h=new Uint8ClampedArray(128);#s=.5;#i=120;#t=4;#l=4;#r=0;#d=0;smoothingAtk=0;smoothingDcy=0;reset(){let t=this;t.dispatchEvent("reset"),t.#e?.resetIndex(),t.device.init(),t.#a="",t.#s=.5,t.#i=120,t.#t=4,t.#l=4,t.#r=0,t.#d=0,t.dispatchEvent("tempo",t.#i),t.dispatchEvent("title",t.#a)}async loadFile(t){this.#e=G(R.default.parse(new Uint8Array(await t.arrayBuffer())))}async loadMap(t,n){let c=this,e=0,s=0,r=0,o,h;t.split(`
`).forEach((g,b)=>{if(!g)return;let u=g.split("	");if(b){if(!r)return;let a="",i="";u.forEach((l,f)=>{switch(f){case o:{a=l;break}case h:{i=l;break}}}),!c.#n[a]||n?(c.#n[a]=i,e++):self.debugMode&&console.debug(`Voice "${i}" (${a}) seems to be in conflict with (${c.#n[a]}).`),s++}else u.forEach((a,i)=>{switch(a){case"ID":{o=i,r++;break}case"Name":{h=i,r++;break}default:console.debug(`Unknown map field: ${a}`)}})}),console.debug(`Map: ${s} total, ${e} loaded.`),c?.device.forceVoiceRefresh()}async loadEfx(t,n){let c=this,e=0,s=0,r,o,h;t.split(`
`).forEach((g,b)=>{if(g)if(b){let u=0,a;g.split("	").forEach((i,l)=>{switch(l){case r:{u|=parseInt(i,16)<<8;break}case o:{u|=parseInt(i,16);break}case h:{a=i;break}}}),!c.#f[u]||n?(c.#f[u]=a,e++):self.debugMode&&console.debug(`EFX ID 0x${u.toString(16).padStart(4,"0")} (${a}) seems to be in conflict.`),s++}else g.split("	").forEach((u,a)=>{switch(u){case"MSB":{r=a;break}case"LSB":{o=a;break}case"Name":{h=a;break}default:console.debug(`Unknown EFX field: ${u}`)}})}),console.debug(`EFX: ${s} total, ${e} loaded.`),c.dispatchEvent("efxreverb",c.device.getEffectType(0)),c.dispatchEvent("efxchorus",c.device.getEffectType(1)),c.dispatchEvent("efxdelay",c.device.getEffectType(2)),c.dispatchEvent("efxinsert0",c.device.getEffectType(3)),c.dispatchEvent("efxinsert1",c.device.getEffectType(4)),c.dispatchEvent("efxinsert2",c.device.getEffectType(5)),c.dispatchEvent("efxinsert3",c.device.getEffectType(6))}switchMode(t,n=!1){this.device.switchMode(t,n)}getMode(){return this.device.getMode()}getVoice(){return this.device.getVoice(...arguments)}getChVoice(t){return this.device.getChVoice(t)}getMapped(t){return this.#n[t]||t}getEfx([t,n]){let c=t<<8|n;return this.#f[c]||`0x${c.toString(16).padStart(4,"0")}`}get noteProgress(){return this.#d/this.#s}get noteOverall(){return this.noteProgress-this.#r}get noteBar(){return Math.floor(this.noteOverall/this.#t)}get noteBeat(){let t=this.noteOverall%this.#t;return t<0&&(t+=this.#t),t}getTimeSig(){return[this.#t,this.#l]}getTempo(){return this.#i}sendCmd(t){this.device.runJson(t)}render(t){t>this.#d&&(this.#d=t);let n=this.#e?.step(t)||[],c=0,e=new Set,s=this,r=[];this.device.getStrength().forEach((p,d)=>{this.#h[d]=p}),s.device.newStrength(),n.forEach(function(p){let d=p.data;d.type==9&&(d.data[1]>0?e.add(d.part*128+d.data[0]):e.has(d.part*128+d.data[0])&&c++),p.data.type==8&&e.has(d.part*128+d.data[0])&&c++;let y=s.device.runJson(d);switch(y?.reply){case"meta":{r.push(y);break}}y?.reply&&delete y.reply}),r?.length>0&&this.dispatchEvent("meta",r);let o=this.device.getActive(),h=[],g=s.device.getPitch(),b=s.device.getCcAll(),u=s.device.getProgram(),a=s.device.getChType(),i=this.device.getStrength();i.forEach(function(p,d,y){y[d]=Math.max(s.#h[d],p);let E=y[d]-s.#o[d],D=$.length*d;if(E>=0){let k=4*.25**(b[D+$[73]]/64);s.#o[d]+=Math.ceil(E-E*s.smoothingAtk**k)}else{let k=4*.25**(b[D+$[72]]/64);s.#o[d]+=Math.floor(E-E*s.smoothingDcy**k)}});let l=0;return o.forEach(function(p,d){p&&(h[d]=s.device.getVel(d),l+=h[d].size)}),{extraPoly:c,curPoly:l,chInUse:o,chKeyPr:h,chPitch:g,chProgr:u,chContr:b,chType:a,eventCount:n.length,title:this.#a,bitmap:this.device.getBitmap(),letter:this.device.getLetter(),texts:this.device.getTexts(),master:this.device.getMaster(),mode:this.device.getMode(),strength:this.#o.slice(),velo:i,rpn:this.device.getRpn(),tSig:this.getTimeSig(),tempo:this.getTempo(),noteBar:this.noteBar,noteBeat:this.noteBeat,ace:this.device.getAce(),efxSink:this.device.getEffectSink()}}constructor(t,n=.5,c=.5){super();let e=this;e.smoothingAtk=n,e.smoothingDcy=c,e.device=t,e.addEventListener("meta",function(s){s?.data?.forEach(function(r){(e.#c[r.meta]||console.debug).call(e,r.meta,r.data)})}),m(e.device,e,"mode"),m(e.device,e,"mastervolume"),m(e.device,e,"channelactive"),m(e.device,e,"channelmin"),m(e.device,e,"channelmax"),m(e.device,e,"channelreset"),m(e.device,e,"channeltoggle"),m(e.device,e,"screen"),m(e.device,e,"metacommit"),m(e.device,e,"voice"),m(e.device,e,"pitch"),m(e.device,e,"note"),m(e.device,e,"reset"),m(e.device,e,"efxreverb"),m(e.device,e,"efxchorus"),m(e.device,e,"efxdelay"),m(e.device,e,"efxinsert0"),m(e.device,e,"efxinsert1"),m(e.device,e,"efxinsert2"),m(e.device,e,"efxinsert3"),m(e.device,e,"partefxtoggle"),e.#c[3]=function(s,r){e.#a?.length<1&&(e.#a=r,e.dispatchEvent("title",e.#a))},e.#c[81]=function(s,r){let o=e.noteProgress,h=e.#s||.5;e.#i=6e7/r,e.#s=r/1e6,e.#r+=o*(h/e.#s)-o,e.dispatchEvent("tempo",e.#i)},e.#c[88]=function(s,r){let o=e.noteProgress,h=e.noteOverall,g=e.noteBar,b=e.noteBeat,u=e.#t,a=e.#l;e.#t=r[0],e.#l=1<<r[1];let i=24*(32/r[3])/r[2];if(u!=e.#t){let l=g;e.#r-=l*(e.#t-u),b+1>=u&&(u<e.#t?e.#r-=Math.ceil(e.#t-b-1):e.#r+=e.#t)}e.dispatchEvent("tsig",e.getTimeSig())}}};export{st as RootDisplay,$ as ccToPos,L as dnToPos};
